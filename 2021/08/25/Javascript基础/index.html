<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Javascript 宝典 | Tammy-Zting-Blog</title><meta name="description" content="第1章 Javascript-基础知识1.1 变量类型与变量计算1.1.1 值类型与引用类型值类型 值类型(不会相互影响):undefined、string、number、boolean 1234var a&#x3D;100;var b&#x3D;a;a&#x3D;200;console.log(b)&#x2F;&#x2F;100    引用类型 引用类型：对象、数组、函数 1234var a&#x3D;&amp;#123;age:20&amp;#125;var b&#x3D;ab"><meta name="author" content="Zting"><meta name="copyright" content="Zting"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://tammy-zting.github.io/2021/08/25/Javascript%E5%9F%BA%E7%A1%80/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="Javascript 宝典"><meta property="og:url" content="http://tammy-zting.github.io/2021/08/25/Javascript%E5%9F%BA%E7%A1%80/"><meta property="og:site_name" content="Tammy-Zting-Blog"><meta property="og:description" content="第1章 Javascript-基础知识1.1 变量类型与变量计算1.1.1 值类型与引用类型值类型 值类型(不会相互影响):undefined、string、number、boolean 1234var a&#x3D;100;var b&#x3D;a;a&#x3D;200;console.log(b)&#x2F;&#x2F;100    引用类型 引用类型：对象、数组、函数 1234var a&#x3D;&amp;#123;age:20&amp;#125;var b&#x3D;ab"><meta property="og:image" content="http://tammy-zting.github.io/img/chicken.gif"><meta property="article:published_time" content="2021-08-25T05:55:27.000Z"><meta property="article:modified_time" content="2021-08-25T06:10:48.412Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="next" title="Web性能实战 第二节" href="http://tammy-zting.github.io/2021/07/28/Web%E6%80%A7%E8%83%BD%E5%AE%9E%E6%88%98%20%E7%AC%AC%E4%BA%8C%E8%8A%82/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/author_img.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第1章-Javascript-基础知识"><span class="toc-number">1.</span> <span class="toc-text">第1章 Javascript-基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-变量类型与变量计算"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 变量类型与变量计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-值类型与引用类型"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 值类型与引用类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#值类型"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">值类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#引用类型"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">引用类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#值类型与引用类型的区别"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">值类型与引用类型的区别</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#值类型和引用类型的提升"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">值类型和引用类型的提升</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-变量"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 变量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#var变量提升"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">var变量提升</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#let块作用域"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">let块作用域</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#const"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">const</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#最佳实践"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">最佳实践</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-变量计算"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 *变量计算</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#强类型转换"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">强类型转换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#逻辑运算"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">逻辑运算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#操作符"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#一元操作符"><span class="toc-number">1.1.3.3.1.</span> <span class="toc-text">一元操作符</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#位操作符"><span class="toc-number">1.1.3.3.2.</span> <span class="toc-text">位操作符</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#指数操作符"><span class="toc-number">1.1.3.3.3.</span> <span class="toc-text">指数操作符</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#加减操作符"><span class="toc-number">1.1.3.3.4.</span> <span class="toc-text">加减操作符</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#相等操作符"><span class="toc-number">1.1.3.3.5.</span> <span class="toc-text">相等操作符</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Js中使用typeof能得到的类型"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">Js中使用typeof能得到的类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#在if里面都会为false"><span class="toc-number">1.1.3.5.</span> <span class="toc-text">在if里面都会为false</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#何时使用-和"><span class="toc-number">1.1.3.6.</span> <span class="toc-text">何时使用&#x3D;&#x3D;&#x3D;和&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JS中的内置函数"><span class="toc-number">1.1.3.7.</span> <span class="toc-text">JS中的内置函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Number"><span class="toc-number">1.1.3.8.</span> <span class="toc-text">Number</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Infinity"><span class="toc-number">1.1.3.9.</span> <span class="toc-text">Infinity</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Math"><span class="toc-number">1.1.3.10.</span> <span class="toc-text">Math</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JSON"><span class="toc-number">1.1.3.11.</span> <span class="toc-text">JSON</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-执行上下午与作用域"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 执行上下午与作用域</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#执行上下文"><span class="toc-number">1.2.1.</span> <span class="toc-text">执行上下文</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#创建10个标签-点击的时候弹出来对应的序号"><span class="toc-number">1.2.2.</span> <span class="toc-text">创建10个标签 点击的时候弹出来对应的序号</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-基本数据类型"><span class="toc-number">1.3.</span> <span class="toc-text">1.3  基本数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Number-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">Number</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#String"><span class="toc-number">1.3.2.</span> <span class="toc-text">String</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-语句"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#标签语句"><span class="toc-number">1.4.1.</span> <span class="toc-text">标签语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#break"><span class="toc-number">1.4.2.</span> <span class="toc-text">break</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#continue"><span class="toc-number">1.4.3.</span> <span class="toc-text">continue</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第2章-Javascript-引用类型"><span class="toc-number">2.</span> <span class="toc-text">第2章 Javascript-引用类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Object类型"><span class="toc-number">2.1.</span> <span class="toc-text">2.1  Object类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-定义对象"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 定义对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-简写对象语法"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 简写对象语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-3-合并对象Object-assign"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 合并对象Object.assign</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-相等判定-Object-is"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4 相等判定 Object.is</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-6-对象解构"><span class="toc-number">2.1.5.</span> <span class="toc-text">2.1.6 对象解构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-7-创建对象的几种模式"><span class="toc-number">2.1.6.</span> <span class="toc-text">2.1.7 创建对象的几种模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#工厂模式"><span class="toc-number">2.1.6.1.</span> <span class="toc-text">工厂模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#构造函数模式"><span class="toc-number">2.1.6.2.</span> <span class="toc-text">构造函数模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#原型模式"><span class="toc-number">2.1.6.3.</span> <span class="toc-text">原型模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Array类型"><span class="toc-number">2.2.</span> <span class="toc-text">2.2  Array类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-Array-from-用于将类数组结构转换为数组实例"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 Array.from 用于将类数组结构转换为数组实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-Array-of-将一组参数转为数组"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 Array.of 将一组参数转为数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-数组空位"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2.3 数组空位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-4-数组迭代器"><span class="toc-number">2.2.4.</span> <span class="toc-text">2.2.4 数组迭代器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-5-复制copyWithin和填充fill"><span class="toc-number">2.2.5.</span> <span class="toc-text">2.2.5 复制copyWithin和填充fill</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-6-检测数组Array-isArray"><span class="toc-number">2.2.6.</span> <span class="toc-text">2.2.6 检测数组Array.isArray()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-7-转换方法"><span class="toc-number">2.2.7.</span> <span class="toc-text">2.2.7 转换方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-8-栈方法"><span class="toc-number">2.2.8.</span> <span class="toc-text">2.2.8 栈方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-9-队列方法"><span class="toc-number">2.2.9.</span> <span class="toc-text">2.2.9 队列方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-10-排序方法"><span class="toc-number">2.2.10.</span> <span class="toc-text">2.2.10 排序方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-11-操作方法"><span class="toc-number">2.2.11.</span> <span class="toc-text">2.2.11 操作方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-12-搜索和位置方法"><span class="toc-number">2.2.12.</span> <span class="toc-text">2.2.12 搜索和位置方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#indexOf、lastIndexOf和includes"><span class="toc-number">2.2.12.1.</span> <span class="toc-text">indexOf、lastIndexOf和includes</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#find和findIndex"><span class="toc-number">2.2.12.2.</span> <span class="toc-text">find和findIndex</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-13-迭代方法"><span class="toc-number">2.2.13.</span> <span class="toc-text">2.2.13 迭代方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-14-归并方法"><span class="toc-number">2.2.14.</span> <span class="toc-text">2.2.14 归并方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Date类型"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 Date类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Set类型"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 Set类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#介绍"><span class="toc-number">2.4.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#API"><span class="toc-number">2.4.2.</span> <span class="toc-text">API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#顺序与迭代"><span class="toc-number">2.4.3.</span> <span class="toc-text">顺序与迭代</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WeakSet"><span class="toc-number">2.4.4.</span> <span class="toc-text">WeakSet</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-Map类型"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 Map类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1-基本"><span class="toc-number">2.5.1.</span> <span class="toc-text">2.5.1 基本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-迭代"><span class="toc-number">2.5.2.</span> <span class="toc-text">2.5.2 迭代</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-3-Object与Map选择"><span class="toc-number">2.5.3.</span> <span class="toc-text">2.5.3 Object与Map选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-4-WeakMap"><span class="toc-number">2.5.4.</span> <span class="toc-text">2.5.4 WeakMap</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#基本"><span class="toc-number">2.5.4.1.</span> <span class="toc-text">基本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#API-1"><span class="toc-number">2.5.4.2.</span> <span class="toc-text">API</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#使用"><span class="toc-number">2.5.4.3.</span> <span class="toc-text">使用</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第3章-Javascript-类、对象、面向对象编程"><span class="toc-number">3.</span> <span class="toc-text">第3章  Javascript-类、对象、面向对象编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-构造函数"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-原型链"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 原型链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-instanceof-原型规则"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 instanceof 原型规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-继承"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 继承</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-原型链继承"><span class="toc-number">3.4.1.</span> <span class="toc-text">3.4.1 原型链继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-盗用构造函数"><span class="toc-number">3.4.2.</span> <span class="toc-text">3.4.2 盗用构造函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-3-组合继承"><span class="toc-number">3.4.3.</span> <span class="toc-text">3.4.3 组合继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-4-原型式继承"><span class="toc-number">3.4.4.</span> <span class="toc-text">3.4.4 原型式继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-5-寄生式继承"><span class="toc-number">3.4.5.</span> <span class="toc-text">3.4.5 寄生式继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-6-寄生式组合继承"><span class="toc-number">3.4.6.</span> <span class="toc-text">3.4.6 寄生式组合继承</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-类"><span class="toc-number">3.5.</span> <span class="toc-text">3.5 类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-类定义"><span class="toc-number">3.5.1.</span> <span class="toc-text">3.5.1 类定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-类构造函数"><span class="toc-number">3.5.2.</span> <span class="toc-text">3.5.2 类构造函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-3-实例、原型和类成员"><span class="toc-number">3.5.3.</span> <span class="toc-text">3.5.3 实例、原型和类成员</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-4-类继承"><span class="toc-number">3.5.4.</span> <span class="toc-text">3.5.4 类继承</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第4章-Javascript-函数"><span class="toc-number">4.</span> <span class="toc-text">第4章 Javascript-函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-箭头函数"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 箭头函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-函数名"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 函数名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-理解参数"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 理解参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-默认参数值"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 默认参数值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-参数扩展与收集"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 参数扩展与收集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-函数声明与函数表达式"><span class="toc-number">4.6.</span> <span class="toc-text">4.6 函数声明与函数表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-函数内部"><span class="toc-number">4.7.</span> <span class="toc-text">4.7 函数内部</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#arguments"><span class="toc-number">4.7.1.</span> <span class="toc-text">arguments</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#this"><span class="toc-number">4.7.2.</span> <span class="toc-text">this</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#caller"><span class="toc-number">4.7.3.</span> <span class="toc-text">caller</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-函数属性与方法"><span class="toc-number">4.8.</span> <span class="toc-text">4.8 函数属性与方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#length"><span class="toc-number">4.8.1.</span> <span class="toc-text">length</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#apply、call与bind"><span class="toc-number">4.8.2.</span> <span class="toc-text">apply、call与bind</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-递归"><span class="toc-number">4.9.</span> <span class="toc-text">4.9 递归</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-10-内存泄漏"><span class="toc-number">4.10.</span> <span class="toc-text">4.10 内存泄漏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11-私有变量"><span class="toc-number">4.11.</span> <span class="toc-text">4.11 私有变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#特权方法"><span class="toc-number">4.11.1.</span> <span class="toc-text">特权方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#模块模式"><span class="toc-number">4.11.2.</span> <span class="toc-text">模块模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第5章-Javascript-异步"><span class="toc-number">5.</span> <span class="toc-text">第5章 Javascript-异步</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-Promise"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 Promise</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-Promise基础"><span class="toc-number">5.1.1.</span> <span class="toc-text">5.1.1 Promise基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2-Promise-all"><span class="toc-number">5.1.2.</span> <span class="toc-text">5.1.2 Promise.all</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3-Promise-race"><span class="toc-number">5.1.3.</span> <span class="toc-text">5.1.3 Promise.race</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-Async-异步函数"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 Async 异步函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-基础"><span class="toc-number">5.2.1.</span> <span class="toc-text">5.2.1 基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-2-await"><span class="toc-number">5.2.2.</span> <span class="toc-text">5.2.2 await</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-3-axios"><span class="toc-number">5.2.3.</span> <span class="toc-text">5.2.3 axios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-4-异步函数策略"><span class="toc-number">5.2.4.</span> <span class="toc-text">5.2.4 异步函数策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-5-串行执行期约"><span class="toc-number">5.2.5.</span> <span class="toc-text">5.2.5 串行执行期约</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Promise、Generator、Async三者的区别"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 Promise、Generator、Async三者的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第6章-Javascript-BOM"><span class="toc-number">6.</span> <span class="toc-text">第6章 Javascript-BOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-window对象"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 window对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器视口"><span class="toc-number">6.1.1.</span> <span class="toc-text">浏览器视口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#导航和打开新窗口"><span class="toc-number">6.1.2.</span> <span class="toc-text">导航和打开新窗口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#定时器"><span class="toc-number">6.1.3.</span> <span class="toc-text">定时器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#系统对话"><span class="toc-number">6.1.4.</span> <span class="toc-text">系统对话</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-location对象获取页面信息"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 location对象获取页面信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-navigation对象通常用来确定浏览器类型"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 navigation对象通常用来确定浏览器类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-history对象操作浏览器历史"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 history对象操作浏览器历史</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第7章-Javascript-DOM"><span class="toc-number">7.</span> <span class="toc-text">第7章 Javascript-DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-Dom-节点操作"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 Dom 节点操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-Dom-事件模型"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 Dom 事件模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-Dom-事件类"><span class="toc-number">7.3.</span> <span class="toc-text">7.3 Dom 事件类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第8章-Javascript-生成器"><span class="toc-number">8.</span> <span class="toc-text">第8章 Javascript-生成器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-简介"><span class="toc-number">8.1.</span> <span class="toc-text">7.1 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-基础"><span class="toc-number">8.2.</span> <span class="toc-text">7.2 基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-yield"><span class="toc-number">8.3.</span> <span class="toc-text">7.3 yield</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-终止生成器"><span class="toc-number">8.4.</span> <span class="toc-text">7.4 终止生成器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第9章-Javascript-跨端请求"><span class="toc-number">9.</span> <span class="toc-text">第9章 Javascript-跨端请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-XMLHttpRequest对象"><span class="toc-number">9.1.</span> <span class="toc-text">9.1 XMLHttpRequest对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-Ajax的限制"><span class="toc-number">9.2.</span> <span class="toc-text">9.2 Ajax的限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-Fetch"><span class="toc-number">9.3.</span> <span class="toc-text">9.3 Fetch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-跨域解决方案"><span class="toc-number">9.4.</span> <span class="toc-text">9.4 跨域解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-1-CORS"><span class="toc-number">9.4.1.</span> <span class="toc-text">9.4.1 CORS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-2-WebSocket"><span class="toc-number">9.4.2.</span> <span class="toc-text">9.4.2 WebSocket</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-3-JSONP"><span class="toc-number">9.4.3.</span> <span class="toc-text">9.4.3 JSONP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-4-Img"><span class="toc-number">9.4.4.</span> <span class="toc-text">9.4.4 Img</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-5-Hash"><span class="toc-number">9.4.5.</span> <span class="toc-text">9.4.5 Hash</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-6-postMessage"><span class="toc-number">9.4.6.</span> <span class="toc-text">9.4.6 postMessage</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第10章-Javascript-客户端存储"><span class="toc-number">10.</span> <span class="toc-text">第10章 Javascript-客户端存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-cookie"><span class="toc-number">10.1.</span> <span class="toc-text">10.1 cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-WebStorage"><span class="toc-number">10.2.</span> <span class="toc-text">10.2 WebStorage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-Cookie-与-Local-storage-与-Session-storage-区别"><span class="toc-number">10.3.</span> <span class="toc-text">10.3 Cookie 与 Local storage 与 Session storage 区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-IndexDB"><span class="toc-number">10.4.</span> <span class="toc-text">10.4  IndexDB</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第11章-Javascript-模块化"><span class="toc-number">11.</span> <span class="toc-text">第11章 Javascript-模块化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第12章-Javascript-性能优化"><span class="toc-number">12.</span> <span class="toc-text">第12章 Javascript-性能优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第13章-Javascript-Web安全"><span class="toc-number">13.</span> <span class="toc-text">第13章 Javascript-Web安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS"><span class="toc-number">13.1.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF"><span class="toc-number">13.2.</span> <span class="toc-text">CSRF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第14章-Javascript-算法"><span class="toc-number">14.</span> <span class="toc-text">第14章 Javascript-算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#防抖节流"><span class="toc-number">14.1.</span> <span class="toc-text">防抖节流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#防抖"><span class="toc-number">14.1.1.</span> <span class="toc-text">防抖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#节流"><span class="toc-number">14.1.2.</span> <span class="toc-text">节流</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#深浅拷贝"><span class="toc-number">14.2.</span> <span class="toc-text">深浅拷贝</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#排序算法"><span class="toc-number">14.3.</span> <span class="toc-text">排序算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#深度遍历和广度遍历"><span class="toc-number">14.4.</span> <span class="toc-text">深度遍历和广度遍历</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二分查找"><span class="toc-number">14.5.</span> <span class="toc-text">二分查找</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二叉树"><span class="toc-number">14.6.</span> <span class="toc-text">二叉树</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第14章-Javascript-网页性能优化"><span class="toc-number">15.</span> <span class="toc-text">第14章 Javascript-网页性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#性能监控"><span class="toc-number">15.1.</span> <span class="toc-text">性能监控</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络层面"><span class="toc-number">15.2.</span> <span class="toc-text">网络层面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#渲染层面"><span class="toc-number">15.3.</span> <span class="toc-text">渲染层面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第15章-Javascript-ES2018和ES2019"><span class="toc-number">16.</span> <span class="toc-text">第15章 Javascript-ES2018和ES2019</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数组打平"><span class="toc-number">16.1.</span> <span class="toc-text">数组打平</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-fromEntries"><span class="toc-number">16.2.</span> <span class="toc-text">Object.fromEntries()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#处理开头末尾空格"><span class="toc-number">16.3.</span> <span class="toc-text">处理开头末尾空格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Symbol-prototype-description"><span class="toc-number">16.4.</span> <span class="toc-text">Symbol.prototype.description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#省略catch的错误对象"><span class="toc-number">16.5.</span> <span class="toc-text">省略catch的错误对象</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/chicken.gif)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Tammy-Zting-Blog</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Javascript 宝典</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2021-08-25 13:55:27"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2021-08-25</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-08-25 14:10:48"><i class="fas fa-history fa-fw"></i> 更新于 2021-08-25</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="第1章-Javascript-基础知识"><a href="#第1章-Javascript-基础知识" class="headerlink" title="第1章 Javascript-基础知识"></a>第1章 Javascript-基础知识</h2><h3 id="1-1-变量类型与变量计算"><a href="#1-1-变量类型与变量计算" class="headerlink" title="1.1 变量类型与变量计算"></a>1.1 变量类型与变量计算</h3><h4 id="1-1-1-值类型与引用类型"><a href="#1-1-1-值类型与引用类型" class="headerlink" title="1.1.1 值类型与引用类型"></a>1.1.1 值类型与引用类型</h4><h5 id="值类型"><a href="#值类型" class="headerlink" title="值类型"></a>值类型</h5><ul>
<li><p>值类型(不会相互影响):undefined、string、number、boolean</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=<span class="number">100</span>;</span><br><span class="line"><span class="keyword">var</span> b=a;</span><br><span class="line">a=<span class="number">200</span>;</span><br><span class="line"><span class="built_in">console</span>.log(b)<span class="comment">//100</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h5><ul>
<li><p>引用类型：对象、数组、函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=&#123;<span class="attr">age</span>:<span class="number">20</span>&#125;</span><br><span class="line"><span class="keyword">var</span> b=a</span><br><span class="line">b.age=<span class="number">21</span></span><br><span class="line"><span class="built_in">console</span>.log(a.age)<span class="comment">//21</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="值类型与引用类型的区别"><a href="#值类型与引用类型的区别" class="headerlink" title="值类型与引用类型的区别"></a>值类型与引用类型的区别</h5><ul>
<li>两者之间的一个区别是，原始数据类型是通过值传递的，对象是通过引用传递的。</li>
<li>值传递：意味着创建原始文件的副本。把它想象成一对双胞胎:他们出生的时候一模一样，但是双胞胎中的老大在战争中失去了一条腿，而老二却没有。</li>
<li>引用传递: 意味着创建原始文件的别名。当我妈妈叫沙雕的时候，虽然我的名字叫小智，但这并不是说我就突然就克隆了一个自己:我仍然是我，只是可以用不同名字来称呼我而已。</li>
<li>JS中的“严格”模式是什么 当使用严格模式时，不能使用隐式声明的变量，或为只读属性赋值，或向不可扩展的对象添加属性。</li>
</ul>
<h5 id="值类型和引用类型的提升"><a href="#值类型和引用类型的提升" class="headerlink" title="值类型和引用类型的提升"></a>值类型和引用类型的提升</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeAgeAndReference</span>(<span class="params">person</span>)</span>&#123;</span><br><span class="line">    person.age = <span class="number">25</span>;</span><br><span class="line">    person = &#123;</span><br><span class="line">        nage : <span class="string">'John'</span>,</span><br><span class="line">        age : <span class="number">50</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> person ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> personObj1=&#123;</span><br><span class="line">    name : <span class="string">'Alex'</span>,</span><br><span class="line">    age : <span class="number">30</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> personObj2 = changeAgeAndReference(personObj1);</span><br><span class="line"><span class="built_in">console</span>.log(personObj1)  <span class="comment">//&#123;name: "Alex", age: 25&#125;  age是引用类型，故personObj1的age改成了25</span></span><br><span class="line"><span class="built_in">console</span>.log(personObj2)	<span class="comment">//&#123;nage: "John", age: 50&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-1-2-变量"><a href="#1-1-2-变量" class="headerlink" title="1.1.2 变量"></a>1.1.2 变量</h4><h5 id="var变量提升"><a href="#var变量提升" class="headerlink" title="var变量提升"></a>var变量提升</h5><ul>
<li>即将所有的变量声明都拉到函数作用域的顶部  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(age) <span class="comment">//undefined</span></span><br><span class="line">    <span class="keyword">var</span> age =<span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line">foo()</span><br><span class="line"><span class="comment">//之所以不会报错，是因为ECMAScript运行时把它看成等价于如下代码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> age</span><br><span class="line">    <span class="built_in">console</span>.log(age)</span><br><span class="line">    age = <span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line">foo()  <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>
<h5 id="let块作用域"><a href="#let块作用域" class="headerlink" title="let块作用域"></a>let块作用域</h5></li>
<li>暂时性死区<ul>
<li>在let声明之前的执行瞬间都会抛出错误，这就是与var很大不同  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//name 会被提升</span></span><br><span class="line"><span class="built_in">console</span>.log(name) <span class="comment">//undefined</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'Matt'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//age 不会被提升</span></span><br><span class="line"><span class="built_in">console</span>.log(age); <span class="comment">//RefferenceError age没有定义</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="number">26</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>全局声明：let在全局作用域声明的变量不会成为window对象属性(var则会)</li>
</ul>
<h5 id="const"><a href="#const" class="headerlink" title="const"></a>const</h5><ul>
<li><p>同let基本相同，声明变量时必须同时初始化变量，且尝试修改const声明的变量会导致运行时错误</p>
</li>
<li><p>声明限制只适用于它指向的变量引用，如果const变量引用的是一个对象，修改对象内部并不违反const的限制</p>
</li>
<li><p>对于迭代循环中使用</p>
<ul>
<li><p>for中因为迭代变量会自增会发生错误</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> i =<span class="number">0</span>;i&lt;<span class="number">10</span>;++i)()<span class="comment">//TypeError 给常量赋值</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>for-in和for-of循环可以使用</strong></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> key <span class="keyword">in</span> &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//a,b</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> value <span class="keyword">of</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1,2,3,4</span></span><br></pre></td></tr></table></figure>
<h5 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h5></li>
</ul>
</li>
<li><p>不使用var</p>
</li>
<li><p><strong>const优先，let其次使用const声明可以让浏览器运行时强制保持变量不变。只在提前知道未来会修改时，再使用let。</strong></p>
</li>
</ul>
<h4 id="1-1-3-变量计算"><a href="#1-1-3-变量计算" class="headerlink" title="1.1.3 *变量计算"></a>1.1.3 <strong>*变量计算</strong></h4><h5 id="强类型转换"><a href="#强类型转换" class="headerlink" title="强类型转换"></a>强类型转换</h5><ul>
<li><p>字符串拼接</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> b = <span class="number">100</span>+<span class="string">'10'</span>  <span class="comment">//'10010'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运算符(<strong>下面0、null、’’、undefined都转化为false，所有相等，用的时候要小心</strong>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">100</span> == <span class="string">'100'</span>  <span class="comment">//true</span></span><br><span class="line"><span class="number">0</span> == <span class="string">''</span> <span class="comment">//true</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">undefined</span> <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">10</span> &amp;&amp; <span class="number">0</span>); <span class="comment">//0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">''</span> || <span class="string">'abc'</span>); <span class="comment">//abc</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="built_in">window</span>.acb); <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//判断一个变量会被当做true还是false</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">console</span>.log(!!a);<span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h5 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h5><h6 id="一元操作符"><a href="#一元操作符" class="headerlink" title="一元操作符"></a>一元操作符</h6><ul>
<li><p>递增/递减操作符(++ / –):前缀操作符，会在被求值之前改变；后缀操作符，则会在被求值之后改变。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num1 = <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> num2 = <span class="number">20</span></span><br><span class="line"><span class="keyword">let</span> num3 = --num1 + num2</span><br><span class="line"><span class="built_in">console</span>.log(num1)  <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(num3)  <span class="comment">//21</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="literal">false</span> </span><br><span class="line"><span class="built_in">console</span>.log(a++)   <span class="comment">//1</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="位操作符"><a href="#位操作符" class="headerlink" title="位操作符"></a>位操作符</h6><ul>
<li><p>按位非(-):对数值取反减1</p>
</li>
<li><p>按位与(&amp;):同为同，异为0</p>
</li>
<li><p>按位或(|):同为同，异为1</p>
</li>
<li><p>按位异或(^):同为0，异为1</p>
</li>
<li><p>左移</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> oldValue = <span class="number">2</span> <span class="comment">//等于二进制10</span></span><br><span class="line"><span class="keyword">let</span> newValue = oldValue &lt;&lt; <span class="number">5</span> <span class="comment">//等于二进制1000000即十进制64</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>有/无符号 右移</p>
<ul>
<li><p>有符号右移:2个大于号表示，同时保留符号(正或负)</p>
</li>
<li><p>无符号右移:3个大于号表示</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> oldValue = <span class="number">64</span> <span class="comment">//等于二进制 1000000</span></span><br><span class="line"><span class="keyword">let</span> newValue = oldValue &gt;&gt;&gt; <span class="number">5</span>  <span class="comment">//等于二进制10，即十进制2</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h6 id="指数操作符"><a href="#指数操作符" class="headerlink" title="指数操作符"></a>指数操作符</h6><ul>
<li><p>ES7新增了指数操作符，Math.pow()等于**</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.pow(<span class="number">3</span>,<span class="number">2</span>))  <span class="comment">//9</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span> ** <span class="number">2</span>)  <span class="comment">//9</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>指数赋值操作符**=</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> squared = <span class="number">3</span></span><br><span class="line">squared **= <span class="number">2</span></span><br><span class="line"><span class="built_in">console</span>.log(squared)  <span class="comment">//9</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="加减操作符"><a href="#加减操作符" class="headerlink" title="加减操作符"></a>加减操作符</h6><ul>
<li><p>加法操作符</p>
<ul>
<li><p>任一操作数是NaN，则返回NaN</p>
</li>
<li><p>Infinity加-Infinity,则返回NaN</p>
</li>
<li><p><strong>其中一个操作数是字符串，则另一操作数也会被转换为字符串，再将两个字符串拼接起来</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result =<span class="number">5</span> + <span class="string">"5"</span></span><br><span class="line"><span class="built_in">console</span>.log(result)  <span class="comment">//"55"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>任一操作数是对象、数值或布尔值，则调用它们的toString()方法获取字符串。对于undefined和null,则调用String()函数，分别获取”undefined”和”null”</strong></p>
</li>
</ul>
</li>
<li><p>减法操作符</p>
<ul>
<li><p>如果任一操作数是字符串、布尔值、null或undefined,则会使用Number()转为数值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = <span class="number">5</span> - <span class="literal">true</span> <span class="comment">// 4</span></span><br><span class="line"><span class="keyword">let</span> result2 = <span class="literal">NaN</span> - <span class="number">1</span> <span class="comment">//NaN</span></span><br><span class="line"><span class="keyword">let</span> result3 = <span class="number">5</span> - <span class="string">""</span>  <span class="comment">//5</span></span><br><span class="line"><span class="keyword">let</span> result4 = <span class="number">5</span> - <span class="string">"2"</span>  <span class="comment">//3</span></span><br><span class="line"><span class="keyword">let</span> result5 = <span class="number">5</span> - <span class="literal">null</span> <span class="comment">//5</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h6 id="相等操作符"><a href="#相等操作符" class="headerlink" title="相等操作符"></a>相等操作符</h6><table>
<thead>
<tr>
<th>表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>undefined == null</td>
<td>true</td>
</tr>
<tr>
<td>false == 0</td>
<td>true</td>
</tr>
<tr>
<td>true == 1</td>
<td>true</td>
</tr>
<tr>
<td>undefined == 0</td>
<td>false</td>
</tr>
<tr>
<td>null == 0</td>
<td>false</td>
</tr>
<tr>
<td>“5” == 5</td>
<td>true</td>
</tr>
</tbody></table>
<h5 id="Js中使用typeof能得到的类型"><a href="#Js中使用typeof能得到的类型" class="headerlink" title="Js中使用typeof能得到的类型"></a>Js中使用typeof能得到的类型</h5><ul>
<li><p>可以得到类型如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//问题：JS中使用typeof能得到哪些类型</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">undefined</span> <span class="comment">//undefined</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="string">'abc'</span> <span class="comment">// String</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">123</span> <span class="comment">//number</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span> <span class="comment">//boolean</span></span><br><span class="line"><span class="keyword">typeof</span> &#123;&#125; <span class="comment">//object</span></span><br><span class="line"><span class="keyword">typeof</span> [] <span class="comment">//object</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span> <span class="comment">//object</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="built_in">console</span>.log <span class="comment">//funciton</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>typeof可以得到<code>undefined、string、number、boolean</code></strong></p>
</li>
<li><p><strong>可以区分值类型，但对于引用类型无法很细的区分，只能区分函数。</strong></p>
</li>
<li><p><strong>尤其是<code>typeof null object</code>，它是一个引用类型</strong></p>
</li>
</ul>
<h5 id="在if里面都会为false"><a href="#在if里面都会为false" class="headerlink" title="在if里面都会为false"></a><strong>在if里面都会为false</strong></h5><ul>
<li>0</li>
<li>NaN</li>
<li>‘’</li>
<li>null</li>
<li>undefined</li>
</ul>
<h5 id="何时使用-和"><a href="#何时使用-和" class="headerlink" title="何时使用===和=="></a>何时使用===和==</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//问题：何时使用===何时使用==</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (obj.a == <span class="literal">null</span>) &#123;</span><br><span class="line">  <span class="comment">//这里相当于 obj.a === null || obj.a === undefined,简写形式</span></span><br><span class="line">  <span class="comment">//这是jquery源码中推荐的写法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="JS中的内置函数"><a href="#JS中的内置函数" class="headerlink" title="JS中的内置函数"></a>JS中的内置函数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//问题：JS中有哪些内置函数----数据封装类对象</span></span><br><span class="line"><span class="comment">//作为构造函数的作用</span></span><br><span class="line"><span class="built_in">Object</span></span><br><span class="line"><span class="built_in">Array</span></span><br><span class="line"><span class="built_in">Boolean</span></span><br><span class="line"><span class="built_in">Number</span></span><br><span class="line"><span class="built_in">String</span></span><br><span class="line"><span class="built_in">Function</span></span><br><span class="line"><span class="built_in">Date</span></span><br><span class="line"><span class="built_in">RegExp</span></span><br><span class="line"><span class="built_in">Error</span></span><br></pre></td></tr></table></figure>

<h5 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h5><ul>
<li><p>浮点值:如下两种情况都会转为整数值</p>
<ul>
<li>小数点后没有数字（如:1.）</li>
<li>数值本来就是整数，只是小数点后面跟着0（如:1.0）</li>
</ul>
</li>
<li><p>Number()</p>
<ul>
<li><strong>undefined 返回NaN</strong></li>
<li>null 返回 0</li>
<li>字符串 比如’011’返回11，无法转为数值的则返回NaN</li>
<li>true返回1 false返回0</li>
</ul>
</li>
<li><p>parseInt()</p>
<ul>
<li><p>“124blye” 返回124</p>
</li>
<li><p><strong>“” 返回NaN</strong></p>
</li>
<li><p>“0xA” 解释为十六进制数 返回10</p>
</li>
<li><p>“22.5” 返回22</p>
</li>
<li><p>传入第二个参数的用法</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="number">10</span>,<span class="number">2</span>)) <span class="comment">//2 按照二进制解析</span></span><br><span class="line"><span class="built_in">console</span>.log(paeseInt(<span class="number">10</span>,<span class="number">8</span>))  <span class="comment">//8 按照八进制解析</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>parseFloat()</p>
</li>
<li><p>toString()和String()</p>
<ul>
<li>toString方法可见于数值、布尔值、对象和字符串，null和undefined没有该方法  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">10</span></span><br><span class="line"><span class="built_in">console</span>.log(num.toString())  <span class="comment">//"10"</span></span><br><span class="line"><span class="built_in">console</span>.log(num.toString(<span class="number">2</span>))  <span class="comment">//"1010"</span></span><br></pre></td></tr></table></figure></li>
<li>String()基本同上，null和undefined有所不同  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">String</span>(<span class="literal">null</span>))  <span class="comment">//"null"</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">String</span>(<span class="literal">undefined</span>)) <span class="comment">//"undefined"</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//使用toString会报错</span></span><br><span class="line">        <span class="keyword">let</span> a = <span class="literal">null</span></span><br><span class="line">        <span class="built_in">console</span>.log(a.toString())  <span class="comment">//Uncaught TypeError:</span></span><br><span class="line">        <span class="built_in">console</span>.log(b.toString())  <span class="comment">//Uncaught ReferenceError:</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">##### isNaN</span><br><span class="line"></span><br><span class="line">- <span class="literal">NaN</span>不等于本身</span><br><span class="line"></span><br><span class="line">- **<span class="built_in">isNaN</span>()传入一个参数，首先会尝试将其转为数值，无法转为数值返回<span class="literal">true</span>**</span><br><span class="line"></span><br><span class="line">  <span class="string">``</span><span class="string">`js</span></span><br><span class="line"><span class="string">  console.log(isNaN(10)) //false</span></span><br><span class="line"><span class="string">  console.log(isNaN("10")  //false</span></span><br><span class="line"><span class="string">  console.log(isNaN(blue)  //true</span></span><br><span class="line"><span class="string">  console.log(isNaN(true)  //false</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h5 id="Infinity"><a href="#Infinity" class="headerlink" title="Infinity"></a>Infinity</h5><ul>
<li>任何无穷大的正数用Infinity表示，负数用-Infinity</li>
</ul>
<h5 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h5><ul>
<li><p>舍入方法</p>
<ul>
<li><p>Math.ceil() 向上取舍</p>
</li>
<li><p>Math.floor() 向下取舍</p>
</li>
<li><p>Math.round() 四舍五入</p>
</li>
<li><p>Math.fround() 返回数值最接近的单精度(32位)浮点值表示</p>
<p><img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/674e6573e6f63a03d51b28a1450c4908?method=download&shareKey=e89c0fa064ba7df2c0feff913fd69d1a" alt=""></p>
</li>
</ul>
</li>
</ul>
<h5 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//问题：如何理解JSON</span></span><br><span class="line"><span class="comment">//JSON只不过是一个JS对象</span></span><br><span class="line"><span class="comment">//JSON也是一个数据格式</span></span><br><span class="line"><span class="built_in">JSON</span>.stringify(&#123;<span class="attr">a</span>:<span class="number">10</span>,<span class="attr">b</span>:<span class="number">20</span>&#125;);</span><br><span class="line"><span class="built_in">JSON</span>.parse(<span class="string">'&#123;"a":10."b":20&#125;'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="1-2-执行上下午与作用域"><a href="#1-2-执行上下午与作用域" class="headerlink" title="1.2 执行上下午与作用域"></a>1.2 执行上下午与作用域</h3><h4 id="执行上下文"><a href="#执行上下文" class="headerlink" title="执行上下文"></a>执行上下文</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a);  <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">fn(<span class="string">'tammy'</span>)  <span class="comment">// 'tammy' 20</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  age = <span class="number">20</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(name, age);</span><br><span class="line">  <span class="keyword">var</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>注意⚠️“函数声明”和“函数表达式”的区别</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fn()</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//函数声明</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fn1()</span><br><span class="line"><span class="keyword">var</span> fn1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//函数表达式</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>; <span class="comment">//类似于这个</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="创建10个标签-点击的时候弹出来对应的序号"><a href="#创建10个标签-点击的时候弹出来对应的序号" class="headerlink" title="创建10个标签 点击的时候弹出来对应的序号"></a><strong>创建10个<a>标签 点击的时候弹出来对应的序号</strong></h4><ul>
<li><p>错误写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这是一个错误的写法！！！</span></span><br><span class="line"><span class="keyword">var</span> i,a;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">  a.innerHTML = i + <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">  a.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    alert(i)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出为如下： &lt;a&gt;"9"&lt;br&gt;&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>正确写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这是一个正确写法！！！</span></span><br><span class="line"><span class="keyword">var</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">    a.innerHTML = i + <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">    a.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line">      alert(i);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(a);</span><br><span class="line">  &#125;)(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="1-3-基本数据类型"><a href="#1-3-基本数据类型" class="headerlink" title="1.3  基本数据类型"></a>1.3  基本数据类型</h3><ul>
<li><p>JavaScript(ES6)中，现在有6种基本数据类型</p>
<p>Undefined、Null、Boolean、Number、String、Symbol</p>
</li>
</ul>
<h4 id="Number-1"><a href="#Number-1" class="headerlink" title="Number"></a>Number</h4><ul>
<li>toFixed() 方法返回包含指定小数点位数的数值字符串  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">10</span></span><br><span class="line"><span class="built_in">console</span>.log(num.toFixed(<span class="number">2</span>))    <span class="comment">//"10.00"</span></span><br></pre></td></tr></table></figure></li>
<li>ES6新增了Number.IsInteger()方法，用于辨别一个数值是否保存为整数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>.isInteger(<span class="number">1</span>))  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>.isInteger(<span class="number">1.00</span>))  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>.isInteger(<span class="number">1.01</span>))  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><ul>
<li><p>常用的几个方法</p>
<ul>
<li><p>concat 连接字符串</p>
</li>
<li><p>slice、substr、substring 提取子字符串</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">"hello world"</span></span><br><span class="line"><span class="comment">//正数参数</span></span><br><span class="line"><span class="comment">//一个参数</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.slice(<span class="number">3</span>))  <span class="comment">//"lo world"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substring(<span class="number">3</span>)) <span class="comment">//"lo world"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substr(<span class="number">3</span>))  <span class="comment">//"lo world"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//两个参数</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.slice(<span class="number">3</span>,<span class="number">7</span>))  <span class="comment">//"lo w"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substring(<span class="number">3</span>,<span class="number">7</span>)) <span class="comment">//"lo w"</span></span><br><span class="line"><span class="comment">//与上不同</span></span><br><span class="line"><span class="comment">//第二个参数表示返回子字符串长度</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substr(<span class="number">3</span>,<span class="number">7</span>)) <span class="comment">// "lo worl"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//负数参数</span></span><br><span class="line"><span class="comment">//一个参数</span></span><br><span class="line"><span class="comment">//长度加上负参数 下面相当于8</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.slice(<span class="number">-3</span>))  <span class="comment">//"rld"</span></span><br><span class="line"><span class="comment">//负数转化为0</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substr(<span class="number">-3</span>)) <span class="string">"rld"</span></span><br><span class="line"><span class="built_in">console</span>.log(substring(<span class="number">-3</span>)) <span class="string">"hello wolrd"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//两个参数</span></span><br><span class="line"><span class="comment">//第二个参数等于长度加上该负数即3到7</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.slice(<span class="number">3</span>,<span class="number">-4</span>))<span class="comment">//"lo w"</span></span><br><span class="line"><span class="comment">//第二个负数转为0 即0到3</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substring(<span class="number">3</span>,<span class="number">-4</span>))<span class="comment">//"hel"</span></span><br><span class="line"><span class="comment">//第二个负数转为0 代表字符串长度为0 即空字符串</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substr(<span class="number">3</span>,<span class="number">-4</span>))  <span class="comment">//""</span></span><br></pre></td></tr></table></figure></li>
<li><p>indexOf()、lastIndexOf() 定位子字符串，两者区别在于一个是在字符串开头查找，一个是末尾查找</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">"hello world"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.indexOf(<span class="string">"o"</span>)) <span class="comment">//4</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.lastIndexOf(<span class="string">"o"</span>))  <span class="comment">//7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//第二个参数代表开始搜索的位置</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.indexOf(<span class="string">"o"</span>,<span class="number">6</span>)) <span class="comment">//7</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.lastIndex(<span class="string">"o"</span>,<span class="number">6</span>))  <span class="comment">//4</span></span><br></pre></td></tr></table></figure></li>
<li><p>startsWith()、endsWith()和includes(),区别在于startsWith()检查开始于索引0，endsWith()反之，而includes()检查整个字符串    </p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//startsWith和includes方法的第二个参数，表示开始搜索的位置</span></span><br><span class="line"><span class="keyword">let</span> message = <span class="string">"foobarbaz"</span></span><br><span class="line"><span class="built_in">console</span>.log(message.startsWith(<span class="string">"foo"</span>,<span class="number">1</span>)) <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(message.includes(<span class="string">"bar"</span>,<span class="number">4</span>)) <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//endsWith第二个参数，表示应该当作字符串末尾的位置，默认不传则是字符串长度</span></span><br><span class="line"><span class="built_in">console</span>.log(message.endsWith(<span class="string">"bar"</span>,<span class="number">6</span>))  <span class="comment">//true</span></span><br></pre></td></tr></table></figure></li>
<li><p>trim()清除字符串前后包含的空格，返回的是字符串的副本，原字符串不受影响，trimLeft和trimRight分别用于从字符串的开始和末尾清除空字符串</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">" hello world "</span></span><br><span class="line"><span class="keyword">let</span> trimmedStringValue = stringValue.trim()  </span><br><span class="line"><span class="built_in">console</span>.log(trimmedStringValue) <span class="comment">//"hello world"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue) <span class="string">" hello world "</span></span><br></pre></td></tr></table></figure></li>
<li><p>repeat方法接收一个整数参数，表示要将字符串复制多少次，然后返回拼接所有副本后的结果</p>
</li>
<li><p>padStart和padEnd方法用于复制字符串，第一个参数是长度，第二个参数是可选填充字符串</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">"foo"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padStart(<span class="number">6</span>)) <span class="comment">//"   foo"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padStart(<span class="number">9</span>,<span class="string">"."</span>)) <span class="comment">//"......foo"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padEnd(<span class="number">6</span>))  <span class="comment">//"foo   "</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padEnd(<span class="number">9</span>,<span class="string">"."</span>)) <span class="comment">//"foo......"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//如提供的字符串多余，则会将其拼接并截断姨匹配指定长度，此外长度小于或者等于字符串长度，则会返回原字符串</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padStart(<span class="number">8</span>,<span class="string">"bar"</span>))  <span class="comment">//"barbafoo"</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padStart(<span class="number">2</span>)) <span class="comment">//"foo"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padEnd(<span class="number">8</span>,<span class="string">"foo"</span>)) <span class="comment">//"foobarba"</span></span><br></pre></td></tr></table></figure></li>
<li><p>字符串的解构</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message = <span class="string">"abcde"</span></span><br><span class="line"><span class="built_in">console</span>.log([...message]) <span class="comment">//["a","b","c","d","e"]</span></span><br></pre></td></tr></table></figure></li>
<li><p>字符串大小写转换toLowerCase()、toLocaleLowerCase()、toUpperCase()和toLocaleUpperCase(),<strong>如果不知道代码涉及什么语言，最好使用地区特定转换方法</strong></p>
</li>
<li><p>字符串匹配模式</p>
<ul>
<li><p>match()</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="string">"cat, bat, sat, fat"</span></span><br><span class="line"><span class="keyword">let</span> pattern = <span class="regexp">/.at/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//等价于pattern.exec(text)</span></span><br><span class="line"><span class="keyword">let</span> matches = text.match(pattern)</span><br><span class="line"><span class="built_in">console</span>.log(matches[<span class="number">0</span>]) <span class="comment">//"cat"</span></span><br></pre></td></tr></table></figure></li>
<li><p>search() 返回第一个匹配的位置索引，如果没有找到则返回-1</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> pos = text.search(<span class="regexp">/at/</span>)</span><br><span class="line"><span class="built_in">console</span>.log(pos)  <span class="comment">//1</span></span><br></pre></td></tr></table></figure></li>
<li><p>replace()接收两个参数，第一个参数可以是RegExp对象或一个字符串，第二个参数可以是一个字符串或函数。如果第一个参数是字符串，只会替换第一个子字符串，要想替换所有子字符串，必须用正则并且带全局标记</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = text.replace(<span class="string">"at"</span>,<span class="string">"ond"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(result) <span class="comment">//"cond, bat, sat, fat"</span></span><br><span class="line"></span><br><span class="line">result = text.replace(<span class="regexp">/at/g</span>, <span class="string">"ond"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(result) <span class="comment">//"cond, bond, sond, fond"</span></span><br></pre></td></tr></table></figure>
<p>  第二个参数是字符串的情况下，有几个特殊的字符序列，可以用来插入正则表达式操作的值</p>
<p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/e37860e6af91e8f3734ceb636baa8906?method=download&shareKey=265ec801dd797a4362d149fc54a1e2f7" alt=""></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = text.replace(<span class="regexp">/(.at)/g</span>,<span class="string">"word ($1)"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(result) <span class="comment">//word (cat), word (bat), word (sat), word (fat)</span></span><br></pre></td></tr></table></figure>
<p>  第二个参数是函数的情况下，函数会接收三个参数</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">htmlEscape</span>(<span class="params">text</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> text.replace(<span class="regexp">/[&lt;&gt;"&amp;]/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">match,pos,originalText</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(match)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"&lt;"</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"&amp;lt;"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"&gt;"</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"&amp;gt;"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"&amp;"</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"&amp;amp;"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"\":</span></span><br><span class="line"><span class="string">                return "</span>&amp;quot<span class="string">";</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">console.log(htmlEscape("</span>&lt;p <span class="class"><span class="keyword">class</span></span>=\<span class="string">"greeting\"&gt;Hello world!&lt;/p&gt;"</span>))</span><br><span class="line"><span class="comment">//"&amp;lt;p class=&amp;quot;greeting&amp;quot;&amp;gt;Hello world!&lt;/p&gt;"</span></span><br></pre></td></tr></table></figure></li>
<li><p>split()</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colorText = <span class="string">"red,blue,green,yellow"</span></span><br><span class="line"><span class="keyword">let</span> colors1 = colorText.split(<span class="string">","</span>)<span class="comment">//["red","blue","green","yellow"]</span></span><br><span class="line"><span class="keyword">let</span> colors2 = colorText.split(<span class="string">","</span>,<span class="number">2</span>) <span class="comment">//["red","blue"]</span></span><br><span class="line"><span class="keyword">let</span> colors3 = colorsText.split(<span class="regexp">/[^,]+/</span>) <span class="comment">//["", ",", ",", ",", ""]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="1-4-语句"><a href="#1-4-语句" class="headerlink" title="1.4 语句"></a>1.4 语句</h3><h4 id="标签语句"><a href="#标签语句" class="headerlink" title="标签语句"></a>标签语句</h4><ul>
<li>下面的例子，start是一个标签，可以在后面通过break或continue语句引用  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start: <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i &lt; count; i++)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="break"><a href="#break" class="headerlink" title="break"></a>break</h4><ul>
<li>break使用标签语句的示例  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">0</span></span><br><span class="line">outermost:</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">5</span> &amp;&amp; j == <span class="number">5</span>)&#123;</span><br><span class="line">            <span class="keyword">break</span> outermost</span><br><span class="line">        &#125;</span><br><span class="line">        num++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(num)  <span class="comment">//55</span></span><br></pre></td></tr></table></figure>
  添加标签不仅让break退出j的内部循环，也会退出i的外部循环，当执行到i和j都等于5时，循环停止执行。</li>
</ul>
<h4 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h4><ul>
<li><p>continue使用标签语句的示例</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">0</span></span><br><span class="line">outermost:</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j =<span class="number">0</span>; j &lt; <span class="number">10</span>; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">5</span> &amp;&amp; j == <span class="number">5</span>)&#123;</span><br><span class="line">            <span class="keyword">continue</span> outermost</span><br><span class="line">        &#125;</span><br><span class="line">        num++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(num)  <span class="comment">//95</span></span><br></pre></td></tr></table></figure>
<p>  <strong>continue语句会强制循环继续执行，但不是继续执行内部循环，而是继续循环外部</strong>，当满足条件时，执行continue到外部循环继续执行，从而导致内部循环少执行5次</p>
</li>
</ul>
<h2 id="第2章-Javascript-引用类型"><a href="#第2章-Javascript-引用类型" class="headerlink" title="第2章 Javascript-引用类型"></a>第2章 Javascript-引用类型</h2><h3 id="2-1-Object类型"><a href="#2-1-Object类型" class="headerlink" title="2.1  Object类型"></a>2.1  Object类型</h3><h4 id="2-1-1-定义对象"><a href="#2-1-1-定义对象" class="headerlink" title="2.1.1 定义对象"></a>2.1.1 定义对象</h4><ul>
<li><p>方法一</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">person.name = <span class="string">"Tammy"</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法二</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  name:<span class="string">"Tammy"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-1-2-简写对象语法"><a href="#2-1-2-简写对象语法" class="headerlink" title="2.1.2 简写对象语法"></a>2.1.2 简写对象语法</h4><ul>
<li><p>简写对象属性</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">'Matt'</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    name: name</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//等价于上面</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>简写方法名</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'....'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//等价于上面</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    sayName(name) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(...)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//简写方法名可与计算属性相互兼容</span></span><br><span class="line"><span class="keyword">const</span> methodKey = <span class="string">'sayName'</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    [methodKey](name) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(...)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-3-合并对象Object-assign"><a href="#2-1-3-合并对象Object-assign" class="headerlink" title="2.1.3 合并对象Object.assign"></a>2.1.3 合并对象Object.assign</h4></li>
<li><p>Object.assign()实际上对每个源对象执行的是浅复制,它接收一个目标对象和一个或多个源对象作为参数</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> dest, src, result</span><br><span class="line">dest = &#123;&#125;</span><br><span class="line">src = &#123;<span class="attr">id</span>: <span class="string">'src'</span>&#125;</span><br><span class="line">result = <span class="built_in">Object</span>.assign(dest,src)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(dest === result)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(dest !== src) <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(result)  <span class="comment">//&#123;id: 'src'&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(dest)  <span class="comment">//&#123;id : 'src'&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//多个源对象</span></span><br><span class="line">dest = &#123;&#125;</span><br><span class="line">result = <span class="built_in">Object</span>.assign(dest,&#123;<span class="attr">a</span>:<span class="string">'foo'</span>&#125;,&#123;<span class="attr">b</span>:<span class="string">'bar'</span>&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(result) <span class="comment">//&#123;a:'foo',b:'bar'&#125;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-1-4-相等判定-Object-is"><a href="#2-1-4-相等判定-Object-is" class="headerlink" title="2.1.4 相等判定 Object.is"></a>2.1.4 相等判定 Object.is</h4><ul>
<li>有些特殊情况<code>===</code>也无能为力，故可以采用Object.is  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="literal">NaN</span> === <span class="literal">NaN</span>)  <span class="comment">//false</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">isNaN</span>(<span class="literal">NaN</span>))  <span class="comment">//true</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//使用Object.is替换===统一写法</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(<span class="literal">NaN</span>,<span class="literal">NaN</span>))  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">#### 2.1.5 简写对象语法</span><br><span class="line">- 简写对象属性</span><br><span class="line">    <span class="string">``</span><span class="string">`js</span></span><br><span class="line"><span class="string">    let name = 'Matt'</span></span><br><span class="line"><span class="string">    let person = &#123;</span></span><br><span class="line"><span class="string">        name: name</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    //等价于上面</span></span><br><span class="line"><span class="string">    let person = &#123;</span></span><br><span class="line"><span class="string">        name</span></span><br><span class="line"><span class="string">    &#125;</span></span><br></pre></td></tr></table></figure></li>
<li>简写方法名  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'....'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//等价于上面</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    sayName(name) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(...)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//简写方法名可与计算属性相互兼容</span></span><br><span class="line"><span class="keyword">const</span> methodKey = <span class="string">'sayName'</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    [methodKey](name) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(...)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-6-对象解构"><a href="#2-1-6-对象解构" class="headerlink" title="2.1.6 对象解构"></a>2.1.6 对象解构</h4></li>
<li>使用  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    name:<span class="string">'Matt'</span>,</span><br><span class="line">    age:<span class="number">27</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//personName、personAge是重命名</span></span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">name</span>: personName, <span class="attr">age</span>: personAge&#125; = person</span><br><span class="line"><span class="built_in">console</span>.log(personName,personAge)<span class="comment">// Matt,27</span></span><br></pre></td></tr></table></figure></li>
<li>如果引用属性不存在则变量值就是undefined  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;name, job&#125; = person</span><br><span class="line"><span class="built_in">console</span>.log(job)  <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//可以在解构赋值的同时定义默认值</span></span><br><span class="line"><span class="keyword">let</span> &#123;name, job =<span class="string">'engineer'</span>&#125; = person</span><br><span class="line"><span class="built_in">console</span>.log(job)  <span class="comment">//engineer</span></span><br></pre></td></tr></table></figure></li>
<li><strong>函数声明在函数体内部使用局部变量</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    name: <span class="string">'Matt'</span>,</span><br><span class="line">    age: <span class="number">27</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printPerson</span>(<span class="params">foo, &#123;name:personName,age:personAge&#125;,bar</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(personName,personAge)</span><br><span class="line">&#125;</span><br><span class="line">printPerson(<span class="string">'1st'</span>,person,<span class="string">'2nd'</span>) </span><br><span class="line"><span class="comment">//['1st',&#123;name:'Matt',age:27&#125;, '2nd']</span></span><br><span class="line"><span class="comment">//'Matt',27</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-1-7-创建对象的几种模式"><a href="#2-1-7-创建对象的几种模式" class="headerlink" title="2.1.7 创建对象的几种模式"></a>2.1.7 创建对象的几种模式</h4><h5 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h5><ul>
<li>工厂模式特点:使用普通函数，函数内部创建Oject对象，最后返回该对象  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age, job</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    o.name = name</span><br><span class="line">    o.age = age</span><br><span class="line">    o.job = job</span><br><span class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person1 = createPerson(<span class="string">'Matt'</span>,<span class="number">29</span>,<span class="string">'engineer'</span>)</span><br><span class="line"><span class="keyword">let</span> person2 = createPerson(<span class="string">'Joe'</span>,<span class="number">27</span>,<span class="string">'doctor'</span>)</span><br></pre></td></tr></table></figure></li>
<li>缺点:没有解决对象标识问题，即新创建的对象是什么类型<h5 id="构造函数模式"><a href="#构造函数模式" class="headerlink" title="构造函数模式"></a>构造函数模式</h5></li>
<li>构造函数模式特点是首字母大写，需要实例化对象  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person(<span class="string">'Matt'</span>,<span class="number">29</span>,<span class="string">'engineer'</span>)</span><br><span class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person(<span class="string">'Joe'</span>,<span class="number">27</span>,<span class="string">'doctor'</span>)</span><br></pre></td></tr></table></figure></li>
<li><strong>实例化时，如果不传参，构造函数后面的括号可不加</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person</span><br></pre></td></tr></table></figure></li>
<li>缺点:每次定义函数，都会初始化一个对象</li>
</ul>
<h5 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h5><ul>
<li><p>原型模式优点是定义在它上面的属性和方法可以被对象实例共享</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.name = <span class="string">'Nichilas'</span></span><br><span class="line">Person.prototype.age = <span class="number">29</span></span><br><span class="line">Person.prototype.job = <span class="string">'Software Engineer'</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person(<span class="string">'Matt'</span>,<span class="number">29</span>,<span class="string">'engineer'</span>)</span><br><span class="line">person1.sayName() <span class="comment">//'Matt'</span></span><br><span class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person(<span class="string">'Joe'</span>,<span class="number">27</span>,<span class="string">'doctor'</span>)</span><br><span class="line">person2.sayName() <span class="comment">//'Joe'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person1.sayName == person2.sayName)  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">原理如下图：</span><br></pre></td></tr></table></figure>
<p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/4ed53fe8ae4d82abf4ecf8986d900a6f?method=download&shareKey=5cb460e9307ac7e712e42acd2465c96d" alt=""></p>
<p>  当调用person1.sayName时，js引擎先询问person1的实例有sayName属性吗？找不到的话接下来询问person1的原型有sayName属性吗？答案是有的。</p>
</li>
<li><p><strong>如果给对象实例添加一个属性，这个属性就会遮蔽原型对象上的同名属性，虽然不会修改它，但会屏蔽对它的访问</strong>，不过使用delete操作符可以完全删除实例上这个属性。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Person.prototype.name = <span class="string">"Nicholas"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line"></span><br><span class="line">person1.name =<span class="string">"Greg"</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.name) <span class="comment">//"Greg"  来自实例</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.name) <span class="comment">//"Nicholas"  //来自原型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> person1.name </span><br><span class="line"><span class="built_in">console</span>.log(person1.name)  <span class="comment">//"Nicholas"  来自原型</span></span><br></pre></td></tr></table></figure>
<p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/49bcb06b8cf10e041d65a80c1a1bd83b?method=download&shareKey=96017b3f87efe457f716f8b6231f1c7c" alt=""></p>
</li>
<li><p>判断某个属性是在实例上还是原型上</p>
<ul>
<li>hasOwnProperty() 属性存在于调用它的对象实例上返回true  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(person2.hasOwnProperty(<span class="string">"name"</span>)) <span class="comment">//false</span></span><br></pre></td></tr></table></figure></li>
<li>in 无论存在于原型还是实例对象，只要存在就返回true  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"name"</span> <span class="keyword">in</span> person2)  <span class="comment">//true</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>列举所有实例属性</p>
<ul>
<li>Object.getOWnPropertyNames  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> keys = <span class="built_in">Object</span>.getOwnPropertyNames(Person.prototype)</span><br><span class="line"><span class="built_in">console</span>.log(keys) <span class="comment">//"[constructor,name,age,job,sayName]""</span></span><br></pre></td></tr></table></figure></li>
<li>Object.getOwnPropertySymbols()同上，区别在于针对Symbol的key  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> k1 = <span class="built_in">Symbol</span>(<span class="string">"k1"</span>),</span><br><span class="line">k2 = <span class="built_in">Symbol</span>(<span class="string">"k2"</span>)</span><br><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">    [k1]: <span class="string">'k1'</span>,</span><br><span class="line">    [l2]: <span class="string">"k2"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertySymbols(o))<span class="comment">//[Symbol(k1),Symbol(k2)]</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>对象迭代Object.values()、Object.entries()，<strong>这两个方法执行对象的浅复制</strong></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> o =&#123;</span><br><span class="line">    foo: <span class="string">'bar'</span>,</span><br><span class="line">    baz: <span class="number">1</span>,</span><br><span class="line">    qux: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.values(o))</span><br><span class="line"><span class="comment">//["bar",1,&#123;&#125;]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.entries(o))<span class="comment">// [["foo","bar"],["baz",1],["qux",&#123;&#125;]]</span></span><br></pre></td></tr></table></figure>
<p>  <strong>注意符号Symbol会被忽略</strong></p>
<pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sym = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="keyword">const</span> o =&#123;</span><br><span class="line">    [sym] : <span class="string">'foo'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.values(o))  <span class="comment">//[]</span></span><br></pre></td></tr></table></figure></code></pre></li>
<li><p><strong>重写原型</strong></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> friend = <span class="keyword">new</span> Person()</span><br><span class="line"></span><br><span class="line"><span class="comment">//重写原型</span></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    name: <span class="string">'Nicholas'</span>,</span><br><span class="line">    age: <span class="number">29</span>,</span><br><span class="line">    job: <span class="string">"Software Engineer"</span>,</span><br><span class="line">    sayName() &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//重写构造函数之后再创建实例才会引用新的原型，但是friend是在重写前创建的，故仍然引用最初的原型</span></span><br><span class="line">friend.sayName()  <span class="comment">//错误</span></span><br></pre></td></tr></table></figure>
<p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/0c50c25f9a651ba40fe7c1e6c8c8ddc8?method=download&shareKey=42f7289aed6915997e5dfa1a3ec367fb" alt=""><br>  <strong>Person.prototype被设置为一个对象字面量，这种写法完全重写了默认的prototype对象，因此其constructor属性也指向Object，不再指向原来的构造函数，Person.prototype.constructor等于Object而不是Person</strong></p>
</li>
<li><p><strong>原型的动态性，任何时候对原型对象的修改也会在实例上反映出来</strong></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> friend = <span class="keyword">new</span> Person()</span><br><span class="line">Person.prototype.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hi'</span>)</span><br><span class="line">&#125;</span><br><span class="line">friend.sayHi()  <span class="comment">//'Hi'</span></span><br></pre></td></tr></table></figure></li>
<li><p>原型缺点:导致所有实例默认取得相同的属性值</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype =&#123;</span><br><span class="line">    friends:[<span class="string">"Shelby"</span>,<span class="string">"Court"</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line"></span><br><span class="line">person1.friends.push(<span class="string">"Van"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1.friends) <span class="comment">//["Shelby,Court,Van"]</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.friends) <span class="comment">//["Shelby,Court,Van"]</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.friends === person2.friens)  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-2-Array类型"><a href="#2-2-Array类型" class="headerlink" title="2.2  Array类型"></a>2.2  Array类型</h3><h4 id="2-2-1-Array-from-用于将类数组结构转换为数组实例"><a href="#2-2-1-Array-from-用于将类数组结构转换为数组实例" class="headerlink" title="2.2.1 Array.from 用于将类数组结构转换为数组实例"></a>2.2.1 Array.from 用于将类数组结构转换为数组实例</h4><ul>
<li><p>字符串会被拆分为单字符数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(<span class="string">"Matt"</span>))  <span class="comment">//["M","a","t","t"]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将集合或映射转换为一个新数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="number">1</span>,<span class="number">2</span>).set(<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>().add(<span class="number">1</span>).add(<span class="number">2</span>).add(<span class="number">3</span>).add(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(m)) <span class="comment">//[[1,2],[3,4]]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(s)) <span class="comment">//[1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对现有数组执行浅复制</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="keyword">const</span> a2 = <span class="built_in">Array</span>.from(a1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a1 === a2)  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>转换带有必要属性的自定义对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayLikeObject = &#123;  </span><br><span class="line">    <span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="number">3</span>: <span class="number">4</span>,</span><br><span class="line">    length: <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(arrayLikeOject)) <span class="comment">//[1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可接收第二个参数,第三个参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="keyword">const</span> a2 = <span class="built_in">Array</span>.from(a1, x =&gt; x**<span class="number">2</span>)  <span class="comment">//求x的2次方</span></span><br><span class="line"><span class="keyword">const</span> a3 = <span class="built_in">Array</span>.from(a1, <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x**<span class="keyword">this</span>.exponent</span><br><span class="line">&#125;,&#123;<span class="attr">exponent</span>: <span class="number">2</span>&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(a2) <span class="comment">//[1, 4, 9, 16]</span></span><br><span class="line"><span class="built_in">console</span>.log(a3) <span class="comment">//[1, 4, 9, 16]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-2-2-Array-of-将一组参数转为数组"><a href="#2-2-2-Array-of-将一组参数转为数组" class="headerlink" title="2.2.2 Array.of 将一组参数转为数组"></a>2.2.2 Array.of 将一组参数转为数组</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)) <span class="comment">//[1, 2, 3, 4]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.of(<span class="literal">undefined</span>))  <span class="comment">// [undefined]</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-数组空位"><a href="#2-2-3-数组空位" class="headerlink" title="2.2.3 数组空位"></a>2.2.3 数组空位</h4><ul>
<li><p>使用数组字面量初始化数组时，可以使用一串逗号创建空位，ES6新增的方法普遍将这些空位当作存在的元素undefined</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> options = [<span class="number">1</span>,,,,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> option <span class="keyword">of</span> options)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(option === <span class="literal">undefined</span>) </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//false</span></span><br><span class="line"><span class="comment">//true</span></span><br><span class="line"><span class="comment">//true</span></span><br><span class="line"><span class="comment">//true</span></span><br><span class="line"><span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//map会跳过空位置</span></span><br><span class="line"><span class="built_in">console</span>.log(options.map(<span class="function"><span class="params">()</span> =&gt;</span> <span class="number">6</span>))  <span class="comment">//[6, undefined, undefined, undefined, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//join视空位置为字符串</span></span><br><span class="line"><span class="built_in">console</span>.log(option.join(<span class="string">'-'</span>)  <span class="comment">//"1---5"</span></span><br></pre></td></tr></table></figure>

<p><strong>由于行为不一致性和存在性能隐患，实践中要避免使用数组空位，确实要使用，可以显式用undefined代替</strong></p>
</li>
</ul>
<h4 id="2-2-4-数组迭代器"><a href="#2-2-4-数组迭代器" class="headerlink" title="2.2.4 数组迭代器"></a>2.2.4 数组迭代器</h4><ul>
<li><p>keys()、values()、entries()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>, <span class="string">"qux"</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> aKeys = <span class="built_in">Array</span>.from(a.keys())  <span class="comment">//[0,1,2,3]</span></span><br><span class="line"><span class="keyword">const</span> aValues = <span class="built_in">Array</span>.from(a.values()) <span class="comment">//["foo","bar","baz","qux"]</span></span><br><span class="line"><span class="keyword">const</span> aEntries = <span class="built_in">Array</span>.from(a.entries()) <span class="comment">//[[0,"foo"],[1,"bar"],[2,"baz"],[3,"qux"]]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-2-5-复制copyWithin和填充fill"><a href="#2-2-5-复制copyWithin和填充fill" class="headerlink" title="2.2.5 复制copyWithin和填充fill"></a>2.2.5 复制copyWithin和填充fill</h4><ul>
<li>fill() 可以向一个已有的数组中插入全部或者部分相同的值<br><img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/307b1a852c695675b5e7e3165fe5daa5?method=download&shareKey=8e2b84d2b3328cddacbe75b80f05d55b" alt=""></li>
<li>copyWithin()会按照指定范围浅复制数组中的部分内容<br><img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/159752a17806d41670e9deaac5b35c3d?method=download&shareKey=5c212765ffcbeca950203eadeb5c7f90" alt=""><br><img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/4005ba52a6779b4fdbc41e9c0d4b70d7?method=download&shareKey=31d9699973064b159ed9decf3db78ede" alt=""></li>
</ul>
<h4 id="2-2-6-检测数组Array-isArray"><a href="#2-2-6-检测数组Array-isArray" class="headerlink" title="2.2.6 检测数组Array.isArray()"></a>2.2.6 检测数组Array.isArray()</h4><ul>
<li>确定一个值是不是数组  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">Array</span>.isArray(value))&#123;</span><br><span class="line">    <span class="comment">//操作数组</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-2-7-转换方法"><a href="#2-2-7-转换方法" class="headerlink" title="2.2.7 转换方法"></a>2.2.7 转换方法</h4><ul>
<li>toString()返回数组中每个值的等效字符串拼接而成的一个逗号分割的字符串  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">"red"</span>,<span class="string">"blue"</span>,<span class="string">"green"</span>]</span><br><span class="line"><span class="built_in">console</span>.log(colors.toString()) <span class="comment">//red,blue,green</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-2-8-栈方法"><a href="#2-2-8-栈方法" class="headerlink" title="2.2.8 栈方法"></a>2.2.8 栈方法</h4><ul>
<li>栈是一种后进先出的结构，也就是最近添加的项先被删除，push和pop只发生在栈顶  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> colors = [<span class="string">"red"</span>,<span class="string">"blue"</span>]</span><br><span class="line">colors.push(<span class="string">"brown"</span>)</span><br><span class="line">colors[<span class="number">3</span>] = <span class="string">"black"</span></span><br><span class="line">alert(colors.length) <span class="comment">//4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> item = colors.pop()  </span><br><span class="line">alter(item) <span class="comment">//black</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-2-9-队列方法"><a href="#2-2-9-队列方法" class="headerlink" title="2.2.9 队列方法"></a>2.2.9 队列方法</h4><ul>
<li><p>队列是姨先进先出的结构，队列在列表末尾添加数据，但是从列表开头获取数据</p>
</li>
<li><p>shift()会删除数组的第一项并返回它，把shift()和push()可以把数组当队列来使用</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">colors.push(<span class="string">"red"</span>,<span class="string">"green"</span>)</span><br><span class="line">colors.push(<span class="string">"black"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> item = colors.shift() <span class="comment">//"red"</span></span><br><span class="line">alert(colors.length) <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>unshift():在数组开头添加多个值，然后返回新的数组长度。通过使用unshift()和pop(),可以在相反方向上模拟队列，即在数组开头添加新数据，在数组末尾取得数据</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line"><span class="keyword">let</span> count = colors.unshift(<span class="string">"red"</span>,<span class="string">"green"</span>)</span><br><span class="line">alert(count)  <span class="comment">//2</span></span><br><span class="line">alert(count) <span class="comment">//["red","green"]</span></span><br><span class="line"></span><br><span class="line">count = colors.unshift(<span class="string">"black"</span>)</span><br><span class="line">alert(count) <span class="comment">//3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> item = colors.pop()</span><br><span class="line">alert(item)  <span class="comment">//green</span></span><br><span class="line">alert(colors.length)  <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-2-10-排序方法"><a href="#2-2-10-排序方法" class="headerlink" title="2.2.10 排序方法"></a>2.2.10 排序方法</h4><ul>
<li>reverse 反向排序</li>
<li>sort 排序  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> values =[<span class="number">0</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>]</span><br><span class="line">values.sort(compare)</span><br><span class="line">alert(values) <span class="comment">//[0,1,5,10,15]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compare</span>(<span class="params">value1,value2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value2 - value1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-2-11-操作方法"><a href="#2-2-11-操作方法" class="headerlink" title="2.2.11 操作方法"></a>2.2.11 操作方法</h4><ul>
<li><p>concat 连接字符串<br>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/b3a7db3ad1d9198866ca21a0fde1792b?method=download&shareKey=ddaf19c81d08c5aeedfb37141dd98850" alt=""></p>
</li>
<li><p>slice</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"blue"</span>, <span class="string">"yellow"</span>, <span class="string">"purple"</span>]</span><br><span class="line"><span class="keyword">let</span> colors2 = colors.slice(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">let</span> colors3 = colors.slice(<span class="number">1</span>,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(colors2) <span class="comment">//["green", "blue", "yellow", "purple"]</span></span><br><span class="line"><span class="built_in">console</span>.log(colors3) <span class="comment">// ["green", "blue", "yellow"]</span></span><br></pre></td></tr></table></figure>
<p>  slice参数有负值，那么数值长度加上这个负值的结果确定位置，在一个5个元素的数组上调用slice(-2,-1),就相当于slice(3,4)。如果结束位置小于开始位置，则返回空数组</p>
</li>
<li><p>splice 删除、插入和替换数组元素，始终返回一个数组，它包含从数组中被删除的元素(如果没有删除元素，则返回空数组)</p>
<ul>
<li><p>删除 传两个参数，删除第一个元素的位置和要删除元素的数量。比如splice(0,2) 会删除前两个元素</p>
</li>
<li><p>插入 传3个参数，开始位置、要删除的元素数量和要插入的元素。三个参数之后传第四个第五个乃至任意多个要插入的元素。比如splice(2,0,”red”,”green”)会从数组位置2开始插入字符串”red” 和”green”</p>
</li>
<li><p>替换 删除元素的同时可以在指定位置插入新元素。比如splice(2,0,”red”,”green”) 会从数组位置2开始插入字符串”red”和”green”</p>
<p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/1b7954edde5f27bd8ecf63254c92859d?method=download&shareKey=7390c70aaa6f01d572391d4f6a7d52b6" alt=""></p>
</li>
</ul>
</li>
</ul>
<h4 id="2-2-12-搜索和位置方法"><a href="#2-2-12-搜索和位置方法" class="headerlink" title="2.2.12 搜索和位置方法"></a>2.2.12 搜索和位置方法</h4><h5 id="indexOf、lastIndexOf和includes"><a href="#indexOf、lastIndexOf和includes" class="headerlink" title="indexOf、lastIndexOf和includes"></a>indexOf、lastIndexOf和includes</h5><ul>
<li>indexOf和lastIndexOf 接收两个参数，第一个是查找的元素，第二个是开始查找的位置，区别是一个从开头查找一个从末尾查找。返回要查找的元素在数组中的位置，没找到则返回-1。</li>
<li>includes 返回布尔值<br>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/b7c1b7c1942aa6030e2f82a05c7ef22a?method=download&shareKey=e6ec75b25cde8b401da0b4572e3f6e92" alt=""></li>
</ul>
<h5 id="find和findIndex"><a href="#find和findIndex" class="headerlink" title="find和findIndex"></a>find和findIndex</h5><ul>
<li>find 返回第一个匹配的元素，findIndex返回第一个匹配元素的索引。第二个可选参数用于指定断言函数内部this的值  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> people = [</span><br><span class="line">&#123;</span><br><span class="line">    name: <span class="string">"Matt"</span>,</span><br><span class="line">    age:<span class="number">27</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    name:<span class="string">"Joe"</span>,</span><br><span class="line">    age:<span class="number">29</span></span><br><span class="line">&#125;]</span><br><span class="line">alert(people.find(<span class="function">(<span class="params">element,index,array</span>) =&gt;</span> element.age &lt; <span class="number">28</span>))  <span class="comment">//&#123;name:"Matt",age:27&#125;</span></span><br><span class="line"></span><br><span class="line">alert(people.findIndex(<span class="function">(<span class="params">element,index,array</span>)=&gt;</span> element.age &lt; <span class="number">28</span>))  <span class="comment">//0</span></span><br></pre></td></tr></table></figure>
  找到匹配后，两个方法都不会再继续搜索</li>
</ul>
<h4 id="2-2-13-迭代方法"><a href="#2-2-13-迭代方法" class="headerlink" title="2.2.13 迭代方法"></a>2.2.13 迭代方法</h4><ul>
<li>every 传入的函数必须对每一项都返回true，它才会返回true</li>
<li>some 只要有一项让传入的函数返回true，它就会返回true</li>
<li>filter</li>
<li>map</li>
<li>forEach</li>
</ul>
<h4 id="2-2-14-归并方法"><a href="#2-2-14-归并方法" class="headerlink" title="2.2.14 归并方法"></a>2.2.14 归并方法</h4><ul>
<li>reduce和reduceRight区别是一个从数组的第一项开始遍历，一个从末尾开始遍历</li>
<li>接收两个参数，第一每一项都会运行的归并函数，第二可选的归并起点的初始值</li>
<li>归并函数接收4个函数：上一个归并值、当前项、当前项索引和数组本身。这个函数返回的任何值都会作为下一次调用同一个函数的第一个参数。如果没有给初始值(即第二个参数)，则第一次迭代将从数组的第二项开始。  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">let</span> sum = values.reduce(<span class="function">(<span class="params">prev,cur,index,array</span>) =&gt;</span> prev + cur)</span><br><span class="line">alert(sum) <span class="comment">//15</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-3-Date类型"><a href="#2-3-Date类型" class="headerlink" title="2.3 Date类型"></a>2.3 Date类型</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Date</span>.now()<span class="comment">//获取当前时间毫秒数</span></span><br><span class="line"><span class="keyword">var</span> dt=<span class="keyword">new</span> <span class="built_in">Date</span>() </span><br><span class="line">dt.getTime() <span class="comment">//获取毫秒数</span></span><br><span class="line">dt.getFullYear()<span class="comment">//年</span></span><br><span class="line">dt.getMonth()<span class="comment">//月  （0-11）  注意要加1</span></span><br><span class="line">dt.getDate() <span class="comment">//日</span></span><br><span class="line">dt.getHours()  <span class="comment">//时</span></span><br><span class="line">dt.getMinutes()  <span class="comment">//分</span></span><br><span class="line">dt.getSeconds() <span class="comment">//秒</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//- 例子：获取2017-06-10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dt= <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"><span class="keyword">var</span> formatDate = formatDate(dt)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatDate</span>(<span class="params">dt</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!dt)&#123;</span><br><span class="line">        dt =<span class="keyword">new</span> <span class="built_in">Date</span>()		</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> year = dt.getFullYear()</span><br><span class="line">    <span class="keyword">var</span> month =dt.getMonth()+<span class="number">1</span></span><br><span class="line">    <span class="keyword">var</span> date =dt.getDate()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(month &lt; <span class="number">10</span> )&#123;</span><br><span class="line">        month = <span class="string">'0'</span>+ month</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(date &lt; <span class="number">10</span>)&#123;</span><br><span class="line">        date =<span class="string">'0'</span> + date</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> year +<span class="string">'-'</span>+month +<span class="string">"-"</span>+date	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-Set类型"><a href="#2-4-Set类型" class="headerlink" title="2.4 Set类型"></a>2.4 Set类型</h3><h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><ul>
<li>Set很多方面像是加强的Map，很多API和行为同Map是共有的</li>
</ul>
<h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><ul>
<li>使用new创建空集合  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br></pre></td></tr></table></figure></li>
<li>创建并初始化  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m1 = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">"val1"</span>,<span class="string">"val2"</span>,<span class="string">"val3"</span>])</span><br><span class="line">alert(m1.size)   <span class="comment">//3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用自定义迭代器初始化集合</span></span><br><span class="line"><span class="keyword">const</span> m2 = <span class="keyword">new</span> <span class="built_in">Set</span>(&#123;</span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]:<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"val1"</span>;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"val2"</span>;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"val3"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">alert(m2.size) <span class="comment">//3</span></span><br></pre></td></tr></table></figure></li>
<li>使用add增加值，has查询，size获取元素数量，delete和clear删除元素  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br><span class="line"><span class="comment">//多操作串联使用</span></span><br><span class="line">s.add(<span class="string">"Matt"</span>).add(<span class="string">"Jeo"</span>)</span><br><span class="line">alert(s.size)  <span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">s.has(<span class="string">"Matt"</span>)  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">s.delete(<span class="string">"Matt"</span>)</span><br><span class="line">alert(s.size) <span class="comment">//1</span></span><br><span class="line"></span><br><span class="line">s.clear()</span><br><span class="line">alert(s.size) <span class="comment">//0</span></span><br></pre></td></tr></table></figure></li>
<li>与Map类似，Set可以包含任何js数据类型作为值。注意的是作为值的对象属性被改变也不会收到影响  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br><span class="line"><span class="keyword">const</span> objVal = &#123;&#125;</span><br><span class="line">s.add(objVal)</span><br><span class="line"></span><br><span class="line">objVal.bar = <span class="string">"bar"</span></span><br><span class="line">alert(s.has(objVal))  <span class="comment">//true</span></span><br></pre></td></tr></table></figure></li>
<li>delete返回一个布尔值，表示集合中是否存在要删除的值  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br><span class="line">s.add(<span class="string">'foo'</span>)</span><br><span class="line"></span><br><span class="line">alert(s.delete(<span class="string">'foo'</span>)  <span class="comment">//true</span></span><br><span class="line">alert(s.delete(<span class="string">'foo'</span>)  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="顺序与迭代"><a href="#顺序与迭代" class="headerlink" title="顺序与迭代"></a>顺序与迭代</h4><ul>
<li>Set会维护值插入时的顺序，支持按顺序迭代</li>
<li>可使用values、keys等方法进行迭代，同Map一样  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常用把Set集合转换为数组</span></span><br><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">"val1"</span>,<span class="string">"val2"</span>,<span class="string">"val3"</span>])</span><br><span class="line"><span class="built_in">console</span>.log([...s]) <span class="comment">//["val1","val2","val3"]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h4><ul>
<li>WeakSet是Set的兄弟，其API也是Set的子集。</li>
<li>基本  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>()</span><br></pre></td></tr></table></figure></li>
<li>特点同WeakMap基本一致，区别在于API不同</li>
</ul>
<h3 id="2-5-Map类型"><a href="#2-5-Map类型" class="headerlink" title="2.5 Map类型"></a>2.5 Map类型</h3><h4 id="2-5-1-基本"><a href="#2-5-1-基本" class="headerlink" title="2.5.1 基本"></a>2.5.1 基本</h4><ul>
<li>使用new关键字和Map构造函数可以创建一个空映射  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br></pre></td></tr></table></figure></li>
<li>创建同时初始化实例  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用嵌套数组初始化映射</span></span><br><span class="line"><span class="keyword">const</span> m1 = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">"key1"</span>,<span class="string">"val1"</span>],</span><br><span class="line">    [<span class="string">"key2"</span>,<span class="string">"val2"</span>],</span><br><span class="line">    [<span class="string">"key3"</span>,<span class="string">"val3"</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">alert(m1.size) <span class="comment">//3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用自定义迭代器初始化映射</span></span><br><span class="line"><span class="keyword">const</span> m2 = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]: <span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">yield</span> [<span class="string">"key1"</span>,<span class="string">"val1"</span>],</span><br><span class="line">        <span class="keyword">yield</span> [<span class="string">"key2"</span>,<span class="string">"val2"</span>],</span><br><span class="line">        <span class="keyword">yield</span> [<span class="string">"key3"</span>,<span class="string">"val3"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">alert(m2.size)  <span class="comment">//3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//映射期待的键值对，无论是否提供</span></span><br><span class="line"><span class="keyword">const</span> m3 = <span class="keyword">new</span> <span class="built_in">Map</span>([[]])</span><br><span class="line">alert(m3.has(<span class="literal">undefined</span>)) <span class="comment">//true</span></span><br><span class="line">alert(m3.get(<span class="literal">undefined</span>) <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure></li>
<li>set方法添加键值对，get和has查询，size属性获取键值对数量，delete和clear删除值  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line"><span class="comment">//多个操作串联使用</span></span><br><span class="line">m.set(<span class="string">"firstName"</span>,<span class="string">"Matt"</span>)</span><br><span class="line">    .set(<span class="string">"lastName"</span>,<span class="string">"Joe"</span>)</span><br><span class="line">alert(m.has(<span class="string">"firstName"</span>)) <span class="comment">//true</span></span><br><span class="line">alert(m.get(<span class="string">"firstName"</span>)) <span class="comment">//"Matt"</span></span><br><span class="line">alert(m.size)  <span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">m.delete(<span class="string">"firstName"</span>)</span><br><span class="line">alert(m.size)  <span class="comment">//1</span></span><br><span class="line"></span><br><span class="line">m.clear()</span><br><span class="line">alert(m.size) <span class="comment">//0</span></span><br></pre></td></tr></table></figure></li>
<li>与Object不同的是，Map可以使用任何js数据类型作为键</li>
</ul>
<h4 id="2-5-2-迭代"><a href="#2-5-2-迭代" class="headerlink" title="2.5.2 迭代"></a>2.5.2 迭代</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">"key1"</span>,<span class="string">"val1"</span>],</span><br><span class="line">    [<span class="string">"key2"</span>,<span class="string">"val2"</span>],</span><br><span class="line">    [<span class="string">"key3"</span>,<span class="string">"val3"</span>]</span><br><span class="line">])</span><br><span class="line">alert(m.entries === m[<span class="built_in">Symbol</span>.iterator])  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> pair <span class="keyword">of</span> m.entries())&#123;</span><br><span class="line">    alert(pair)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//["key1","val1"]</span></span><br><span class="line"><span class="comment">//["key2","val2"]</span></span><br><span class="line"><span class="comment">//["key3","val3"]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log([...m])  <span class="comment">//[["key1","val1"],["key2","val2"],["key3","val3"]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//可以使用forEach</span></span><br><span class="line">m.forEach(<span class="function">(<span class="params">val,key</span>) =&gt;</span> alert(<span class="string">`<span class="subst">$&#123;key&#125;</span> -&gt; <span class="subst">$&#123;val&#125;</span>`</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//keys和values</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">of</span> m.keys)&#123;</span><br><span class="line">    alert(key)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//"key1"</span></span><br><span class="line"><span class="comment">//"key2"</span></span><br><span class="line"><span class="comment">//"key3"</span></span><br></pre></td></tr></table></figure>

<h4 id="2-5-3-Object与Map选择"><a href="#2-5-3-Object与Map选择" class="headerlink" title="2.5.3 Object与Map选择"></a>2.5.3 Object与Map选择</h4><ul>
<li>给定固定内存大小，Map大约比Object多存储50%的键值对</li>
<li>插入、删除数据多，Map性能更优</li>
<li>查找数据，包含少量键值对时，Oject有时候速度更快</li>
</ul>
<h4 id="2-5-4-WeakMap"><a href="#2-5-4-WeakMap" class="headerlink" title="2.5.4 WeakMap"></a>2.5.4 WeakMap</h4><h5 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h5><ul>
<li>WeakMap是Map的兄弟类型，其API也是Map的子集，”weak”表示弱映射的键，这些键不属于正式的引用，会被垃圾回收。但是如果键值对存在于映射中，并被当作对值的引用，就不会被当作垃圾回收  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//set方法初始化一个新对象作为一个字符串的键，但是这个对象没有其他引用，当执行完代码后，这个对象键就会被垃圾回收，因为值也没有被引用，值本身也会被垃圾回收。</span></span><br><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span><br><span class="line">wm.set(&#123;&#125;,<span class="string">"val"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//container对象维护着一个对弱映射键的引用，因此这个对象键不会成为垃圾回收的目标，但是如果调用了removeReference，就会摧毁对象的最后一个引用，垃圾回收程序就会把这个键值对清理掉。</span></span><br></pre></td></tr></table></figure>
<h5 id="API-1"><a href="#API-1" class="headerlink" title="API"></a>API</h5></li>
<li>使用  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span><br></pre></td></tr></table></figure></li>
<li><strong>弱映射中的键只能是Oject或者继承自Object的类型，尝试使用非对象设置键会抛出TypeError，值的类型无限制</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> key1 = &#123;<span class="attr">id</span>: <span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">const</span> wm2 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([</span><br><span class="line">    [key1,<span class="string">"val1"</span>],</span><br><span class="line">    [<span class="string">"BADKEY"</span>,<span class="string">"val2"</span>]</span><br><span class="line">])</span><br><span class="line"><span class="comment">//TypeError</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//原始值可以先包装成对象再用作键</span></span><br><span class="line"><span class="keyword">const</span> stringKey = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"key1"</span>)</span><br><span class="line"><span class="keyword">const</span> wm3 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([</span><br><span class="line">    stringKey,<span class="string">"val1"</span></span><br><span class="line">])</span><br><span class="line">alert(wm3.get(stringKey))</span><br></pre></td></tr></table></figure></li>
<li>特点为不可迭代键，因为WeakMap中的键值对任何时候都可以能被销毁。</li>
</ul>
<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><ul>
<li>DOM节点元数据，因为WeakMap实例不会妨碍垃圾回收，所以非常适合保存关联元数据。  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line"><span class="keyword">const</span> loginButton = <span class="built_in">document</span>.querySelector(<span class="string">'#login'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//给这个节点关联一些元数据</span></span><br><span class="line">m.set(loginButton,&#123;<span class="attr">disable</span>: <span class="literal">true</span>&#125;)</span><br></pre></td></tr></table></figure>
  假设上面的代码执行后，原来的登陆按钮从DOM树中被删掉了，但由于映射中还保存着按钮的引用，所以对应的DOM节点仍然会逗留在内存中，除非明确将其从映射中删除或者等到映射本身被销毁。<strong>如果这里使用弱映射,当节点从DOM树中被删除后，垃圾回收程序就会立即释放其内存</strong>(假设没有其他地方引用这个对象)  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span><br><span class="line"><span class="keyword">const</span> loginButton = <span class="built_in">document</span>.querySelector(<span class="string">'#login'</span>)</span><br><span class="line"></span><br><span class="line">wm.set(loginButton,&#123;<span class="attr">disable</span>: <span class="literal">true</span>&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="第3章-Javascript-类、对象、面向对象编程"><a href="#第3章-Javascript-类、对象、面向对象编程" class="headerlink" title="第3章  Javascript-类、对象、面向对象编程"></a>第3章  Javascript-类、对象、面向对象编程</h2><h3 id="3-1-构造函数"><a href="#3-1-构造函数" class="headerlink" title="3.1 构造函数"></a>3.1 构造函数</h3><ul>
<li><p>特点：名称大写开头</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name</span><br><span class="line">    <span class="keyword">this</span>.age=age</span><br><span class="line">    <span class="keyword">this</span>.class =<span class="string">'class-1'</span></span><br><span class="line">    <span class="comment">//return this //默认有这一行</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f= <span class="keyword">new</span> Foo(<span class="string">'zhangsan'</span>,<span class="number">20</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>扩展</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;&#125;  <span class="comment">//是 new Object()的语法糖</span></span><br><span class="line"><span class="keyword">var</span> a = []  <span class="comment">//是 new Array()的语法糖</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params">...</span>)  //是 <span class="title">var</span> <span class="title">Foo</span> = <span class="title">new</span> <span class="title">Function</span>(<span class="params"></span>)的语法糖</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">//可读性，推荐前面的写法</span></span><br><span class="line"><span class="function">//<span class="title">instanof</span>判断一个函数是否是一个变量的构造函数</span></span><br><span class="line">var arr = [];</span><br><span class="line">arr <span class="keyword">instanceof</span> <span class="built_in">Array</span>; <span class="comment">//true</span></span><br><span class="line"><span class="keyword">typeof</span> arr <span class="comment">//object  typeof是无法判断是否是数组</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="3-2-原型链"><a href="#3-2-原型链" class="headerlink" title="3.2 原型链"></a>3.2 原型链</h3><ul>
<li><p>创建对象的几种方法</p>
<ul>
<li><p>示例</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var o1 &#x3D; &#123; name: &#39;o1&#39;&#125;</span><br><span class="line">var o2 &#x3D; new Object(&#123;name : &#39;o2&#39;&#125;)</span><br><span class="line"></span><br><span class="line">var M &#x3D;function(name)&#123;this.name &#x3D; name&#125;;</span><br><span class="line">var o3 &#x3D; new M(&#39;o3&#39;)</span><br><span class="line"></span><br><span class="line">var p &#x3D; &#123;name : &#39;o4&#39;&#125;</span><br><span class="line">var o4 &#x3D; Object.create(p)</span><br></pre></td></tr></table></figure>
<p>  输出</p>
<p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/0409D540C0D04948A7E0394E0A698B21?method=download&shareKey=e9b3adac6454ab5100ec8a524e646359" alt=""></p>
</li>
<li><p>原型链图</p>
<p><img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/88F1644997004750AD0A31CDBE007484?method=download&shareKey=8619ebc7b88e14fc0eea48dcc0f97adb" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M.prototype.constructor&#x3D;&#x3D;&#x3D;M  &#x2F;&#x2F;true</span><br><span class="line">o3.__proto__ &#x3D;&#x3D;&#x3D; M.prototype  &#x2F;&#x2F;true</span><br><span class="line">M.__proto__ &#x3D;&#x3D;&#x3D; Function.prototype</span><br><span class="line">o3.__proto__.constructor &#x3D;&#x3D;&#x3D; M  &#x2F;&#x2F;证明o3是M的实例</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>new 原理</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Object.create 原理如下</span><br><span class="line">function object(o)&#123;</span><br><span class="line">    function F()&#123;&#125;</span><br><span class="line">    F.prototype &#x3D; o</span><br><span class="line">    return new F()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var new2 &#x3D; function (func)&#123;</span><br><span class="line">    var o &#x3D; Object.create(func.prototype)  &#x2F;&#x2F;第一步 创建空对象，空对象关联构造函数的原型对象</span><br><span class="line">    var k &#x3D; func.call(o);  &#x2F;&#x2F;第二步 执行构造函数</span><br><span class="line">    if(typeof k &#x3D;&#x3D;&#x3D; &quot;object&quot;)&#123;</span><br><span class="line">        return k</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return o </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">funtion M()&#123;</span><br><span class="line">	this.name &#x3D; &#39;Joe&#39;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;验证  效果同 new M()</span><br><span class="line">var o6 &#x3D; new2(M)</span><br><span class="line">o6 instanceof M &#x2F;&#x2F;true</span><br><span class="line">o6 instanceof Object &#x2F;&#x2F;true</span><br><span class="line">o6.__proto__.constrctor &#x3D;&#x3D;&#x3D; M &#x2F;&#x2F;true</span><br><span class="line">M.prototype.walk &#x3D; function()&#123;</span><br><span class="line">    console.log(&quot;walk&quot;)</span><br><span class="line">&#125;</span><br><span class="line">o6.walk() &#x2F;&#x2F; walk</span><br></pre></td></tr></table></figure></li>
<li><p>所有引用类型都有一个隐式类型<code>__proto__</code>属性，属性值是个普通的对象</p>
</li>
<li><p>所有函数，都有一个显示原型 prototype属性</p>
</li>
<li><p><strong>所有引用类型，<code>__proto__</code>属性值指向它的构造函数的’prototype’属性</strong></p>
</li>
<li><p><strong>当试图得到一个对象的某个属性时，如果这个对象本身没有这个属性，它会去它的<code>__proto__</code>属性(即它的构造函数的prototype)里去找</strong></p>
<ul>
<li><p>示例</p>
<pre><code>var obj={};obj.a=100;
var arr =[];obj.a=100;
function fn(){}
fn.a=100;

console.log(obj.__proto__);
console.log(arr.__proto__);
console.log(fn.__proto__);

console.log(fn.prototype)

console.log(obj.__proto__ === Object.prototype)

function Foo(name,age){
    this.name=name;
}
Foo.prototype.alertname=function(){
    alert(this.name)
}
var f =new Foo(&apos;zhangsan&apos;)
f.printName =function(){
    console.log(this.name)
}
f.printName();
f.alertName();//印证最后一个规则
f.toSting();//要去f.__proto__.proto__查找，解析看下图

for(var item in f){
    //高版本的浏览器里的for in 已经屏蔽了来自原型的属性
    //但是为了代码的健壮性，还是建议加上

    if(f.hasOwnProperty(item)){ 
        console.log(item) //循环对象自身的属性，即上面例子的name和printName
    }
}</code></pre><p>  <img src= "/img/loading.gif" data-src="https://i.imgur.com/9qYHzH2.png" alt=""></p>
<p>解析：f是引用类型，引用类型都有一个隐示原型<code>__proto__</code>即是它的构造函数Foo的显示原型prototype,构造函数都有一个显示原型，故找不到就会继续往下找，Foo.prototype是一个对象，它也有隐示原型<code>__proto__</code>,它的构造函数是Object，故f.toString()要去<code>f.__proto__.__proto__</code>里去找</p>
</li>
</ul>
</li>
<li><p>练习</p>
<pre><code>function Person(name) {
    this.name = name
}
let p = new Person(&apos;Tom&apos;);</code></pre><ul>
<li><p><code>p.__proto__</code>等于什么？</p>
</li>
<li><p><code>Person.__proto</code>__等于什么？</p>
</li>
<li><p>解析：<strong>实例的<code>__proto__</code>属性（原型）等于其构造函数的prototype属性。实例p的构造函数为Person，而Person的构造函数为Function</strong>，结果就一目了然了。问一答案: Person.prototype，问二答案: Function.prototype</p>
</li>
</ul>
</li>
<li><p>封装一个Dom 查询的例子</p>
<pre><code>function  Elem(id){
    this.elem =document.getElementById(id)
}

Elem.prototype.html=function(val){
    var elem=this.elem;
    if(val){
        elem.innerHTML=val
        return this//链式操作
    }else{
        return elem.innerHTML
    }
}

Elem.prototype.on = function(type,fn){
    var elem=this.elem
    elem.addEventListener(type,fn)
}

//使用
var div1=new Elem(&apos;test&apos;)
//console.log(div1.html())

div1.html(&apos;&lt;p&gt;hello&lt;/p&gt;&apos;)
div1.on(&apos;click&apos;,function(){
        alert(&apos;element&apos;)
})</code></pre></li>
</ul>
<h3 id="3-3-instanceof-原型规则"><a href="#3-3-instanceof-原型规则" class="headerlink" title="3.3 instanceof 原型规则"></a>3.3 instanceof 原型规则</h3><ul>
<li><p>可以判断引用类型是哪个构造函数的方法</p>
<pre><code>f instanceof Foo </code></pre><p>  判断逻辑：f会往<code>__proto__</code>一层层往上找，指向的是Foo的prototype就返回true</p>
<pre><code>f instanceof Object</code></pre><p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/01781C37E4F545B5A3C163D5BCFEB7F9?method=download&shareKey=81491c07455df13879fe6df4e72e7da7" alt="">    </p>
</li>
<li><p>判断类型</p>
<pre><code>var arr=[]
console.log(arr instanceof Array)// true

typeof(arr) // object</code></pre><p>  <strong>注意：typeof不能判断数组</strong></p>
</li>
<li><p>typeof区别</p>
<ul>
<li>typeof 运算符时采用引用类型存储值会出现一个问题，无论引用的是什么类型的对象，它都返回 “object”</li>
</ul>
</li>
</ul>
<ul>
<li><p>通过代码阐述的内部机制，假设现在有 <code>x instanceof y</code> 一条语句，则其内部实际做了如下判断：</p>
<pre><code>while(x.__proto__!==null) {
    if(x.__proto__===y.prototype) {
        return true;
        break;
    }
    x.__proto__ = x.__proto__.proto__;
}
if(x.__proto__== null) {
    return false;
}</code></pre><p>x会一直沿着隐式原型链<code>__proto__</code>向上查找直到<code>x.__proto__.__proto__......===y.prototype</code>为止，如果找到则返回true，也就是x为y的一个实例。否则返回false，x不是y的实例。</p>
<ul>
<li><p>示例一</p>
<pre><code>function F() {}
function O() {}

O.prototype = new F();
var obj = new O();

console.log(obj instanceof O); // true
console.log(obj instanceof F); // true
console.log(obj.__proto__ === O.prototype); // true
console.log(obj.__proto__.__proto__ === F.prototype); // true</code></pre><p>  根据new 的内部机制改写上面代码</p>
<pre><code>function F() {}
function O() {}

var obj = (function () {
    var obj1 = {};
    obj1.__proto__ = F.prototype; // new F();
    O.prototype = obj1; // O.prototype = new F();
    obj.__proto__ = O.prototype; // new O();
    obj.__proto__ = obj1;
    return obj;
})</code></pre></li>
<li><p>示例二</p>
<p>  调整下代码顺序</p>
<pre><code>function F() {}
function O() {}

var obj = new O();
O.prototype = new F();

console.log(obj instanceof O); // false
console.log(obj instanceof F); // false
console.log(obj.__proto__ === O.prototype); // false
console.log(obj.__proto__.__proto__ === F.prototype); // false</code></pre></li>
</ul>
</li>
</ul>
<ul>
<li><p>练习</p>
<p>  如果Student inherit from Person（Student类继承Person，需是基于原型的继承），let s = new Student(‘Lily’)，那么s instanceof Person返回什么？</p>
<pre><code>function Person (name) {
this.name = name;
}

function Student () {

}

Student.prototype = Person.prototype;
Student.prototype.constructor = Student;

let s = new Student(&apos;Tom&apos;);
console.log(s instanceof Person); // 返回 true</code></pre><p>  <code>需要注意的是，==如果表达式 obj instanceof Foo 返回true，则并不意味着该表达式会永远返回ture，因为Foo.prototype属性的值有可能会改变，改变之后的值很有可能不存在于obj的原型链上，这时原表达式的值就会成为false。==另外一种情况下，原表达式的值也会改变，就是改变对象obj的原型链的情况，虽然在目前的ES规范中，我们只能读取对象的原型而不能改变它，但借助于非标准的__proto__魔法属性，是可以实现的。比如执行obj.__proto__ = {}之后，obj instanceof Foo就会返回false了。</code></p>
</li>
</ul>
<p>[toc]</p>
<h3 id="3-4-继承"><a href="#3-4-继承" class="headerlink" title="3.4 继承"></a>3.4 继承</h3><h4 id="3-4-1-原型链继承"><a href="#3-4-1-原型链继承" class="headerlink" title="3.4.1 原型链继承"></a>3.4.1 原型链继承</h4><ul>
<li>原型链基本思想就是通过原型继承多个引用类型的属性和方法。实现原型链代码模式:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.property = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.property</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subproperty = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承SuperType</span></span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line"></span><br><span class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.subproperty</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.getSuperValue()) <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
  SubType通过创建SuperType的实例并将其赋值给自己的原型SubType。prototype实现了对SuperType的继承<pre><code>![](https://note.youdao.com/yws/api/personal/file/7428abbc8445d51b12c3cab548fca20d?method=download&amp;shareKey=9a24eb888e3717b58c60a1ebcb4e3c74)</code></pre></li>
</ul>
<pre><code>**由于SubType.prototype的constructor属性被重写为指向SuperType，所以instance.constructor也指向SuperType**

调用instance.getSuperValue()经过了3步:instance.SubType.prototype和SuperType.prototype,最后一步才找到这个方法，对属性和方法的搜索会一直持续到原型链的末端</code></pre><ul>
<li><p>默认原型:任何函数的默认原型都是一个Object的实例，这意味着这个实例有一个内部指针指向Object.prototype。这就是为什么自定义类型能够继承toString()、valueOf()在内的所有默认方法的原因<br>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/02cd80f21a1a37f5e6ffadc6a280ff48?method=download&shareKey=99ffeac2a5ec167178e4b7f9d2e1beb5" alt=""></p>
<p>  在调用instance.toString()时，实际上调用的是保存在Object.prototype上的方法</p>
</li>
<li><p>判断实例是否在某原型上</p>
<ul>
<li>instanceof  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> <span class="built_in">Object</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> SuperType)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> SubType) <span class="comment">//true</span></span><br></pre></td></tr></table></figure></li>
<li>isPrototypeOf()  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.isPrototypeOf(instance))  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(SuperType.prototype.isPrototypeOf(instance))  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(SubType.prototype.isPrototypeOf(instance))  <span class="comment">//true</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>重写原型链:以对象字面量方式创建原型方法会破环之前的原型链</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.property = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.property</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">functionSubType()&#123;</span><br><span class="line">    <span class="keyword">this</span>.subproperty = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承SuperType</span></span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line"><span class="comment">//通过对象字面量添加新方法，这会导致上一行无效</span></span><br><span class="line">SubType.prototype = &#123;</span><br><span class="line">    getSubValue()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.subproperty</span><br><span class="line">    &#125;</span><br><span class="line">    someOtherMethod()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.getSuperValue())  <span class="comment">//Error</span></span><br></pre></td></tr></table></figure>
<p>  <strong>子类的原型被一个字面量覆盖了，覆盖后的原型是一个Object实例，而不再是SuperType实例，因此SubType和SuperType之间也没有关系了了</strong></p>
</li>
</ul>
<h4 id="3-4-2-盗用构造函数"><a href="#3-4-2-盗用构造函数" class="headerlink" title="3.4.2 盗用构造函数"></a>3.4.2 盗用构造函数</h4><ul>
<li>解决原型包含引用值导致的继承问题，使用call()和apply()方法以新创建的对象为上下文执行构造函数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">"red"</span>,<span class="string">"blue"</span>,<span class="string">"green"</span>]</span><br><span class="line">&#125;</span><br><span class="line">functin SubType()&#123;</span><br><span class="line">    <span class="comment">//SuperType</span></span><br><span class="line">    SuperType.call(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance1 = <span class="keyword">new</span> SubType()</span><br><span class="line">instance1.colors.push(<span class="string">"black"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance1.colors) <span class="comment">//["red","blue","green","black"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance2 = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance2.colors)<span class="comment">//["red","blue","green"]</span></span><br></pre></td></tr></table></figure>
  <strong>使用call()(或apply())方法，相当于新的SubType对象上运行了SuperType()函数中所有的初始化代码</strong></li>
<li>传递参数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    SuperType.call(<span class="keyword">this</span>,<span class="string">'Nicholas'</span>)</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">29</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.name)  <span class="comment">//"Nicholas"</span></span><br><span class="line"><span class="built_in">console</span>.log(instance.age)   <span class="comment">//29</span></span><br></pre></td></tr></table></figure></li>
<li>缺点是函数不能重用</li>
</ul>
<h4 id="3-4-3-组合继承"><a href="#3-4-3-组合继承" class="headerlink" title="3.4.3 组合继承"></a>3.4.3 组合继承</h4><ul>
<li>综合了上面原型链和盗用函数，将两者优点集中起来。<strong>基本思路是使用原型链继承原型上的属性和方法，而通过盗用构造函数继承实例属性。</strong>这样既可以把方法定义在原型上以实现重用，又可以让每个实例都有自己的属性。  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">"red"</span>,<span class="string">"blue"</span>,<span class="string">"green"</span>]</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//继承属性</span></span><br><span class="line">    SuperType.call(<span class="keyword">this</span>,name)</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承方法</span></span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance1 = <span class="keyword">new</span> SubType(<span class="string">'Nicholas'</span>, <span class="number">29</span>)</span><br><span class="line">instance1.colors.push(<span class="string">'black'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance1.colors) <span class="comment">//["red","blue","green","black"]</span></span><br><span class="line">instance1.sayName() <span class="comment">//"Nicholas"</span></span><br><span class="line"><span class="built_in">console</span>.log(instance1.sayAge()) <span class="comment">//29</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance2 = <span class="keyword">new</span> SubType(<span class="string">"Greg"</span>,<span class="number">27</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance2.colors) <span class="comment">//["red","blue","green"]</span></span><br><span class="line">instance2.sayName()  <span class="comment">//"Greg"</span></span><br><span class="line">instance2.sayAge() <span class="comment">//27</span></span><br></pre></td></tr></table></figure>
<h4 id="3-4-4-原型式继承"><a href="#3-4-4-原型式继承" class="headerlink" title="3.4.4 原型式继承"></a>3.4.4 原型式继承</h4></li>
<li>不定义自定义类型也可以通过原型实现对象之间的信息共享,ES增加了Object.create()方法规范了这种继承  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原理</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">object</span>(<span class="params">o</span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">    F.prototype = o</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> F()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">    name: <span class="string">'Nicholas'</span>,</span><br><span class="line">    friends:[<span class="string">"Shelby,"</span>Court<span class="string">","</span>Van<span class="string">"]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">let anotherPerson = object(person)</span></span><br><span class="line"><span class="string">//当只有一个参数时等价于</span></span><br><span class="line"><span class="string">//let anotherPerson = Object.create(person)</span></span><br><span class="line"><span class="string">anotherPerson.name = "</span>Greg<span class="string">"</span></span><br><span class="line"><span class="string">anotherPerson.friends.push("</span>Rob<span class="string">")</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">let yetAnotherPerson = object(person)</span></span><br><span class="line"><span class="string">//当只有一个参数时等价于</span></span><br><span class="line"><span class="string">//let anotherPerson = Object.create(person)</span></span><br><span class="line"><span class="string">yetAnotherPerson.name = "</span>Linda<span class="string">"</span></span><br><span class="line"><span class="string">yetAnotherPerson.frineds.push("</span>Barbie<span class="string">")</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">console.log(person.friends) //["</span>Shelby<span class="string">","</span>Court<span class="string">","</span>Van<span class="string">","</span>Rob<span class="string">","</span>Barbie<span class="string">"]</span></span><br></pre></td></tr></table></figure>
  以上object的过程其实是对传入对象执行了一次浅复制</li>
<li>第二个参数与Object.defineProperties()的第二个参数一样:每个新增属性通过各自的描述符来描述  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> anotherPerson = <span class="built_in">Object</span>.create(person,&#123;</span><br><span class="line">    name:&#123;</span><br><span class="line">        value:<span class="string">"Greg"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(anotherPerson.name)  <span class="comment">//"Greg"</span></span><br></pre></td></tr></table></figure></li>
<li>原型式继承非常适合不需要单独创建构建函数，但仍然需要在对象间共享信息。</li>
</ul>
<h4 id="3-4-5-寄生式继承"><a href="#3-4-5-寄生式继承" class="headerlink" title="3.4.5 寄生式继承"></a>3.4.5 寄生式继承</h4><ul>
<li>寄生式继承思路类似于寄生构造函数和工厂模式:创建一个实现继承的函数，以某种方式增强对象，然后返回这个对象  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createAnother</span>(<span class="params">original</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> clone = object(original)  <span class="comment">//通过调用函数创建一个新对象</span></span><br><span class="line">    clone.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//增强对象</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hi'</span>)  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> clone  <span class="comment">//返回这个对象</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>缺点是这种模式给对象添加函数会导致函数难以重用</li>
</ul>
<h4 id="3-4-6-寄生式组合继承"><a href="#3-4-6-寄生式组合继承" class="headerlink" title="3.4.6 寄生式组合继承"></a>3.4.6 寄生式组合继承</h4><ul>
<li><p>寄生式组合继承基本模式</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接收子类构造函数和父类构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inheritPrototype</span>(<span class="params">subType,superType</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> prototype = object(superType.prototype)</span><br><span class="line">    prototype.constructor  = subType <span class="comment">//增强对象</span></span><br><span class="line">    subType.prototype = prototype  <span class="comment">//赋值对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>]</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    SuperType.call(<span class="keyword">this</span>.name)</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line">inheritPrototype(subType,SuperType)</span><br><span class="line"></span><br><span class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>此方法是引用类型继承的最佳模式</p>
</li>
</ul>
<h3 id="3-5-类"><a href="#3-5-类" class="headerlink" title="3.5 类"></a>3.5 类</h3><h4 id="3-5-1-类定义"><a href="#3-5-1-类定义" class="headerlink" title="3.5.1 类定义"></a>3.5.1 类定义</h4><ul>
<li>类定义  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类声明</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;&#125;</span><br><span class="line"><span class="comment">//类表达式</span></span><br><span class="line"><span class="keyword">const</span> Animal = <span class="class"><span class="keyword">class</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>函数可以提升，但类定义不行</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数提升</span></span><br><span class="line"><span class="built_in">console</span>.log(FunctionDeclaration)  <span class="comment">// FunctionDeclaration()&#123;&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FunctionDeclaration</span> (<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类表达式</span></span><br><span class="line"><span class="built_in">console</span>.log(ClassExpression)  <span class="comment">//undefined</span></span><br><span class="line"><span class="keyword">var</span> ClassExpression = <span class="class"><span class="keyword">class</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类声明</span></span><br><span class="line"><span class="built_in">console</span>.log(ClassDeclaration) <span class="comment">//ReferenceError</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassDecalaration</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li>函数受函数作用域限制，类受块作用域限制  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">FunctionDeclaration</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ClassDeclaration</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(FunctionDeclaration)  <span class="comment">//FunctionDeclaration()&#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(ClassDeclaration)  <span class="comment">//ReferenceError</span></span><br></pre></td></tr></table></figure></li>
<li>类表达式名称是可选的，把类表达式赋值给变量后，可通过name属性取得类表达式的名称字符串，但不能在类表达式作用域外部访问这个标识符  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Person = <span class="class"><span class="keyword">class</span> <span class="title">PersonName</span></span>&#123;</span><br><span class="line">    identify()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(Person.name,PersonName.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person()</span><br><span class="line">p.identify()  <span class="comment">//PersonName PersonName</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Person.name)  <span class="comment">//PersonName</span></span><br><span class="line"><span class="built_in">console</span>.log(PersonName)  <span class="comment">//Reference</span></span><br></pre></td></tr></table></figure>
<h4 id="3-5-2-类构造函数"><a href="#3-5-2-类构造函数" class="headerlink" title="3.5.2 类构造函数"></a>3.5.2 类构造函数</h4></li>
<li>constructor关键字用于在类定义块内部创建类构造函数。<strong>它会告诉解析器在使用new操作符创建类实例时，应该调用该函数。构造函数不是必须的，不定义相当于空函数。</strong></li>
<li>类实例化时传入的参数会作构造函数的参数。如果不传参，类名后括号可选  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person</span><br></pre></td></tr></table></figure></li>
<li>类构造函数返回其他对象时，这个对象不会通过instanceOf操作符检测出与类有关联，因为这个对象原型指针没有被改变  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(override)&#123;</span><br><span class="line">        <span class="keyword">this</span>.foo = <span class="string">'foo'</span></span><br><span class="line">        <span class="keyword">if</span>(override)&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                bar: <span class="string">'bar'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person(<span class="literal">true</span>)</span><br><span class="line"><span class="built_in">console</span>.log(p)  <span class="comment">//&#123;bar:'bar'&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(p instanceOf Person) <span class="comment">//false</span></span><br></pre></td></tr></table></figure>
<h4 id="3-5-3-实例、原型和类成员"><a href="#3-5-3-实例、原型和类成员" class="headerlink" title="3.5.3 实例、原型和类成员"></a>3.5.3 实例、原型和类成员</h4></li>
<li>每个实例都对应一个唯一的成员对象，这意味着所有成员都不会在原型上共享</li>
<li>为了在实例间共享方法，类块中定义的方法作为原型方法  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> symbolKey = <span class="built_in">Symbol</span>(<span class="string">'symbolKey'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="comment">//添加到this的所有内容都存在于不同的实例上</span></span><br><span class="line">        <span class="keyword">this</span>.locate = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'instance'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//在类块中定义的所有内容都会定义在类原型上，方便共享</span></span><br><span class="line">    locate()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'prototype'</span>,<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//不能在类块中给原型添加原始值或对象作为成员数据</span></span><br><span class="line">    <span class="comment">//name: 'Jake'  //Uncaught</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//类方法等同于对象属性，因此可以使用字符串、符号或者计算值作为键</span></span><br><span class="line">    [symbolKey]()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(....)</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="string">'conputed'</span>+ <span class="string">'Key'</span>]()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(...)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//类定义也支持获取和设置访问器</span></span><br><span class="line">    <span class="keyword">set</span> name(newNames)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name_ = newNames</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">get</span> name()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name_</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//静态成员每个类上只能有一个</span></span><br><span class="line">    <span class="keyword">static</span> locate()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'class'</span>, <span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person()</span><br><span class="line">p.locate()  <span class="comment">//instance, Person&#123;&#125;</span></span><br><span class="line">Person.prototype.locate() <span class="comment">//'prototype',&#123;constructor:...&#125;</span></span><br><span class="line">Person.locate()  <span class="comment">//class, class Person&#123;&#125;</span></span><br><span class="line"></span><br><span class="line">p.name = <span class="string">"Jake"</span></span><br><span class="line"><span class="built_in">console</span>.log(p.name) <span class="comment">//'Jake'</span></span><br></pre></td></tr></table></figure></li>
<li>静态类方法非常适合作为实例工厂  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(age)&#123;</span><br><span class="line">        <span class="keyword">this</span>.age_ = age</span><br><span class="line">    &#125;</span><br><span class="line">    sayAge()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.age_)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> create()&#123;</span><br><span class="line">        <span class="comment">//使用随机年龄创建并返回一个Person实例</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Person(<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*<span class="number">100</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Person.create())  <span class="comment">//Person&#123;age_:...&#125;</span></span><br></pre></td></tr></table></figure></li>
<li>类定义语法支持在原型和类本身定义生成器方法  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.nicknames = [<span class="string">'Jack'</span>,<span class="string">'Jake'</span>,<span class="string">'J-Dog'</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//类原型上</span></span><br><span class="line">    *createNicknameIterator()&#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'Jack'</span>;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'Jake'</span>;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'J-Dog'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//在类上</span></span><br><span class="line">    <span class="keyword">static</span> *createJobIterator()&#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'Butcher'</span>;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'Baker'</span>;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'Candlestick maker'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//因为支持生成器方法，可以添加一个默认的迭代器，把类实例变成可迭代对象</span></span><br><span class="line">    *[<span class="built_in">Symbol</span>.iterator]()&#123;</span><br><span class="line">        <span class="keyword">yield</span> *<span class="keyword">this</span>.nickname.entries()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//也可以只返回对象实例 效果一样</span></span><br><span class="line">    <span class="comment">//[Symbol.iterator]()&#123;</span></span><br><span class="line">    <span class="comment">//    return this.nicknames.entries()</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p  = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> [idx, nickname] <span class="keyword">of</span> p)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(nickname)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Jack</span></span><br><span class="line"><span class="comment">//Jake</span></span><br><span class="line"><span class="comment">//J-Dog</span></span><br></pre></td></tr></table></figure>
<h4 id="3-5-4-类继承"><a href="#3-5-4-类继承" class="headerlink" title="3.5.4 类继承"></a>3.5.4 类继承</h4></li>
<li>类继承类，也可以继承普通的构造函数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bus</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> Bus()</span><br><span class="line"><span class="built_in">console</span>.log(b instanceOf Bus) <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(b instanceOf Vehicle)  <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承普通构造函数</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Engineer</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>
  派生类会通过原型链访问到类和原型上定义的方法，this的值会反映调用相应方法的实例或类</li>
<li>派生类在调用super()后才能使用this，super方法仅限于派生类的构造函数和静态方法内部使用。调用super()会调用父类构造函数，并将返回的实例赋值给this。  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.hasEngine = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> identify()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'vehicle'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bus</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="comment">//不要在调用super()之前引用this</span></span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>)  <span class="comment">//Bus &#123;hasEngine :true&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//在静态方法中可以通过super调用继承在类上定义的静态方法</span></span><br><span class="line">    <span class="keyword">static</span> identify()&#123;</span><br><span class="line">        <span class="keyword">super</span>.identify()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> Bus()</span><br><span class="line">Bus.identify() <span class="comment">//'vehicle'</span></span><br></pre></td></tr></table></figure></li>
<li><strong>如果没有定义类构造函数，在实例化派生类时会调用super()，而且会传入所有传给派生类的参数</strong></li>
<li><strong>如果在派生类中显式定义了构造函数，则必须在其中调用super(),或者在其中返回一个对象</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span></span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bus</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Van</span> <span class="keyword">extends</span> <span class="title">Vehicle</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Car())  <span class="comment">//Car&#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Bus())  <span class="comment">//Bus&#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Van())  <span class="comment">//&#123;&#125;</span></span><br></pre></td></tr></table></figure></li>
<li>抽象基类，供其他类继承，本身不会被实例化。通过实例化时检测new.target是不是抽象基类，可以阻止对抽象基类的实例化  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">new</span>.target)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">new</span>.target === Vehicle)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Vehicle cannot be directly instantiated'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//要求派生类必须定义foo方法</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.foo)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Inheriting class must define foo()'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//派生类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bus</span> <span class="keyword">extends</span> <span class="title">Vehicle</span></span>&#123;</span><br><span class="line">    foo()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//派生类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Van</span> <span class="keyword">extends</span> <span class="title">Vehicle</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Bus() <span class="comment">//class Bus&#123;&#125;</span></span><br><span class="line"><span class="keyword">new</span> Vehicle() <span class="comment">//'VEhicle cannot be derectly instantiated'</span></span><br><span class="line"><span class="keyword">new</span> Van()  <span class="comment">//Error: Inheriting class must define foo()</span></span><br></pre></td></tr></table></figure></li>
<li>继承内置类型  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuperArray</span> <span class="keyword">extends</span> <span class="title">Array</span></span>&#123;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="第4章-Javascript-函数"><a href="#第4章-Javascript-函数" class="headerlink" title="第4章 Javascript-函数"></a>第4章 Javascript-函数</h2><h3 id="4-1-箭头函数"><a href="#4-1-箭头函数" class="headerlink" title="4.1 箭头函数"></a>4.1 箭头函数</h3><ul>
<li>箭头函数不能使用arguments、super和new.target，也不能用作构造函数，也没有prototype属性  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arrowSum  = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//嵌入函数场景</span></span><br><span class="line"><span class="keyword">let</span> ints = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">insts.map(<span class="function">(<span class="params">i</span>) =&gt;</span> i + <span class="number">1</span> )</span><br></pre></td></tr></table></figure>
<h3 id="4-2-函数名"><a href="#4-2-函数名" class="headerlink" title="4.2 函数名"></a>4.2 函数名</h3></li>
<li>函数名就是指向函数的指针，这意味这一个函数可以有多个名称  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">10</span>, <span class="number">10</span>))  <span class="comment">//20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//与sum指向同一个函数</span></span><br><span class="line"><span class="keyword">let</span> anotherSum = sum</span><br><span class="line"><span class="built_in">console</span>.log(anotherSum(<span class="number">10</span>, <span class="number">10</span>))  <span class="comment">//20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//切断与函数之间的关联</span></span><br><span class="line">sum = <span class="literal">null</span></span><br><span class="line"><span class="comment">//照常可以使用</span></span><br><span class="line"><span class="built_in">console</span>.log(anotherSum(<span class="number">10</span>, <span class="number">10</span>))  <span class="comment">//20</span></span><br></pre></td></tr></table></figure></li>
<li><strong>所有函数对象都会暴露一个只读name属性</strong>，如果用Function构造函数创建，则会标识成”anonymous”  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> bar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> baz = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(foo.name)  <span class="comment">//foo</span></span><br><span class="line"><span class="built_in">console</span>.log(bar.name)  <span class="comment">//bar</span></span><br><span class="line"><span class="built_in">console</span>.log(baz.name)   <span class="comment">//baz</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="function">(<span class="params">(</span>)=&gt;</span> &#123;&#125;).name)  <span class="comment">//(空字符串)</span></span><br><span class="line"><span class="built_in">console</span>.log((<span class="keyword">new</span> <span class="built_in">Function</span>()).name)  <span class="comment">//anonymous</span></span><br><span class="line"><span class="built_in">console</span>.log((foo.bind(<span class="literal">null</span>)).name)  <span class="comment">//bound foo</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3-理解参数"><a href="#4-3-理解参数" class="headerlink" title="4.3 理解参数"></a>4.3 理解参数</h3></li>
<li><strong>函数的参数内部表现为一个数组，函数被调用时总会接收一个数组</strong></li>
<li>在使用function关键字定义(非箭头)函数时，可以在函数内部访问arguments对象，从中获取传进来的每个参数值。arguments对象是一个类数组对象(但不是Array实例)，通过arguments[index]访问。<strong>通过arguments[0]取得同样的参数值，把函数重写成不声明参数也可以</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params">name,message</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Hello "</span> + name + <span class="string">'.'</span> + message)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Hello "</span>+ <span class="built_in">arguments</span>[<span class="number">0</span>] + <span class="string">'.'</span> + <span class="built_in">arguments</span>[<span class="number">1</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  <strong>函数参数只是为了方便才写出来，并不是必须写出来</strong></li>
<li>通过<code>arguments.length</code>属性检查传入的参数个数,注意它的值不是定义函数时命名参数的个数。  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">howManyArgs</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.length)</span><br><span class="line">&#125;</span><br><span class="line">howManyArgs(<span class="string">"string"</span>, <span class="number">45</span>)  <span class="comment">//2</span></span><br><span class="line">howManyArgs(<span class="number">1</span>)  <span class="comment">//1</span></span><br><span class="line">howManyArgs()  <span class="comment">//0</span></span><br></pre></td></tr></table></figure></li>
<li>arguments对象的值会自动同步对应命名参数，但这不意味着它们都访问同一个内存地址，它们还是分开的，只是保持同步而已。严格模式下则要注意，给arguments重新赋值也不会影响命名参数传入的值。</li>
<li><strong>所有参数都是按值传递，不可能按引用传递。如果是对象则传递的值就是这个对象的引用。</strong></li>
</ul>
<h3 id="4-4-默认参数值"><a href="#4-4-默认参数值" class="headerlink" title="4.4 默认参数值"></a>4.4 默认参数值</h3><ul>
<li>显式定义默认参数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeKing</span>(<span class="params">name = <span class="string">'Herry'</span></span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//不局限于原始值或对象值，还可以是调用函数返回值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeLing</span>(<span class="params">name = getNumerais(</span>))</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">函数默认参数只有在函数调用时才会求值，而且未传参的情况下才会被调用</span><br></pre></td></tr></table></figure></li>
<li>因为参数时按顺序初始化的，所以后定义默认的参数可以引用先定义的参数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeKing</span>(<span class="params">name = <span class="string">"Herry"</span>, numerals = name</span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-5-参数扩展与收集"><a href="#4-5-参数扩展与收集" class="headerlink" title="4.5 参数扩展与收集"></a>4.5 参数扩展与收集</h3></li>
<li>使用扩展操作符  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="built_in">console</span>.log(getSum(<span class="number">-1</span>,...values))  /<span class="number">9</span></span><br><span class="line"><span class="built_in">console</span>.log(getSum(...values,<span class="number">5</span>))  <span class="comment">//15</span></span><br><span class="line"><span class="built_in">console</span>.log(getSum(<span class="number">-1</span>,...values,<span class="number">5</span>))  <span class="comment">//14</span></span><br><span class="line"><span class="built_in">console</span>.log(getSum(...values,...[<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>])) <span class="comment">//28</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//同时可以用于命名参数，也可以使用默认参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getProduct</span>(<span class="params">a, b, c = <span class="number">1</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * b * c</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(getProduct(...[<span class="number">1</span>,<span class="number">2</span>]))  <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(getProduct(...[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))  <span class="comment">//6</span></span><br></pre></td></tr></table></figure>
  对arguments对象而言，它并不知道扩展操作符的存在，而是按照函数传入的参数接收每个值</li>
<li>函数的收集参数, <strong>只能作为最后一个参数使用</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//error</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getProduct</span>(<span class="params">...values, lastValue</span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ignoreFirst</span>(<span class="params">firstValue, ...values</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(values)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ignoreFirst()  <span class="comment">//[]</span></span><br><span class="line">ignoreFirst([<span class="number">1</span>])  <span class="comment">//[]</span></span><br><span class="line">ignoreFirst([<span class="number">1</span>,<span class="number">2</span>])  <span class="comment">//[2]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="4-6-函数声明与函数表达式"><a href="#4-6-函数声明与函数表达式" class="headerlink" title="4.6 函数声明与函数表达式"></a>4.6 函数声明与函数表达式</h3><ul>
<li>函数声明与函数表达式区别在于:函数声明会变量提升  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没问题</span></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">10</span>,<span class="number">10</span>))</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//会出错,这并不是let导致的，var关键字也会碰到同样问题</span></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">10</span>, <span class="number">10</span>))</span><br><span class="line"><span class="keyword">let</span> sum = <span class="function"><span class="keyword">function</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="4-7-函数内部"><a href="#4-7-函数内部" class="headerlink" title="4.7 函数内部"></a>4.7 函数内部</h3><h4 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h4><ul>
<li>arguments包含调用函数传入的所有参数，这个对象只有以function关键字定义函数时才有</li>
<li>arguments.callee作用是调用相同函数名  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num * factorial(num - <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  上面的函数正确执行必须保证函数名是factorial，从而导致了紧密耦合，<strong>使用arguments.callee就可以让函数逻辑与函数名解耦</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">if</span>(num &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> num * <span class="built_in">arguments</span>.callee(num <span class="number">-1</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  这意味着无论函数叫什么名称，都可以引用正确的函数</li>
</ul>
<h4 id="this"><a href="#this" class="headerlink" title="this"></a>this</h4><ul>
<li>在标准函数中，this引用的是把函数当成方法调用的上下文对象。(在网页的全局上下文中调用函数时，this指向windows)  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.color = <span class="string">'red'</span></span><br><span class="line"><span class="keyword">let</span> o =&#123;</span><br><span class="line">    color: <span class="string">'blue'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.color)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sayColor()  <span class="comment">//"red"</span></span><br><span class="line">o.sayColor = sayColor </span><br><span class="line">o.sayColor() <span class="comment">//"blue"</span></span><br></pre></td></tr></table></figure></li>
<li><strong>在箭头函数中，this会保留定义该函数时的上下文</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.color = <span class="string">"red"</span></span><br><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">    color: <span class="string">"blue"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> sayColor = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>.color)</span><br><span class="line">sayColor() <span class="comment">//"red"</span></span><br><span class="line"></span><br><span class="line">o.sayColor = sayColor</span><br><span class="line">o.sayColor()  <span class="comment">//"red"</span></span><br></pre></td></tr></table></figure>
  在事件回调或定时回调中调用某个函数时  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">King</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.royaItyName = <span class="string">"Herry"</span></span><br><span class="line">    <span class="comment">//this引用King的实例</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>.royaItyName),<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queen</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.royaItyName = <span class="string">"Elizabeth"</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//this引用window对象</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.royaItyName)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> King()  <span class="comment">//"Herry"</span></span><br><span class="line"><span class="keyword">new</span> Queen()  <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure></li>
<li>闭包中使用this会让代码变得复杂  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.identity  = <span class="string">'The Window'</span></span><br><span class="line"><span class="keyword">let</span> object = &#123;</span><br><span class="line">    identity : <span class="string">'My object'</span>,</span><br><span class="line">    getIdentityFunc()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.identity</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(object.getIdentityFunc()())  <span class="comment">//'Tne Window'</span></span><br></pre></td></tr></table></figure>
  <strong>由于每个函数被调用时会自动创建两个特殊变量:this和arguments。内部函数永远不可能直接访问外部函数的这两个变量。但是，如果把this保存到闭包可用访问的另一变量中:</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.identity = <span class="string">'The Window'</span></span><br><span class="line"><span class="keyword">let</span> object = &#123;</span><br><span class="line">    identity:<span class="string">'My Object'</span>,</span><br><span class="line">    getIdentityFunc()&#123;</span><br><span class="line">        <span class="keyword">let</span> that = <span class="keyword">this</span></span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.identity</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(object.getIdentityFunc()())  <span class="comment">//'My Object'</span></span><br></pre></td></tr></table></figure>
<h4 id="caller"><a href="#caller" class="headerlink" title="caller"></a>caller</h4></li>
<li>caller 调用当前函数的函数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outer</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    inner()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inner</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(inner.caller)</span><br><span class="line">&#125;</span><br><span class="line">outer()</span><br></pre></td></tr></table></figure>
  以上代码会显示outer()函数的源代码，这是因为outer()调用了inner(),inner.caller指向outer，如果要降低耦合度，可通过arguments.callee.caller来引用同样的值。注意在严格模式下访问argument.callee会报错。</li>
</ul>
<h3 id="4-8-函数属性与方法"><a href="#4-8-函数属性与方法" class="headerlink" title="4.8 函数属性与方法"></a>4.8 函数属性与方法</h3><h4 id="length"><a href="#length" class="headerlink" title="length"></a>length</h4><ul>
<li>length属性保存函数定义的命名参数的个数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayName</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sun</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(sayName.length)  <span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(sum.length)  <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<h4 id="apply、call与bind"><a href="#apply、call与bind" class="headerlink" title="apply、call与bind"></a>apply、call与bind</h4></li>
<li>这两个方法都会以指定的this值来调用函数</li>
<li>apply方法接收两个参数:函数内this的值和一个参数数组，第二个参数可以是Array实例，也可以是arguments对象  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//传入arguments</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum1</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sum.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//传入数组</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum2</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sum.apply(<span class="keyword">this</span>, [num1, num2])</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(callSum1(<span class="number">10</span> ,<span class="number">10</span>))  <span class="comment">//20</span></span><br><span class="line"><span class="built_in">console</span>.lo(callSum2(<span class="number">10</span>, <span class="number">10</span>))  <span class="comment">//20</span></span><br></pre></td></tr></table></figure>
  <strong>以上的this指向的是window。注意严格模式下，调用函数如果没有指定上下文对象，this不会指向window，除非使用apply()或call()把函数指定给一个对象，否则this会变成undefined</strong></li>
<li>call区别在于第二个参数开始，要传递给被调用函数的参数是逐个传递的，必须把参数一个个列出来  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sum.call(<span class="keyword">this</span>.num1, num2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>apply和call强大的作用是控制函数调用上下文即函数体内this的能力</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.color = <span class="string">"red"</span></span><br><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">    color:<span class="string">"blue"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.color)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sayColor()  <span class="comment">//"red"</span></span><br><span class="line">sayColor.call(<span class="keyword">this</span>)  <span class="comment">//"red"</span></span><br><span class="line">sayColor.call(<span class="built_in">window</span>)  <span class="comment">//"red"</span></span><br><span class="line"><span class="comment">//把函数执行上下文即this切换为对象o</span></span><br><span class="line">sayColor.call(o)  <span class="comment">//"blue"</span></span><br></pre></td></tr></table></figure>
  可以将任意对象设置为任意函数的作用域，这样对象可以不用关系方法</li>
<li>ES5出于同样的目的，定义了bind()方法，它会创建一个新的函数实例，其this值会被绑定到传给bind()的对象  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.color = <span class="string">"red"</span></span><br><span class="line"><span class="keyword">var</span> o =&#123;</span><br><span class="line">    color:<span class="string">"blue"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.color)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> objectSayColor = sayColor.bind(o)</span><br><span class="line">objectSayColor() <span class="string">"blue"</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="4-9-递归"><a href="#4-9-递归" class="headerlink" title="4.9 递归"></a>4.9 递归</h3><ul>
<li>在非严格模式下，使用arguments.callee是引用当前函数的首选</li>
<li>严格模式下不能访问arguments.callee，可用命名函数表达式:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> factorial = (</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(num &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> num * f(num <span class="number">-1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="4-10-内存泄漏"><a href="#4-10-内存泄漏" class="headerlink" title="4.10 内存泄漏"></a>4.10 内存泄漏</h3><ul>
<li>只要匿名函数存在,element的引用计数就至少等于1，内存就不会被回收  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assignHandler</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'someElement'</span>)</span><br><span class="line">    element.onclick = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(element.id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  优化：  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assignHandler</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'someElement'</span>)</span><br><span class="line">    <span class="keyword">let</span> id = element.id</span><br><span class="line">    element.onclick =<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(id)</span><br><span class="line">    element = <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  <strong>闭包改为引用一个保存着element.id的变量id，从而消除了循环引用</strong>，但即使闭包没有直接引用element，包含函数的活动对象上还是保存着对它的引用，因此必须把element设置为null。<h3 id="4-11-私有变量"><a href="#4-11-私有变量" class="headerlink" title="4.11 私有变量"></a>4.11 私有变量</h3><h4 id="特权方法"><a href="#特权方法" class="headerlink" title="特权方法"></a>特权方法</h4></li>
<li>可用访问私有变量的公共方法叫做特权方法<ul>
<li>构造函数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyObject</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//私有变量和私有函数</span></span><br><span class="line">    <span class="keyword">let</span> privateVariable = <span class="number">10</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">privateFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//特权方法:其实是个闭包</span></span><br><span class="line">    <span class="keyword">this</span>.publicMethod = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      privateVariable++;</span><br><span class="line">        <span class="keyword">return</span> privateFunction()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>原型模式  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="string">''</span></span><br><span class="line">    Person = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        name = value</span><br><span class="line">    &#125;</span><br><span class="line">    Person.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Person.prototype.setName = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        name = value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">)()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person(<span class="string">'Nicholas'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1.getName()) <span class="comment">//'Nicholas'</span></span><br><span class="line">person1.setName(<span class="string">'Matt'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1.getName()) <span class="comment">//'Matt'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person(<span class="string">'Michael'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1.getBAme()) <span class="string">'Michael'</span></span><br></pre></td></tr></table></figure>
  像这样创建静态私有变量可用利用原型更好的重用代码，但是每个实例共享了这个私有变量，一个实例修改了变量会影响另一个实例。<h4 id="模块模式"><a href="#模块模式" class="headerlink" title="模块模式"></a>模块模式</h4></li>
</ul>
</li>
<li>单例对象实现隔离和封装，单例对象就是只有一个实例的对象。在Web开发中，经常需要使用单例对象管理应用程序级的信息，下面创建了一个application对象管理组件:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> application = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//私有变量和私有函数</span></span><br><span class="line">    <span class="keyword">let</span> components = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    components.push(<span class="keyword">new</span> BaseComponent())</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//公共接口</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="comment">//返回注册组件的数量</span></span><br><span class="line">            getComponentCount()&#123;</span><br><span class="line">                <span class="keyword">return</span> components.length</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//注册新组件 </span></span><br><span class="line">            registerComponent(component)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">typeof</span> component == <span class="string">'object'</span>)&#123;</span><br><span class="line">                    components.push(component)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  在模块模式中，单例对象作为一个模块，经过初始化包含某些私有数据，而这些数据又可用通过暴露的公共方法来访问</li>
<li>如果上一节的application对象必须是BaseComponent实例:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> application = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//私有变量和私有函数</span></span><br><span class="line">    <span class="keyword">let</span> component = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    component.push(<span class="keyword">new</span> BaseComponent())</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//创建局部变量保存实例</span></span><br><span class="line">    <span class="keyword">let</span> app = <span class="keyword">new</span> BaseComponent()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//公共接口</span></span><br><span class="line">    app.getComponent = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> components.length</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    app.registerComponent = <span class="function"><span class="keyword">function</span>(<span class="params">component</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> component == <span class="string">'object'</span>)&#123;</span><br><span class="line">            components.push(component)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> app</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="第5章-Javascript-异步"><a href="#第5章-Javascript-异步" class="headerlink" title="第5章 Javascript-异步"></a>第5章 Javascript-异步</h2><h3 id="5-1-Promise"><a href="#5-1-Promise" class="headerlink" title="5.1 Promise"></a>5.1 Promise</h3><h4 id="5-1-1-Promise基础"><a href="#5-1-1-Promise基础" class="headerlink" title="5.1.1 Promise基础"></a>5.1.1 Promise基础</h4><ul>
<li>Promise通过new操作符来实例化，期约是有个有状态的对象，可能处于如下3种状态之一:<ul>
<li>待定(pending),最初的状态</li>
<li>兑现(fulfilled,有时也称为resolved)</li>
<li>拒绝(rejected)<br>无论落定是哪种状态，只要从待定转换为兑现或拒绝，期约的状态就不再改变。期约将异步封装起来，从而隔离外部的同步代码。</li>
</ul>
</li>
<li>调用resolve()会将状态切换为兑现，调用reject()会将状态切换为拒绝</li>
<li>Promise.resolve  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 =  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> resolve())</span><br><span class="line"><span class="comment">//等同于</span></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="built_in">Promise</span>.resolve()</span><br></pre></td></tr></table></figure></li>
<li>Promise.prototype.catch() 用于给期约添加拒绝处理程序  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">let</span> p = <span class="built_in">Promise</span>.reject()</span><br><span class="line">    <span class="keyword">let</span> onRejected = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">        setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>, <span class="string">'rejected'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这两种添加拒绝处理程序是一样的</span></span><br><span class="line">    p.then(<span class="literal">null</span>, onRejected) <span class="comment">//rejected</span></span><br><span class="line">    <span class="comment">//p.catch(onRejected)</span></span><br><span class="line">    </span><br><span class="line">- <span class="built_in">Promise</span>.prototype.finally()处理程序没有办法知道期约的状态是解决还是拒绝，这个方法主要用于清理代码</span><br><span class="line">- 消息队列</span><br><span class="line">    - 示例</span><br><span class="line">        <span class="string">``</span><span class="string">`js</span></span><br><span class="line"><span class="string">        //创建解决期约</span></span><br><span class="line"><span class="string">        let p = Promise.resolve()</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        //添加解决处理程序</span></span><br><span class="line"><span class="string">        p.then(()=&gt; console.log('onResolved handler'))</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        //同步输出，证明then()已经返回</span></span><br><span class="line"><span class="string">        console.log('then() return')</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        //实际输出</span></span><br><span class="line"><span class="string">        //then() return </span></span><br><span class="line"><span class="string">        //onResolved handler</span></span><br></pre></td></tr></table></figure>
<pre><code>在一个解决期约上调用then()会把onResolved处理程序推进消息队列，但这个处理程序在当前线程上的同步代码执行前不会执行</code></pre><ul>
<li>示例二  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> synchronousResolve</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个期约并将解决函数保存在一个局部变量中</span></span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span>&#123;</span><br><span class="line">    synchronousResolve = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'1:invokong resolve()'</span><span class="string">'=)</span></span><br><span class="line"><span class="string">        resolve()</span></span><br><span class="line"><span class="string">        console.log('</span><span class="number">2</span>: resolve() returns<span class="string">')</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">p.then(() =&gt; console.log('</span><span class="number">4</span>: then() handler executes<span class="string">'))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">synchronousResolve()</span></span><br><span class="line"><span class="string">console.log('</span><span class="number">3</span>: synchronousResolve() returns<span class="string">')</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//实际输出</span></span><br><span class="line"><span class="string">//1: invoking resolve()</span></span><br><span class="line"><span class="string">//2: resolve() returns</span></span><br><span class="line"><span class="string">//3: synchronousResolve() returns</span></span><br><span class="line"><span class="string">//4: then() handler exectues</span></span><br></pre></td></tr></table></figure></li>
<li>示例三  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1  = <span class="built_in">Promise</span>.resolve()</span><br><span class="line">p1.then(<span class="function"><span class="params">()</span>=&gt;</span><span class="built_in">console</span>.log(‘p1.then() onResolved’))</span><br><span class="line"><span class="built_in">console</span>.log(‘p1.then() returns’)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="built_in">Promise</span>.reject()</span><br><span class="line">p2.then(<span class="function"><span class="params">()</span>=&gt;</span><span class="built_in">console</span>.log(‘p2.then() onRejected’))</span><br><span class="line"><span class="built_in">console</span>.log(‘p2.then() returns’)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="built_in">Promise</span>.reject()</span><br><span class="line">p3.then(<span class="function"><span class="params">()</span>=&gt;</span><span class="built_in">console</span>.log(‘p3.then() onRejected’))</span><br><span class="line"><span class="built_in">console</span>.log(‘p3.catch() returns’)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.resolve()</span><br><span class="line">p4.finally(<span class="function"><span class="params">()</span>=&gt;</span><span class="built_in">console</span>.log(‘p4.finally() onFinally’))</span><br><span class="line"><span class="built_in">console</span>.log(‘p4.finally() returns’)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//p1.then() returns</span></span><br><span class="line"><span class="comment">//p2.then() returns</span></span><br><span class="line"><span class="comment">//p3.catch() returns</span></span><br><span class="line"><span class="comment">//p4.finally() returns</span></span><br><span class="line"><span class="comment">//p1.then() onResolved</span></span><br><span class="line"><span class="comment">//p2.then() onRejected</span></span><br><span class="line"><span class="comment">//p3.catch() onRejected</span></span><br><span class="line"><span class="comment">//p4.finally() onFinally</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>拒绝期约与拒绝错误处理<ul>
<li>顺序  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> reject(<span class="built_in">Error</span>(<span class="string">'foo'</span>)))</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">'foo'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p3 = <span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span>=&gt;</span> &#123; <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">'foo'</span>)&#125;)</span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.reject(<span class="built_in">Error</span>(<span class="string">'foo'</span>))</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>,p1)<span class="comment">// Promise &lt;rejected&gt;: Error: foo</span></span><br><span class="line">setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>,p2) <span class="comment">//Promise &lt;rejected&gt; Error: foo</span></span><br><span class="line">setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>,p3)  <span class="comment">//Promise &lt;rejected&gt; Error: foo</span></span><br><span class="line">setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>,p4)  <span class="comment">//Promise &lt;rejected&gt; Error: foo</span></span><br></pre></td></tr></table></figure>
  追寻错误信息如下:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">at test.html:<span class="number">5</span></span><br><span class="line">...</span><br><span class="line">at test.html:<span class="number">6</span></span><br><span class="line">...</span><br><span class="line">at test.html:<span class="number">8</span></span><br><span class="line">...</span><br><span class="line">at test.html:<span class="number">7</span></span><br></pre></td></tr></table></figure>
  Promise.resolve().then()的错误最后才出现，这是因为它需要在运行时消息队列中添加处理程序，也就是说，在最终抛出未捕获错误之前它还会创建另一个期约</li>
<li>正常情况下，在通过throw()关键字抛出错误时，Javascript运行时的错误处理机制会停止执行抛出错误之后的任何指令，但在期约中抛出错误时，因为错误实际上是从消息队列中异步抛出的，所以并不会阻止运行时继续执行同步指令  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">'foo'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'bar'</span>)  <span class="comment">//这行不会执行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Uncaught Error: foo</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.reject(<span class="built_in">Error</span>(<span class="string">'foo'</span>))</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'bar'</span>)</span><br><span class="line"><span class="comment">//bar</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Uncaught (in promise) Error: foo</span></span><br></pre></td></tr></table></figure>
  <strong>异步错误只能通过异步的onRejected处理程序捕获</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//正确</span></span><br><span class="line"><span class="built_in">Promise</span>.reject(<span class="built_in">Error</span>(<span class="string">'foo'</span>)).catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//不正确</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="built_in">Promise</span>.reject(<span class="built_in">Error</span>(<span class="string">'foo'</span>))</span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br></pre></td></tr></table></figure>
  上面不包括捕获执行函数中的错误，在解决或拒绝期约之前，仍然可以使用try/catch在执行函数中捕获错误:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">'foo'</span>)</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    resolve(<span class="string">'bar'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h4 id="5-1-2-Promise-all"><a href="#5-1-2-Promise-all" class="headerlink" title="5.1.2 Promise.all"></a>5.1.2 Promise.all</h4><ul>
<li>Promise.all()静态方法创建的期约会在一组期约全部解决之后再解决，这个静态方法接收一个可迭代对象，返回一个新期约  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">Promise</span>.all([</span><br><span class="line">    <span class="built_in">Promise</span>.resolve()</span><br><span class="line">    <span class="built_in">Promise</span>.resolve()</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">//可迭代对象元素会通过Promise.resolve()转换为期约</span></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="built_in">Promise</span>.all([<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">//空的可迭代对象等价于Promise.resolve()</span></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="built_in">Promise</span>.all([])</span><br><span class="line"></span><br><span class="line"><span class="comment">//无效语法</span></span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.all()</span><br><span class="line"><span class="comment">//TypeError</span></span><br></pre></td></tr></table></figure>
  如果包含一个待定/拒绝期约，期约也会待定/拒绝  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//永远待定</span></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">Promise</span>.all(<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">()</span>=&gt;</span> &#123;&#125;))</span><br><span class="line">setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>, p1)  <span class="comment">//Promise &lt;pending&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//一次拒绝会导致最终期约拒绝</span></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="built_in">Promise</span>.all([</span><br><span class="line">    <span class="built_in">Promise</span>.resolve()</span><br><span class="line">    <span class="built_in">Promise</span>.reject()</span><br><span class="line">    <span class="built_in">Promise</span>.resolve()</span><br><span class="line">])</span><br><span class="line">setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>,p2) <span class="comment">//Promise &lt;rejected&gt;</span></span><br></pre></td></tr></table></figure>
  如果所有期约都成功被解决，则会按迭代顺序：  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="built_in">Promise</span>.all([</span><br><span class="line">    <span class="built_in">Promise</span>.resolve(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">Promise</span>.resolve()</span><br><span class="line">    <span class="built_in">Promise</span>.resolve(<span class="number">4</span>)</span><br><span class="line">])</span><br><span class="line">p.then(<span class="function">(<span class="params">values</span>) =&gt;</span> setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>, values)) <span class="comment">//[3,undefined,4]</span></span><br></pre></td></tr></table></figure>
  如果有期约拒绝，则第一个拒绝的期约会将自己作为拒绝理由，之后再拒绝的期约不会影响最后的拒绝结果，但并不影响之后期约正常的拒绝操作，仍然会处理，不会有错误被漏掉  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="built_in">Promise</span>.all([</span><br><span class="line">    <span class="built_in">Promise</span>.reject(),</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> setTimeout(reject,<span class="number">1000</span>)</span><br><span class="line">])</span><br><span class="line">p.catch(<span class="function">(<span class="params">reason</span>) =&gt;</span> setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>,reason))  <span class="comment">//3</span></span><br><span class="line"><span class="comment">//没有未处理的错误</span></span><br></pre></td></tr></table></figure>
<h4 id="5-1-3-Promise-race"><a href="#5-1-3-Promise-race" class="headerlink" title="5.1.3 Promise.race"></a>5.1.3 Promise.race</h4></li>
<li>Promise.race()静态方法返回一个包装期约，是一组集合中最先解决或拒绝的期约镜像  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">Promise</span>.race([</span><br><span class="line">    <span class="built_in">Promise</span>.resolve(),</span><br><span class="line">    <span class="built_in">Promise</span>.resolve()</span><br><span class="line">])</span><br><span class="line"><span class="comment">//可迭代对象中的元素会通过Promise.resolve()转换为期约</span></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="built_in">Promise</span>.race([<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">//空的可迭代对象等价于new Promise(() =&gt; &#123;&#125;)</span></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="built_in">Promise</span>.race([])</span><br><span class="line"></span><br><span class="line"><span class="comment">//无效</span></span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.race()</span><br><span class="line"><span class="comment">//TypeError</span></span><br></pre></td></tr></table></figure>
  无论是拒绝/解决期约，它都会包装其解决值或拒绝理由返回新期约  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解决先发生，超时后的拒绝被忽略</span></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">Promise</span>.race([</span><br><span class="line">    <span class="built_in">Promise</span>.resolve(<span class="number">3</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> setTimeout(reject, <span class="number">1000</span>))</span><br><span class="line">])</span><br><span class="line">setTimeout(<span class="built_in">console</span>.log,<span class="number">0</span>,p1)  <span class="comment">//Promise &lt;resolved&gt;: 3</span></span><br></pre></td></tr></table></figure>
<h3 id="5-2-Async-异步函数"><a href="#5-2-Async-异步函数" class="headerlink" title="5.2 Async 异步函数"></a>5.2 Async 异步函数</h3><h4 id="5-2-1-基础"><a href="#5-2-1-基础" class="headerlink" title="5.2.1 基础"></a>5.2.1 基础</h4></li>
<li>async关键字用于声明异步函数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> bar = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> baz = <span class="keyword">async</span> ()=&gt;&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Qux</span></span>&#123;</span><br><span class="line">    <span class="keyword">async</span> qux()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>异步函数始终返回期约对象，在函数外部调用这个函数可以返回它返回的期约  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">    <span class="comment">//这里返回一个期约对象也是一样的</span></span><br><span class="line">    <span class="comment">//return Promise.resolve(3)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给返回的期约添加一个解决处理程序</span></span><br><span class="line">foo().then(<span class="built_in">console</span>.log)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="comment">//3</span></span><br></pre></td></tr></table></figure>
<h4 id="5-2-2-await"><a href="#5-2-2-await" class="headerlink" title="5.2.2 await"></a>5.2.2 await</h4></li>
<li>await 用于暂停和恢复执行<ul>
<li>示例一<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> setTimeout(resolve,<span class="number">1000</span>,<span class="number">3</span>))</span><br><span class="line">p.then(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x))  <span class="comment">//3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用async/await 可以写成这样</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resovle,reject</span>) =&gt;</span> setTimeout(resolve,<span class="number">1000</span>,<span class="number">3</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">await</span> p)</span><br><span class="line">&#125;</span><br><span class="line">foo() <span class="comment">//3</span></span><br></pre></td></tr></table></figure></li>
<li>示例二<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">async function foo()&#123;</span><br><span class="line">    console.log(1)</span><br><span class="line">    await Promise.reject(3)</span><br><span class="line">    console.log(4)  &#x2F;&#x2F;这行不会执行</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;给返回的期约添加一个拒绝处理程序</span><br><span class="line">foo().catch(console.log)</span><br><span class="line">console.log(2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;1</span><br><span class="line">&#x2F;&#x2F;2</span><br><span class="line">&#x2F;&#x2F;3</span><br></pre></td></tr></table></figure></li>
<li>示例三<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="number">8</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">9</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">await</span> <span class="number">6</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">7</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">foo()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">bar()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="comment">//3</span></span><br><span class="line"><span class="comment">//4</span></span><br><span class="line"><span class="comment">//5</span></span><br><span class="line"><span class="comment">//8</span></span><br><span class="line"><span class="comment">//9</span></span><br><span class="line"><span class="comment">//6</span></span><br><span class="line"><span class="comment">//7</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<h4 id="5-2-3-axios"><a href="#5-2-3-axios" class="headerlink" title="5.2.3 axios"></a>5.2.3 axios</h4><ul>
<li><p>基本用法</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Make a request for a user with a given ID</span></span><br><span class="line">axios.get(<span class="string">'/user?ID=12345'</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// handle success</span></span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// handle error</span></span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// always executed</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Optionally the request above could also be done as</span></span><br><span class="line">axios.get(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      ID: <span class="number">12345</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// always executed</span></span><br><span class="line">  &#125;);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// Want to use async/await? Add the `async` keyword to your outer function/method.</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getUser</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.get(<span class="string">'/user?ID=12345'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>API</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Send a POST request</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">'post'</span>,</span><br><span class="line">  url: <span class="string">'/user/12345'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET request for remote image in node.js</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">'get'</span>,</span><br><span class="line">  url: <span class="string">'http://bit.ly/2mTM3nY'</span>,</span><br><span class="line">  responseType: <span class="string">'stream'</span></span><br><span class="line">&#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    response.data.pipe(fs.createWriteStream(<span class="string">'ada_lovelace.jpg'</span>))</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>browser 使用<code>URLSearchParams</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> params = <span class="keyword">new</span> URLSearchParams();</span><br><span class="line">params.append(<span class="string">'param1'</span>, <span class="string">'value1'</span>);</span><br><span class="line">params.append(<span class="string">'param2'</span>, <span class="string">'value2'</span>);</span><br><span class="line">axios.post(<span class="string">'/foo'</span>, params);</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="5-2-4-异步函数策略"><a href="#5-2-4-异步函数策略" class="headerlink" title="5.2.4 异步函数策略"></a>5.2.4 异步函数策略</h4><p>sleep</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">delay</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> setTimeout(resolve,delay))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> t0 = <span class="built_in">Date</span>.now()</span><br><span class="line">    <span class="keyword">await</span> sleep(<span class="number">1500</span>)  <span class="comment">//暂停约1500毫秒</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Date</span>.now() - t0)</span><br><span class="line">&#125;</span><br><span class="line">foo()</span><br><span class="line"><span class="comment">//1502</span></span><br></pre></td></tr></table></figure>

<h4 id="5-2-5-串行执行期约"><a href="#5-2-5-串行执行期约" class="headerlink" title="5.2.5 串行执行期约"></a>5.2.5 串行执行期约</h4><ul>
<li>await直接传递每个函数的返回值，结果通过迭代产生  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTwo</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTree</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFive</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">addTen</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> fn <span class="keyword">of</span> [addTwo,addTree,addFive])&#123;</span><br><span class="line">        x = <span class="keyword">await</span> fn(x)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line">addTen(<span class="number">9</span>).then(<span class="built_in">console</span>.log)  <span class="comment">//19</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="5-3-Promise、Generator、Async三者的区别"><a href="#5-3-Promise、Generator、Async三者的区别" class="headerlink" title="5.3 Promise、Generator、Async三者的区别"></a>5.3 Promise、Generator、Async三者的区别</h3><ul>
<li><p>Promise</p>
<ul>
<li><p>Promise有三种状态：pending(进行中)、resolved(成功)、rejected(失败)</p>
</li>
<li><p>Promise对象的缺点：</p>
<p>1、无法取消Promise，一旦新建它就会立即执行，无法中途取消。</p>
<p>2、如果不设置回调函数，Promise内部抛出的错误，不会反应到外部。</p>
<p>3、当处于Pending状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）。</p>
<p>4、Promise 真正执行回调的时候，定义 Promise 那部分实际上已经走完了，所以 Promise 的报错堆栈上下文不太友好。</p>
</li>
</ul>
</li>
<li><p>Generator </p>
<ul>
<li><p>Generator 是ES6引入的新语法，Generator是一个可以暂停和继续执行的函数。</p>
</li>
<li><p>简单的用法，可以当做一个Iterator来用，进行一些遍历操作。复杂一些的用法，他可以在内部保存一些状态，成为一个状态机。</p>
</li>
<li><p>Generator 基本语法包含两部分：函数名前要加一个星号；函数内部用 yield 关键字返回值。</p>
</li>
<li><p>yield表达式本身没有返回值，或者说总是返回undefined。</p>
</li>
<li><p>next方法可以带一个参数，该参数就会被当作上一个yield表达式的返回值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> * <span class="title">foo</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> y = <span class="number">2</span> * (<span class="keyword">yield</span> (x + <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> z = <span class="keyword">yield</span> (y / <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (x + y + z);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = foo(<span class="number">5</span>); </span><br><span class="line"></span><br><span class="line">b.next() <span class="comment">// &#123; value:6, done:false &#125;</span></span><br><span class="line"></span><br><span class="line">b.next(<span class="number">12</span>) <span class="comment">// &#123; value:8, done:false &#125; </span></span><br><span class="line"></span><br><span class="line">b.next(<span class="number">13</span>) <span class="comment">// &#123; value:42, done:true &#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Async </p>
<ul>
<li>Async 是 Generator 的一个语法糖。</li>
<li>async 对应的是 * 。</li>
<li>await 对应的是 yield 。</li>
<li>async/await 自动进行了 Generator 的流程控制。</li>
</ul>
</li>
</ul>
<h2 id="第6章-Javascript-BOM"><a href="#第6章-Javascript-BOM" class="headerlink" title="第6章 Javascript-BOM"></a>第6章 Javascript-BOM</h2><h3 id="6-1-window对象"><a href="#6-1-window对象" class="headerlink" title="6.1 window对象"></a>6.1 window对象</h3><h4 id="浏览器视口"><a href="#浏览器视口" class="headerlink" title="浏览器视口"></a>浏览器视口</h4><ul>
<li>所有现代浏览器都支持4个属性:innerWidth、innerHeight、outerWidth和outerHeight。其中outerWidth和outerHeight返回浏览器窗口自身大小，innerWidth和innerHeight返回浏览器窗口页面视口大小。</li>
<li>确定页面视口的大小  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> pageWidth = <span class="built_in">window</span>.innerWidth,</span><br><span class="line">    pageHeight = <span class="built_in">window</span>.innerHeight</span><br><span class="line"><span class="comment">//判断是不是一个数值</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> pageWidth != <span class="string">"number"</span>)&#123;  </span><br><span class="line">    <span class="comment">//检查页面是否处于标准模式</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">document</span>.compatMode == <span class="string">"CSSlCompat"</span>)&#123;</span><br><span class="line">        pageWidth = <span class="built_in">document</span>.documentElement.clientWidth</span><br><span class="line">        pageHeight = <span class="built_in">document</span>.documentElement.clientHeight</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        pageWidth = <span class="built_in">document</span>.body.clientWidth</span><br><span class="line">        pageHeight = <span class="built_in">document</span>.body.clientHeight</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>常用接口<ul>
<li>window.resizeTo 宽高缩放到新的值</li>
<li>window.resizeBy 宽高各缩放多少倍</li>
<li>window.scrollBy 滚动到新坐标，以左上角为0坐标，向下和向右为正</li>
<li>window.moveTo 移动</li>
<li>window.close 关闭</li>
</ul>
</li>
</ul>
<h4 id="导航和打开新窗口"><a href="#导航和打开新窗口" class="headerlink" title="导航和打开新窗口"></a>导航和打开新窗口</h4><ul>
<li>window.open   <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.open(<span class="string">"http://www.wrox.com/"</span>,<span class="string">"topFrame"</span>)</span><br></pre></td></tr></table></figure>
  如果有一个窗口名叫”toFrame”,则这个窗口会打开，否则会打开一个新窗口并命名为”toFrame”,第二个参数也可以是特殊的窗口名比如_self、_parent、_top或_blank。第三个参数即特性字符串，以一个逗号分隔的设置字符串，可控制窗口的宽高、位置等。  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.open(<span class="string">"http://www.wrox.com/"</span>,<span class="string">"toFrame"</span>,<span class="string">"height=400,width=400,top=10,left=10,resizable=yes"</span>)</span><br></pre></td></tr></table></figure>
  这代码会打开一个可缩放新窗口，大小为400*400，位于离屏幕左边及顶边各10像素的位置</li>
</ul>
<h4 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h4><ul>
<li>setTimeout()用于指定在一定时间后执行某些代码，setInterval()用于指定每隔一段时间执行某些代码</li>
<li><strong>调用setTimeout时，会返回一个表示该超时的数值ID，用于取消该任务，可以调用clearTimeout()方法并传入超时ID</strong>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timeout = setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> alert(<span class="string">'Hello'</span>),<span class="number">1000</span>)</span><br><span class="line">clearTimeout(timeout)</span><br></pre></td></tr></table></figure>
  在指定时间内调用清除函数可以取消任务，否则无效</li>
<li><strong>setIntervalue()在实践上很少会在生产环境下使用，因为没办法保证一个任务结束和另一个任务开始之间的间隔</strong></li>
</ul>
<h4 id="系统对话"><a href="#系统对话" class="headerlink" title="系统对话"></a>系统对话</h4><ul>
<li>confirm()确定框跟警告框类似，有取消和确定两个按钮</li>
<li>prompt()提示用户输入信息的弹出框，可以向用户显示信息、确认操作和获取输入</li>
</ul>
<h3 id="6-2-location对象获取页面信息"><a href="#6-2-location对象获取页面信息" class="headerlink" title="6.2 location对象获取页面信息"></a>6.2 location对象获取页面信息</h3><ul>
<li><p>解析url地址<br>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/342bb983e48e4da8ae180bbb58607b81?method=download&shareKey=95f03f93d6bd00e066e5f82f0bb7bfc2" alt=""></p>
</li>
<li><p>解析查询字符串</p>
<ul>
<li>使用下面的函数  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> getQueryStringArgs = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//取得问好之后的查询字符串</span></span><br><span class="line">    <span class="keyword">let</span> qs = location.search.length &gt; <span class="number">0</span> ? location.search.substring[<span class="number">1</span>] : <span class="string">""</span></span><br><span class="line">    <span class="keyword">let</span> args =&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//把每个参数添加到args对象中</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> qs.split(<span class="string">"&amp;"</span>).map(<span class="function"><span class="params">kv</span> =&gt;</span> kv.split(<span class="string">"="</span>)))&#123;</span><br><span class="line">        <span class="keyword">let</span> name = decodeURICompoment(item[<span class="number">0</span>]),</span><br><span class="line">        value = <span class="built_in">decodeURIComponent</span>(item[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span>(name.length)&#123;</span><br><span class="line">            args[name] = value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> args</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//假设查询字符串为?q=javascript&amp;num=10</span></span><br><span class="line"><span class="keyword">let</span> args = getQueryStringArgs()</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(args[<span class="string">"q"</span>])  <span class="comment">//"javascript"</span></span><br><span class="line"><span class="built_in">console</span>.log(args[<span class="string">"num"</span>])  <span class="comment">//"10"</span></span><br></pre></td></tr></table></figure></li>
<li>URLSearchParams 提供一组标准API方法，通过它们可以检查和修改查询字符串    <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/be56185dd05b0bbdbbdafdedae63c0aa?method=download&shareKey=95cea824a519f4df9fb31d25f54bc70c" alt=""></li>
</ul>
</li>
<li><p>通过修改location对象修改浏览器的地址</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//三种修改等效</span></span><br><span class="line">location.assign(<span class="string">"http://www.wrom.com"</span>)</span><br><span class="line"><span class="built_in">window</span>.location = <span class="string">"http://www.wrox.com"</span></span><br><span class="line">location.href = <span class="string">"http://www.wrox.com"</span> <span class="comment">//最常用</span></span><br></pre></td></tr></table></figure>
<p>  除了hash之外，修改location的其他属性，也会导致页面重新加载新的url</p>
<pre><code>![](https://note.youdao.com/yws/api/personal/file/5f65ca3dd3ab735288268bb26fef113e?method=download&amp;shareKey=bf9788251bbdf97d56ac2cd75a98543a)</code></pre></li>
<li><p><strong>上面的方法修改url之后，浏览器历史记录会新增，如果不想新增历史记录，可以使用<code>replace()</code>，但用户不能退回之前的页面。</strong></p>
</li>
<li><p><strong>reload()重新加载当前页面，如果页面自上次请求以来没有修改过，浏览器可能从缓存中加载页面，传入true参数则从服务器加载</strong></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">location.reload() <span class="comment">//重新加载，可能从缓存加载</span></span><br><span class="line">location.reload(<span class="literal">true</span>)  <span class="comment">//重新加载，从服务器加载</span></span><br></pre></td></tr></table></figure>
<p>  <strong>脚本位于reload()之后的代码可能因为网络延迟等原因不执行，所有最好把reload()作为最后一行代码</strong></p>
</li>
</ul>
<h3 id="6-3-navigation对象通常用来确定浏览器类型"><a href="#6-3-navigation对象通常用来确定浏览器类型" class="headerlink" title="6.3 navigation对象通常用来确定浏览器类型"></a>6.3 navigation对象通常用来确定浏览器类型</h3><h3 id="6-4-history对象操作浏览器历史"><a href="#6-4-history对象操作浏览器历史" class="headerlink" title="6.4 history对象操作浏览器历史"></a>6.4 history对象操作浏览器历史</h3><ul>
<li>history对象表示当前窗口首次使用以来用户的导航历史记录  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//后退一页</span></span><br><span class="line">history.go(<span class="number">-1</span>)</span><br><span class="line">history.back()</span><br><span class="line"><span class="comment">//前进一页</span></span><br><span class="line">history.go(<span class="number">1</span>)</span><br><span class="line">history.forward()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(history.length == <span class="number">1</span>)&#123;</span><br><span class="line">    <span class="comment">//这是用户窗口的第一个页面</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  通常用来创建”前进”和”后退”按钮，以及确定页面是不是用户历史记录中的第一条记录</li>
</ul>
<h2 id="第7章-Javascript-DOM"><a href="#第7章-Javascript-DOM" class="headerlink" title="第7章 Javascript-DOM"></a>第7章 Javascript-DOM</h2><h3 id="7-1-Dom-节点操作"><a href="#7-1-Dom-节点操作" class="headerlink" title="7.1 Dom 节点操作"></a>7.1 Dom 节点操作</h3><ul>
<li><p>获取Dom节点</p>
<pre><code>var div1=document.getElementById(&apos;div1&apos;) //元素
var divList=document.getElementsByTagName(&apos;div&apos;) //集合
var containerList= document.getElementsByClassName(&apos;.container&apos;)  //集合
var pList = document.querySelectorAll(&apos;p&apos;)  //集合</code></pre></li>
<li><p>property（js对象属性的修改) 更多细节</p>
<pre><code>var pList = document.querySelectorAll(&apos;p&apos;)  //集合
var p=pList[0]
console.log(p.nodeName)  //p
p.style.width=&apos;100px&apos; //获取修改样式    </code></pre></li>
<li><p>attribute （html标签属性的修改）</p>
<pre><code>var pList = document.querySelectorAll(&apos;p&apos;)  //集合
var p=pList[0]
p.getAttribute(&apos;data-name&apos;)   //获取属性
p.setAttribute(&apos;data-name&apos;,&apos;immoc&apos;)  //自定义属性</code></pre></li>
<li><p>新增节点、添加节点 </p>
<pre><code>var div1=document.getElementById(&apos;div1&apos;)
var p1 =document.createElement(&apos;p&apos;)
p1.innerHTML=&apos;this is p1&apos;
div1.appendChild(p1)

//移动已有的节点
var p2 =document.getElementById(&apos;p2&apos;)
div1.appendChild(p2)</code></pre></li>
<li><p>获取父元素和子元素，删除节点</p>
<pre><code>var div1=document.getElementById(&apos;div1&apos;)
var parent = div1.parentElement

var child=div1.childNodes
div1.removeChild(child[0])</code></pre></li>
</ul>
<h3 id="7-2-Dom-事件模型"><a href="#7-2-Dom-事件模型" class="headerlink" title="7.2 Dom 事件模型"></a>7.2 Dom 事件模型</h3><ul>
<li><p>Dom 事件模型 : 捕获（从上到下）- 冒泡（从下到上）</p>
</li>
<li><p>事件流即是捕获-目标阶段-冒泡</p>
</li>
<li><p>事件捕获的具体流程window - document - html - body-…</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;ev&quot;&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        #ev&#123;	</span><br><span class="line">            width: 100px;</span><br><span class="line">            height: 100px;</span><br><span class="line">            background: red;</span><br><span class="line">            color:#fff;</span><br><span class="line">            text-align: center;</span><br><span class="line">            line-height: 100px;</span><br><span class="line">        &#125;	</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">    目标元素</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">    var ev&#x3D; document.getElementById(&#39;ev&#39;)</span><br><span class="line">    &#x2F;&#x2F;第三个参数为true,捕获阶段触发</span><br><span class="line">    window.addEventListener(&#39;click&#39;,function()&#123;</span><br><span class="line">    	console.log(&#39;window captrue&#39;)</span><br><span class="line">    &#125;,true)</span><br><span class="line"></span><br><span class="line">    document.addEventListener(&#39;click&#39;,function()&#123;</span><br><span class="line">    	console.log(&#39;document captrue&#39;)</span><br><span class="line">    &#125;,true)</span><br><span class="line"></span><br><span class="line">    document.documentElement.addEventListener(&#39;click&#39;,function()&#123;</span><br><span class="line">    	console.log(&#39;html captrue&#39;)</span><br><span class="line">    &#125;,true)</span><br><span class="line"></span><br><span class="line">    document.body.addEventListener(&#39;click&#39;,function()&#123;</span><br><span class="line">    	console.log(&#39;body captrue&#39;)</span><br><span class="line">    &#125;,true)</span><br><span class="line"></span><br><span class="line">    ev.addEventListener(&#39;click&#39;,function()&#123;</span><br><span class="line">    	console.log(&#39;ev captrue&#39;)</span><br><span class="line">    &#125;,true)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>  输出：</p>
<p>  <img src= "/img/loading.gif" data-src="https://note.youdao.com/yws/api/personal/file/6A0484A005D44B28A8231C54C08A50ED?method=download&shareKey=38b99f0e0595038c31fc6d276b505f19&inline=true" alt=""></p>
</li>
</ul>
<h3 id="7-3-Dom-事件类"><a href="#7-3-Dom-事件类" class="headerlink" title="7.3 Dom 事件类"></a>7.3 Dom 事件类</h3><ul>
<li><p>event.preventDefault(a标签阻止跳转行为)</p>
</li>
<li><p>event.stopPropagation（阻止冒泡）</p>
</li>
<li><p>event.stopImmediatePropagation（）</p>
</li>
<li><p>event.currentTarget</p>
</li>
<li><p>event.target</p>
</li>
<li><p>自定义事件</p>
<ul>
<li><p>Event </p>
<pre><code>&lt;!--Event--&gt;
var eve = new Event(&apos;custome&apos;)
ev.addEventListener(&apos;custome&apos;,function(){
    console.log(&apos;custome&apos;)
});
ev.dispatchEvent(eve);</code></pre></li>
<li><p>CustomEvent</p>
<pre><code>&lt;!--CustomEvent--&gt;
// add an appropriate event listener
obj.addEventListener(&quot;cat&quot;, function(e) { process(e.detail) });

// create and dispatch the event
var event = new CustomEvent(&quot;cat&quot;, {
  detail: {
    hazcheeseburger: true
  }
});
obj.dispatchEvent(event);</code></pre></li>
</ul>
</li>
</ul>
<h2 id="第8章-Javascript-生成器"><a href="#第8章-Javascript-生成器" class="headerlink" title="第8章 Javascript-生成器"></a>第8章 Javascript-生成器</h2><h3 id="7-1-简介"><a href="#7-1-简介" class="headerlink" title="7.1 简介"></a>7.1 简介</h3><ul>
<li>生成器是ES6新增的较为灵活的结构，拥有在一个函数内暂停和恢复代码的执行能力，比如可以用它来自定义迭代器和实现协程。</li>
</ul>
<h3 id="7-2-基础"><a href="#7-2-基础" class="headerlink" title="7.2 基础"></a>7.2 基础</h3><ul>
<li><p>声明</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成器函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">//生成器函数表达式</span></span><br><span class="line"><span class="function"><span class="title">let</span> <span class="title">generatorFn</span> = <span class="title">function</span>* (<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="comment">//作为对象字面量方法的生成器函数</span></span><br><span class="line"><span class="keyword">let</span> foo = &#123;</span><br><span class="line">    * generatorFn()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//作为类实例方法的生成器函数</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">    * generatorFn()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//作为类静态方法的生成器函数</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> * generatorFn()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  标识生成器函数的星号不受两侧空格的影响</p>
<p>  <code>注意！箭头函数不能用来定义生成器函数</code></p>
</li>
<li><p>暂停与恢复:一开始生成器对象处于暂停(suspended)状态。生成器与迭代器相似，它使用next()方法，让生成器恢复执行</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> g = generatorFn()</span><br><span class="line"><span class="built_in">console</span>.log(g) <span class="comment">//generatorFn(&lt;suspended&gt;)</span></span><br><span class="line"><span class="built_in">console</span>.log(g.next) <span class="comment">//f next() &#123;native code&#125;</span></span><br></pre></td></tr></table></figure>
<p>  next方法返回值<code>{done:true/false,value:xxx}</code>。<br>  调用一次next会让生成器到达<code>done:true</code>状态</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(g.next())  <span class="comment">//&#123;done:true,value:undefined&#125;</span></span><br></pre></td></tr></table></figure>
<p>  value可以通过return指定</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'foo'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorOj = generatorFn()</span><br><span class="line"><span class="built_in">console</span>.log(generatorOj.next()) <span class="comment">//&#123;done:true,value:'foo'&#125;</span></span><br></pre></td></tr></table></figure>
<p>  <strong>生成器只会在初次调用next方法后开始执行</strong></p>
<h3 id="7-3-yield"><a href="#7-3-yield" class="headerlink" title="7.3 yield"></a>7.3 yield</h3></li>
<li><p><strong>yield 可以让生成器停止和开始执行，生成器遇到yield之前会正常执行，遇到yield后会停止执行，停止执行的生成器函数只能通过next方法恢复执行</strong></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'foo'</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'bar'</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'baz'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorOj = generatorFn()</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(generatorOj.next()) <span class="comment">//&#123;done:false,value: 'foo'&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(generatorOj.next()) <span class="comment">//&#123;done:false,value:'bar'&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(generatorOj.next()) <span class="comment">//&#123;done:true,value:'baz'&#125;</span></span><br></pre></td></tr></table></figure>
<p>  <strong>通过yield关键字退出的生成器函数会处于done:false状态；通过return关键字退出的生成器函数会处于done:true状态</strong></p>
</li>
<li><p>生成器对象可迭代</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> generatorFn())&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="comment">//3</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用yield实现输入和输出</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generator</span>(<span class="params">initial</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(initial)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">yield</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">yield</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorOj = generatorFn(<span class="string">'foo'</span>)</span><br><span class="line">generatorOj.next(<span class="string">'bar'</span>)  <span class="comment">//foo</span></span><br><span class="line">generatorOj.next(<span class="string">'baz'</span>) <span class="comment">//baz</span></span><br><span class="line">generatorOj.next(<span class="string">'qux'</span>)  <span class="comment">//qux</span></span><br></pre></td></tr></table></figure>
<p>  <strong>第一次调用next传入的值不会被使用，因为第一次调用是为了开始执行生成器函数</strong></p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">yield</span> <span class="string">'foo'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorOj = generatorFn()</span><br><span class="line"><span class="built_in">console</span>.log(generatorOj.next()) <span class="comment">//&#123;done:false,value:'foo'&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(generatorOj.next(<span class="string">'bar'</span>)) <span class="comment">//&#123;done:true,value:'bar'&#125;</span></span><br></pre></td></tr></table></figure></li>
<li><p>yield* 增强行为，</p>
<ul>
<li>它能迭代一个可迭代对象，从而一次产出一个值  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//等价的generatorFn</span></span><br><span class="line"><span class="comment">//function* generatoFn()&#123;</span></span><br><span class="line"><span class="comment">//    for(const x of [1, 2, 3])&#123;</span></span><br><span class="line"><span class="comment">//        yield x;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">yield</span>* [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorOj = generatorFn()</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> generatorOj)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="comment">//3</span></span><br></pre></td></tr></table></figure></li>
<li>yield*的值是关联迭代器返回done:true时value属性。  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//对于普通迭代器来说，这个值时undefined</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'iter value'</span>, <span class="keyword">yield</span>* [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> generatorFn())&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'value'</span>,x)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//value 1</span></span><br><span class="line">    <span class="comment">//value 2</span></span><br><span class="line">    <span class="comment">//value 3</span></span><br><span class="line">    <span class="comment">//iter value, undefined</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//对于生成器函数产生的迭代器来说，这个值就是生成器函数返回的值</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span>* <span class="title">innerGeneratorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'foo'</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'bar'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>* <span class="title">outerGeneratoFn</span>(<span class="params">genObj</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'iter value:'</span>, <span class="keyword">yield</span>* innerGeneratorFn())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> outerGeneratorFn())&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'value'</span>,x)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//value,foo</span></span><br><span class="line">    <span class="comment">//iter value: bar</span></span><br><span class="line">- <span class="keyword">yield</span>* 实现递归算法</span><br><span class="line">    <span class="string">``</span><span class="string">`js</span></span><br><span class="line"><span class="string">    functio* nTimes(n)&#123;</span></span><br><span class="line"><span class="string">        if(n &gt; 0)&#123;</span></span><br><span class="line"><span class="string">            yield* nTimes(n-1);</span></span><br><span class="line"><span class="string">            yield n-1;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    for(const x of nTimes(3))&#123;</span></span><br><span class="line"><span class="string">        console.log(x)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    //0</span></span><br><span class="line"><span class="string">    //1</span></span><br><span class="line"><span class="string">    //2</span></span><br></pre></td></tr></table></figure>
<h3 id="7-4-终止生成器"><a href="#7-4-终止生成器" class="headerlink" title="7.4 终止生成器"></a>7.4 终止生成器</h3></li>
</ul>
</li>
<li><p>return 强制生成器进入关闭状态,只要进入关闭状态，就无法恢复。后续调用next()会显示done:true状态，提供的任何返回值都不会被存储或传播</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])&#123;</span><br><span class="line">        <span class="keyword">yield</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> g = generatorFn();</span><br><span class="line"><span class="built_in">console</span>.log(g) <span class="comment">//generatorFn (&lt;suspended&gt;)</span></span><br><span class="line"><span class="built_in">console</span>.log(g.next())  <span class="comment">//&#123;done:false,value:1&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(g.return(<span class="number">4</span>))  <span class="comment">//&#123;done:true,value:4&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(g)  <span class="comment">//generatorFn (&lt;closed&gt;)</span></span><br><span class="line"><span class="built_in">console</span>.log(g.next()) <span class="comment">//&#123;done:true,value:undefined&#125;</span></span><br></pre></td></tr></table></figure>
<p>  for-of循环会忽略状态为done:true的内部返回值</p>
</li>
<li><p>throw 会在暂停的时候将一个提供的错误注入到生成器对象中，如果错误未被处理，生成器就会关闭</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])&#123;</span><br><span class="line">        <span class="keyword">yield</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> g = generatorFn()</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    g.throw(<span class="string">'foo'</span>)</span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e)  <span class="comment">//foo</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(g) <span class="comment">//generatorFn (&lt;closed&gt;)</span></span><br></pre></td></tr></table></figure>
<p>  不过，假设生成器内部处理了这个错误，那么生成器就可以恢复执行，错误处理会跳过对应的yield</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">yield</span> x;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> g = generatorFn()</span><br><span class="line"><span class="built_in">console</span>.log(g.next())  <span class="comment">//&#123;done:false,value:1&#125;</span></span><br><span class="line">g.throw(<span class="string">'foo'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(g.next())  <span class="comment">//&#123;done:false:value:3&#125;</span></span><br></pre></td></tr></table></figure>
<p>  <strong>如果生成器对象还没开始执行，调用throw()抛出的错误就不会在函数内部被捕获，因为这相当于在函数外部抛出错误</strong></p>
</li>
</ul>
<h2 id="第9章-Javascript-跨端请求"><a href="#第9章-Javascript-跨端请求" class="headerlink" title="第9章 Javascript-跨端请求"></a>第9章 Javascript-跨端请求</h2><h3 id="9-1-XMLHttpRequest对象"><a href="#9-1-XMLHttpRequest对象" class="headerlink" title="9.1 XMLHttpRequest对象"></a>9.1 XMLHttpRequest对象</h3><ul>
<li><p>把Ajax推到历史舞台上的关键技术是XMLHttpRequest（XHR）对象。这个对象最早由微软发明，然后被其他浏览器所借鉴。在XHR出现之前，Ajax风格的通信必须通过一些黑科技实现，主要是使用隐藏的窗格或内嵌窗格。XHR为发送服务器请求和获取响应提供了合理的接口。这个接口可以实现异步从服务器获取额外数据，意味着用户点击不用页面刷新也可以获取数据。通过XHR对象获取数据后，可以使用DOM方法把数据插入网页。虽然Ajax这个名称中包含XML，但实际上Ajax通信与数据格式无关。这个技术主要是可以实现在不刷新页面的情况下从服务器获取数据，格式并不一定是XML。</p>
</li>
<li><p>它实际上是过时Web规范的产物，应该只在旧版本浏览器中使用。实际开发中，应该尽可能使用fetch()。</p>
</li>
</ul>
<h3 id="9-2-Ajax的限制"><a href="#9-2-Ajax的限制" class="headerlink" title="9.2 Ajax的限制"></a>9.2 Ajax的限制</h3><ul>
<li>通过XHR进行Ajax通信的一个主要限制是跨源安全策略。默认情况下，XHR只能访问与发起请求的页面在同一个域内的资源。因此需要跨资源共享(CORS)</li>
<li>同源限制以及限制：同源策略(即协议 域名 端口相同),不同源三大限制：<ul>
<li>Cookie、LocalStorage和 IndexDB无法获得 </li>
<li>DOM无法获得 </li>
<li>AJAX请求无法发送</li>
</ul>
</li>
</ul>
<h3 id="9-3-Fetch"><a href="#9-3-Fetch" class="headerlink" title="9.3 Fetch"></a>9.3 Fetch</h3><ul>
<li>XHR对象的API被普遍认为比较难用，而Fetch API自从诞生以后就迅速成为了XHR更现代的替代标准。Fetch API支持期约（promise）和服务线程（service worker），已经成为极其强大的Web开发工具。</li>
</ul>
<h3 id="9-4-跨域解决方案"><a href="#9-4-跨域解决方案" class="headerlink" title="9.4 跨域解决方案"></a>9.4 跨域解决方案</h3><h4 id="9-4-1-CORS"><a href="#9-4-1-CORS" class="headerlink" title="9.4.1 CORS"></a>9.4.1 CORS</h4><ul>
<li><p>主流解决方案，支持所有类型的HTTP请求，原理浏览器会拦截ajax请求，如果发现这个ajax请求是跨域，它会在HTTP请求中加Origin</p>
</li>
<li><p>CORS是一个W3C标准，全称是”跨域资源共享”（Cross-origin resource sharing）<strong>它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。</strong></p>
</li>
<li><p>普通跨域请求：<strong>只服务端设置Access-Control-Allow-Origin即可，前端无须设置，若要带cookie请求：前后端都需要设置。</strong>由于同源策略的限制，所读取的cookie为跨域请求接口所在域的cookie，而非当前页</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;相当于ajax</span><br><span class="line">fetch(&#39;&#x2F;some&#x2F;url&#39;,&#123;</span><br><span class="line">	method:&#39;get&#39;</span><br><span class="line">&#125;).then(function(respone)&#123;</span><br><span class="line"></span><br><span class="line">&#125;).catch(function(err)&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="9-4-2-WebSocket"><a href="#9-4-2-WebSocket" class="headerlink" title="9.4.2 WebSocket"></a>9.4.2 WebSocket</h4><ul>
<li><p>Web Socket（套接字）的目标是通过一个长时连接实现与服务器全双工、双向的通信。在JavaScript中创建Web Socket时，一个HTTP请求会发送到服务器以初始化连接。服务器响应后，连接使用HTTP的Upgrade头部从HTTP协议切换到Web Socket协议。这意味着Web Socket不能通过标准HTTP服务器实现，而必须使用支持该协议的专有服务器。</p>
</li>
<li><p>使用<code>ws://</code>和<code>wss://</code>。前者是不安全的连接，后者是安全连接</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//其中ws/wss 区别在于是否加密 </span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">'wws://服务器地址...'</span>)</span><br><span class="line">ws.open = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Connection open ...'</span>)</span><br><span class="line">    ws.send(<span class="string">'Hello WebSockets!'</span>)</span><br><span class="line">&#125;</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Received Message: '</span> + evt.data)</span><br><span class="line">    ws.close()</span><br><span class="line">&#125;</span><br><span class="line">ws.onclose = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Connection closed.'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="9-4-3-JSONP"><a href="#9-4-3-JSONP" class="headerlink" title="9.4.3 JSONP"></a>9.4.3 JSONP</h4><ul>
<li><p>利用script标签的异步加载</p>
</li>
<li><p>JSONP 通过 script的回调函数(只支持get请求)</p>
<p>通常为了减轻web服务器的负载，我们把js、css，img等静态资源分离到另一台独立域名的服务器上，在html页面中再通过相应的标签从不同域名下加载静态资源，而被浏览器允许，基于此原理，我们可以通过动态创建script，再请求一个带参网址实现跨域通信。jsonp正是利用这个特性来实现的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>JSONP 实例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span>	</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"divCustomers"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">callbackFunction</span><span class="params">(result, methodName)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> html = <span class="string">'&lt;ul&gt;'</span>;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; result.length; i++)&#123;</span></span><br><span class="line"><span class="actionscript">                html += <span class="string">'&lt;li&gt;'</span> + result[i] + <span class="string">'&lt;/li&gt;'</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="actionscript">            html += <span class="string">'&lt;/ul&gt;'</span>;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">'divCustomers'</span>).innerHTML = html;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://www.runoob.com/try/ajax/jsonp.php?		jsoncallback=callbackFunction"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>缺点：</p>
<ul>
<li>首先，JSONP是从不同的域拉取可执行代码。如果这个域并不可信</li>
<li>第二个缺点是不好确定JSONP请求是否失败。</li>
</ul>
</li>
</ul>
<h4 id="9-4-4-Img"><a href="#9-4-4-Img" class="headerlink" title="9.4.4 Img"></a>9.4.4 Img</h4><ul>
<li>利用<code>&lt;img&gt;</code>标签实现跨域通信的最早的一种技术。任何页面都可以跨域加载图片而不必担心限制，因此这也是在线广告跟踪的主要方式。可以动态创建图片，然后通过它们的onload和onerror事件处理程序得知何时收到响应。</li>
</ul>
<h4 id="9-4-5-Hash"><a href="#9-4-5-Hash" class="headerlink" title="9.4.5 Hash"></a>9.4.5 Hash</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A页面里有个跨域的iframeB窗口</span></span><br><span class="line"><span class="comment">//A中</span></span><br><span class="line"><span class="keyword">var</span> B = <span class="built_in">document</span>.getElementByTagName(<span class="string">'iframe'</span>)</span><br><span class="line">B.src = B.src + <span class="string">'#'</span> + data</span><br><span class="line"></span><br><span class="line"><span class="comment">//B中 通过监听取得数据</span></span><br><span class="line"><span class="built_in">window</span>.onhashChange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> data = <span class="built_in">window</span>.location.hash</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-4-6-postMessage"><a href="#9-4-6-postMessage" class="headerlink" title="9.4.6 postMessage"></a>9.4.6 postMessage</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//窗口A</span></span><br><span class="line"><span class="built_in">window</span>.postMessage(<span class="string">'data'</span>,<span class="string">'http://B.com'</span>)</span><br><span class="line"><span class="comment">//窗口B</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'message'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.origin)</span><br><span class="line">    <span class="built_in">console</span>.log(event.source)</span><br><span class="line">    <span class="built_in">console</span>.log(event.data)</span><br><span class="line">&#125;,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>

<h2 id="第10章-Javascript-客户端存储"><a href="#第10章-Javascript-客户端存储" class="headerlink" title="第10章 Javascript-客户端存储"></a>第10章 Javascript-客户端存储</h2><ul>
<li>随着Web应用程序的出现，直接在客户端存储用户信息的需求也随之出现。这背后的想法是合理的：与特定用户相关的信息应该保存在用户的机器上。无论是登录信息、个人偏好，还是其他数据，Web应用程序提供者都需要有办法把它们保存在客户端。对该问题的第一个解决方案就是cookie</li>
</ul>
<h3 id="10-1-cookie"><a href="#10-1-cookie" class="headerlink" title="10.1 cookie"></a>10.1 cookie</h3><ul>
<li><p>HTTP cookie通常也叫作cookie，最初用于在客户端存储会话信息。这个规范要求服务器在响应HTTP请求时，通过发送Set-Cookie HTTP头部包含会话信息。例如，下面是包含这个头部的一个HTTP响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1200 OK</span><br><span class="line">Content-type: text&#x2F;html</span><br><span class="line">Set-Cookie: name &#x3D; value</span><br><span class="line">Other-header: other-header-value</span><br></pre></td></tr></table></figure>

<p>这个HTTP响应会设置一个名为”name”，值为”value”的cookie。名和值在发送时都会经过URL编码。浏览器会存储这些会话信息，并在之后的每个请求中都会通过HTTP头部cookie再将它们发回服务器，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;index.jsl HTTP&#x2F;1.1</span><br><span class="line">Cookie: name&#x3D;value</span><br><span class="line">Other-header:ohter-header-value</span><br></pre></td></tr></table></figure>

<p>这些发送回服务器的额外信息可用于唯一标识发送请求的客户端。</p>
</li>
<li><p>cookie是与特定域绑定的。设置cookie后，它会与请求一起发送到创建它的域。这个限制能保证cookie中存储的信息只对被认可的接收者开放，不被其他域访问。如果cookie总数超过了单个域的上限，浏览器就会删除之前设置的cookie。如果创建的cookie超过最大限制，则该cookie会被静默删除。</p>
</li>
<li><p>cookie构成，这些参数在Set-Cookie头部中使用分号加空格隔开，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1200 OK</span><br><span class="line">Content-type:text&#x2F;html</span><br><span class="line">Set-Cookie:name&#x3D;value;expires&#x3D;Mon,22-Jan-0707:20:24GMT;domain&#x3D;.wrox.com;path&#x3D;&#x2F;;secure;</span><br><span class="line">Other-header:ohter-header-value</span><br></pre></td></tr></table></figure>

<p>这个头部设置一个名为”name”的cookie，这个cookie在2007年1月22日7:10:24过期对所有wrox.com的子域及该域中的所有页面有效（通过path=/指定）。不过，这个cookie只能在SSL连接上发送，因为设置了secure标志。安全标志secure是cookie中唯一的非名/值对，只需一个secure就可以了。</p>
<p>要知道，域、路径、过期时间和secure标志用于告诉浏览器什么情况下应该在请求中包含cookie。这些参数并不会随请求发送给服务器，实际发送的只有cookie的名/值对。</p>
</li>
<li><p>在JavaScript中处理cookie比较麻烦，因为接口过于简单，只有BOM的document.cookie属性。所有名和值都是URL编码的，因此必须使用decodeURIComponent()解码。在所有这些参数中，只有cookie的名称和值是必需的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="built_in">encodeURIComponent</span>(<span class="string">"name"</span>) + <span class="string">"="</span> + <span class="built_in">encodeURIComponent</span>(<span class="string">"Nick"</span>);</span><br></pre></td></tr></table></figure>

<p>虽然直接设置也可以，因为不需要在名称或值中编码任何字符，但最好还是使用encodeURIComponent()对名称和值进行编码</p>
</li>
<li><p>还有一种叫作HTTP-only的cookie。HTTP-only可以在浏览器设置，也可以在服务器设置，但只能在服务器上读取，这是因为JavaScript无法取得这种cookie的值。</p>
</li>
<li><p>因为所有cookie都会作为请求头部由浏览器发送给服务器，所以在cookie中保存大量信息可能会影响特定域浏览器请求的性能。保存的cookie越大，请求完成的时间就越长。即使浏览器对cookie大小有限制，最好还是尽可能只通过cookie保存必要信息，以避免性能问题。</p>
</li>
</ul>
<h3 id="10-2-WebStorage"><a href="#10-2-WebStorage" class="headerlink" title="10.2 WebStorage"></a>10.2 WebStorage</h3><ul>
<li><p>Web Storage的目的是解决通过客户端存储不需要频繁发送回服务器的数据时使用cookie的问题。</p>
</li>
<li><p>localStorage是永久存储机制，sessionStorage是跨会话的存储机制,这跟浏览器关闭时会消失的会话cookie类似。这两种浏览器存储API提供了在浏览器中不受页面刷新影响而存储数据的两种方式</p>
</li>
<li><p>通过WebStorage写入的任何数据都可以立即被读取。</p>
</li>
<li><p>Storage类型用于保存名/值对数据，调用接口如下：</p>
<ul>
<li>clear()</li>
<li>getItem(name)</li>
<li>key(index)</li>
<li>removeItem(name)</li>
<li>setItem(name,value)</li>
</ul>
<p>getItem()、removeItem()和setItem()方法可以直接或间接通过Storage对象调用</p>
</li>
<li><p><strong>注意使用时建议统一使用try-catch封装</strong></p>
</li>
</ul>
<h3 id="10-3-Cookie-与-Local-storage-与-Session-storage-区别"><a href="#10-3-Cookie-与-Local-storage-与-Session-storage-区别" class="headerlink" title="10.3 Cookie 与 Local storage 与 Session storage 区别"></a>10.3 Cookie 与 Local storage 与 Session storage 区别</h3><table>
<thead>
<tr>
<th>特性</th>
<th>Cookie</th>
<th>localStorage</th>
<th>sessionStorage</th>
</tr>
</thead>
<tbody><tr>
<td>数据的生命期</td>
<td>一般由服务器生成，可设置失效时间。如果在浏览器端生成Cookie，默认是关闭浏览器后失效</td>
<td>除非被清除，否则永久保存</td>
<td>仅在当前会话下有效，关闭页面或浏览器后被清除</td>
</tr>
<tr>
<td>存放数据大小</td>
<td>4K左右</td>
<td>一般为 5MB</td>
<td>row 2 col 2</td>
</tr>
<tr>
<td>与服务器端通信</td>
<td>每次都会携带在HTTP头中，如果使用cookie保存过多数据会带来性能问题</td>
<td>仅在客户端（即浏览器）中保存，不参与和服务器的通信</td>
<td>同左</td>
</tr>
<tr>
<td>易用性</td>
<td>需要程序员自己封装，源生的Cookie接口不友好</td>
<td>需要程序员自己封装，源生的Cookie接口不友好 源生接口可以接受，亦可再次封装来对Object和Array有更好的支持</td>
<td>同左</td>
</tr>
</tbody></table>
<ul>
<li><p>可以使用如下代码监听storage事件：对于sessionStorage和localStorage上的任何更改都会触发storage事件，但storage事件不会区分这两者。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"storage"</span>,(event)=&gt;<span class="built_in">console</span>.log($&#123;event.domain&#125;))</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>有了这些存储手段，就可以在客户端通过使用JavaScript存储可观的数据。因为这些数据没有加密，所以要注意不能使用它们存储敏感信息。</strong></p>
</li>
</ul>
<h3 id="10-4-IndexDB"><a href="#10-4-IndexDB" class="headerlink" title="10.4  IndexDB"></a>10.4  IndexDB</h3><ul>
<li>IndexedDB是类似于SQL数据库的结构化数据存储机制。不同的是，IndexedDB存储的是对象，而不是数据表。对象存储是通过定义键然后添加数据来创建的。游标用于查询对象存储中的特定数据，而索引可以针对特定属性实现更快的查询。</li>
</ul>
<h2 id="第11章-Javascript-模块化"><a href="#第11章-Javascript-模块化" class="headerlink" title="第11章 Javascript-模块化"></a>第11章 Javascript-模块化</h2><ul>
<li>CommonJS是以服务器为目标环境，一次性把所有模块加载到内存中</li>
<li>AMD为异步模块定义，是以浏览器为目标执行环境，需要考虑网络延迟问题，运行加载器库控制何时加载模块，实现核心使用函数包装模块定义，防止声明全局变量，包装函数也便于模块代码移植。</li>
<li>UMD是为了通一ComomonJS和AMD生态系统的通用模块定义。它可以创建两个系统都可以使用的模块代码。本质上是定义的模块会在启动时检测要使用哪个模块系统，然后进行适当的配置，实现两个生态共存。</li>
<li>ES6独特之处是既可以通过浏览器原生加载，也可以与第三方加载器和构建工具一起加载。浏览器可以从顶级模块加载整个依赖图，而且是异步完成的。模块文件按需加载，且后续模块的请求会因为每个依赖模块的网络延迟而同步延迟。即，如果moduleA依赖moduleB, moduleB依赖moduleC。浏览器在对moduleB的请求完成之前并不知道要请求moduleC。这种加载方式效率很高，也不需要外部工具，但加载大型应用程序的深度依赖图可能要花费很长时间。</li>
<li>总结：多年以来，<strong>CommonJS和AMD这两个分别针对服务器端环境和受延迟限制的客户端环境的模块系统长期分裂。两个系统都获得了爆炸性增强，但为它们编写的代码则在很多方面不一致，经常也会带有冗余的样板代码。而且，这两个系统都没有在浏览器中实现。</strong>缺乏兼容导致出现了相关工具，从而让在浏览器中实现模块模式成为可能。ECMAScript 6规范重新定义了浏览器模块，集之前两个系统之长于一身，并通过更简单的声明性语法暴露出来。浏览器对原生模块的支持越来越好，但也提供了稳健的工具以实现从不支持到支持ES6模块的过渡。</li>
</ul>
<h2 id="第12章-Javascript-性能优化"><a href="#第12章-Javascript-性能优化" class="headerlink" title="第12章 Javascript-性能优化"></a>第12章 Javascript-性能优化</h2><h2 id="第13章-Javascript-Web安全"><a href="#第13章-Javascript-Web安全" class="headerlink" title="第13章 Javascript-Web安全"></a>第13章 Javascript-Web安全</h2><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><ul>
<li>XSS即为（Cross Site Scripting）跨站脚本。目标浏览器网站作用域下嵌入一段远程或第三方域上面的JS代码。防御思路：对输入（URL参数进行过滤），对输出进行编码。即对提交的所有内容进行过滤，过滤掉导致脚本执行的所有内容，然后对动态输出到页面的内容进行html编码，使脚本无法在浏览器中执行。</li>
</ul>
<h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><ul>
<li>CSRF（Cross Site Request Forgery）跨站请求伪造。受害者在访问一个网站时，在其Cookie还没有过期的情况下，攻击者伪造一个链接地址发送给受害者并欺骗让其点击。防御思路：在请求地址中添加token并验证；验证HTTP Referer字段；在HTTP头重自定义属性并验证。</li>
</ul>
<h2 id="第14章-Javascript-算法"><a href="#第14章-Javascript-算法" class="headerlink" title="第14章 Javascript-算法"></a>第14章 Javascript-算法</h2><h3 id="防抖节流"><a href="#防抖节流" class="headerlink" title="防抖节流"></a>防抖节流</h3><h4 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h4><ul>
<li><p>原理：每次触发事件之前都取消之前的延时调用方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn,time</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        clearTimeout(timeout)</span><br><span class="line">        timeout = setTimeout(fn,time)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h4><ul>
<li><p>原理：每次触发时判断当前是否有等待执行的延时函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn,delay</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> canRun = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!canRun)&#123;</span><br><span class="line">            <span class="comment">//休息时间暂不接客</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//工作时间，执行函数</span></span><br><span class="line">        canRun = <span class="literal">false</span> </span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            fn()</span><br><span class="line">            canRun = <span class="literal">true</span></span><br><span class="line">        &#125;,delay)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="深浅拷贝"><a href="#深浅拷贝" class="headerlink" title="深浅拷贝"></a>深浅拷贝</h3><ul>
<li><p>对象浅拷贝</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.assign(target,source)</span><br></pre></td></tr></table></figure>
</li>
<li><p>对象深拷贝</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!obj || <span class="keyword">typeof</span> obj !== <span class="string">'object'</span>) <span class="keyword">return</span> obj</span><br><span class="line">    <span class="keyword">let</span> newObj = <span class="built_in">Array</span>.isArray(obj)? [] :&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> obj)&#123;</span><br><span class="line">        newObj[key] = <span class="keyword">typeof</span> obj[key] === <span class="string">'object'</span>? deepClone(obj):obj[key] </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newObj</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="排序算法"><a href="#排序算法" class="headerlink" title="排序算法"></a>排序算法</h3><h3 id="深度遍历和广度遍历"><a href="#深度遍历和广度遍历" class="headerlink" title="深度遍历和广度遍历"></a>深度遍历和广度遍历</h3><h3 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h3><h3 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h3><h2 id="第14章-Javascript-网页性能优化"><a href="#第14章-Javascript-网页性能优化" class="headerlink" title="第14章 Javascript-网页性能优化"></a>第14章 Javascript-网页性能优化</h2><h3 id="性能监控"><a href="#性能监控" class="headerlink" title="性能监控"></a>性能监控</h3><h3 id="网络层面"><a href="#网络层面" class="headerlink" title="网络层面"></a>网络层面</h3><ul>
<li>请求过程优化：Gzip压缩</li>
<li>减少网络请求（本地存储）<ul>
<li>浏览器缓存机制</li>
<li>离线存储技术</li>
</ul>
</li>
</ul>
<h3 id="渲染层面"><a href="#渲染层面" class="headerlink" title="渲染层面"></a>渲染层面</h3><ul>
<li>服务端渲染</li>
<li>浏览器渲染机制解析<ul>
<li>CSS性能方案</li>
<li>js性能方案</li>
</ul>
</li>
<li>DOM优化：回流和重绘</li>
<li>首屏渲染提速：懒加载</li>
</ul>
<h2 id="第15章-Javascript-ES2018和ES2019"><a href="#第15章-Javascript-ES2018和ES2019" class="headerlink" title="第15章 Javascript-ES2018和ES2019"></a>第15章 Javascript-ES2018和ES2019</h2><h3 id="数组打平"><a href="#数组打平" class="headerlink" title="数组打平"></a>数组打平</h3><ul>
<li><p>原本需要迭代进行</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//depth需要打平的级别</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flatten</span>(<span class="params">sourceArr, depth = <span class="number">1</span>, flattenArr = []</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> element <span class="keyword">of</span> sourceArr) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(element) &amp;&amp; depth &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            flatten(element, depth - <span class="number">1</span>, flattenArr)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            flattenArr.push(element)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flattenArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ES9 新增Array.prototype.flat()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [[<span class="number">0</span>],<span class="number">1</span>,<span class="number">2</span>,[<span class="number">3</span>,[<span class="number">4</span>,<span class="number">5</span>]],<span class="number">6</span>]</span><br><span class="line"><span class="built_in">console</span>.log(arr.flat(<span class="number">2</span>))</span><br><span class="line"><span class="comment">//[0,1,2,3,4,5,6]</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.flat())</span><br><span class="line"><span class="comment">//[0,1,2,3,[4,5],6]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Array.prototype.flatMap()方法会在打平数组之前执行一次映射操作。在功能上，arr.flatMap(f)与arr.map(f).flat()等价；但arr.flatMap()更高效，因为浏览器只需要执行一次遍历。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [[<span class="number">1</span>],[<span class="number">3</span>],[<span class="number">5</span>]]</span><br><span class="line"><span class="built_in">console</span>.log(arr.map(<span class="function">(<span class="params">[x]</span>)=&gt;</span>[x,x+<span class="number">1</span>]))</span><br><span class="line"><span class="comment">//[[1,2],[3,4],[5,6]]</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.flatMap(<span class="function">(<span class="params">[x]</span>)=&gt;</span>[x,x+<span class="number">1</span>]))</span><br><span class="line"><span class="comment">//[1,2,3,4,5,6]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Object-fromEntries"><a href="#Object-fromEntries" class="headerlink" title="Object.fromEntries()"></a>Object.fromEntries()</h3><ul>
<li><p>ECMAScript 2019又给Object类添加了一个静态方法fromEntries()，用于通过键/值对数组的集合构建对象。这个方法执行与Object.entries()方法相反的操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    foo:<span class="string">'bar'</span>,</span><br><span class="line">    baz:<span class="string">'qux'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> objEntries = <span class="built_in">Object</span>.entries(obj)</span><br><span class="line"><span class="built_in">console</span>.log(objEntries)</span><br><span class="line"><span class="comment">//[["foo","bar"],["baz","qux"]]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.fromEntries(objEntries))</span><br><span class="line"><span class="comment">//["foo":"bar","baz":"qux"]</span></span><br></pre></td></tr></table></figure>

<p>这个方法可以方便将Map实例转换为Object实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="string">'foo'</span>,<span class="string">'bar'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.fromEntries(map))</span><br><span class="line"><span class="comment">//&#123;foo:'bar'&#125;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="处理开头末尾空格"><a href="#处理开头末尾空格" class="headerlink" title="处理开头末尾空格"></a>处理开头末尾空格</h3><ul>
<li><p>ES9 添加了trimStart()和trimEnd()，它们分别用于删除字符串开头和末尾空格。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">' foo '</span>;</span><br><span class="line"><span class="built_in">console</span>.log(s.trimStart())  <span class="comment">//'foo '</span></span><br><span class="line"><span class="built_in">console</span>.log(s.trimEnd())  <span class="comment">//' foo'</span></span><br></pre></td></tr></table></figure>

<p>这两个方法相当于执行与padStart()和padEnd()相反的操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">'x'</span></span><br><span class="line"><span class="built_in">console</span>.log(s.padStart(<span class="number">4</span>,<span class="string">"ab"</span>))</span><br><span class="line"><span class="comment">//'abax'</span></span><br><span class="line"><span class="built_in">console</span>.log(s.padStart(<span class="number">1</span>,<span class="string">"bbb"</span>))</span><br><span class="line"><span class="comment">//'x'</span></span><br><span class="line"><span class="comment">//如果原字符串的长度，等于或大于指定的最小长度，则返回原字符串</span></span><br></pre></td></tr></table></figure>

<h3 id="Symbol-prototype-description"><a href="#Symbol-prototype-description" class="headerlink" title="Symbol.prototype.description"></a>Symbol.prototype.description</h3><ul>
<li><p>ES9新增了Symbol.prototype.description，用于取得Symbol的符号描述</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以前</span></span><br><span class="line"><span class="keyword">const</span> s = <span class="built_in">Symbol</span>(<span class="string">'foo'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(s.toString())</span><br><span class="line"><span class="comment">//Symbol(foo)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//现在</span></span><br><span class="line"><span class="built_in">console</span>.log(s.description)</span><br><span class="line"><span class="comment">//foo</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="省略catch的错误对象"><a href="#省略catch的错误对象" class="headerlink" title="省略catch的错误对象"></a>省略catch的错误对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以前</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="string">'foo'</span></span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">    <span class="comment">//发生错误，但是你不想使用错误对象</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//现在</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="string">'foo'</span></span><br><span class="line">&#125; <span class="keyword">catch</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Zting</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://tammy-zting.github.io/2021/08/25/Javascript%E5%9F%BA%E7%A1%80/">http://tammy-zting.github.io/2021/08/25/Javascript基础/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://tammy-zting.github.io" target="_blank">Tammy-Zting-Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/chicken.gif" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2021/07/28/Web%E6%80%A7%E8%83%BD%E5%AE%9E%E6%88%98%20%E7%AC%AC%E4%BA%8C%E8%8A%82/"><img class="next-cover" data-src="/img/rabbit.gif" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Web性能实战 第二节</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Zting</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">繁</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script></body></html>